import Mathlib

open Matrix Set Subgroup

/-- We work with 2x2 real matrices as units (invertible matrices). -/
abbrev M := Matrix (Fin 2) (Fin 2) ℝ

/-- The subgroup of orthogonal matrices inside the units of 2x2 real matrices. -/
def O2_set : Set (Units M) := { u | u.val.transpose = (u⁻¹).val }

/-- The subgroup of special orthogonal matrices (determinant = 1). -/
def SO2_set : Set (Units M) := { u | u.val.transpose = (u⁻¹).val ∧ u.val.det = 1 }

/-- Let A be an improper orthogonal matrix (orthogonal with determinant -1).
    Then O(2) is generated by SO(2) together with A. -/
theorem O2_generated_by_SO2_and_A (A : Units M)
  (hA_orth : A.val.transpose = (A⁻¹).val) (hA_improper : A.val.det = -1) :
  Subgroup.closure (SO2_set ∪ {A}) = Subgroup.closure O2_set := by sorry
