name,domain,status,passed,steps,nl_statement,lean4_code
Rudin_exercise_1_14,Analysis,success,True,3,"If $z$ is a complex number such that $|z|=1$, that is, such that $z \bar{z}=1$, compute $|1+z|^{2}+|1-z|^{2}$.","import Mathlib

/-- If $z$ is a complex number such that $|z|=1$, that is, such that $z \bar{z}=1$, compute $|1+z|^{2}+|1-z|^{2}$. -/
theorem rudin_exercise_1_14 (z : ℂ) (hz : ‖z‖ = 1) : ‖(1 + z)‖^2 + ‖(1 - z)‖^2 = 4 := by sorry
"
Rudin_exercise_1_12,Analysis,success,True,3,"If $z_1, \ldots, z_n$ are complex, prove that $|z_1 + z_2 + \ldots + z_n| \leq |z_1| + |z_2| + \cdots + |z_n|$.","import Mathlib
open ComplexConjugate Topology Filter

/-- If $z_1, \ldots, z_n$ are complex, prove that $|z_1 + z_2 + \ldots + z_n| \leq |z_1| + |z_2| + \cdots + |z_n|$. -/
theorem abs_sum_le_sum_abs (n : ℕ) (z : Fin n → ℂ) : 
  Complex.abs (∑ i, z i) ≤ ∑ i, Complex.abs (z i) := by sorry
"
Rudin_exercise_1_8,Analysis,success,True,3,Prove that no order can be defined in the complex field that turns it into an ordered field.,"import Mathlib


/-- Prove that no order can be defined in the complex field that turns it into an ordered field.
Save it to: Rudin_exercise_1_8.lean -/
theorem impossible_ordered_field : ¬∃ o : Ordering, IsOrderedField ℂ o := by sorry
"
Rudin_exercise_1_1b,Analysis,success,True,3,"If $r$ is rational $(r \neq 0)$ and $x$ is irrational, prove that $rx$ is irrational.","import Mathlib

/-- Rudin exercise 1.1(b): If r is rational (r ≠ 0) and x is irrational, then r * x is irrational. -/
theorem Rudin_exercise_1_1b (r : ℚ) (x : ℝ) (hr : r ≠ 0) (hx : Irrational x) : Irrational ((r : ℝ) * x) := by sorry
"
Rudin_exercise_1_4,Analysis,success,True,3,Let $E$ be a nonempty subset of an ordered set; suppose $\alpha$ is a lower bound of $E$ and $\beta$ is an upper bound of $E$. Prove that $\alpha \leq \beta$.,"import Mathlib

/-- Rudin, Principles of Mathematical Analysis, Exercise 1.4: If E is a nonempty subset of an ordered
set, a is a lower bound of E and b is an upper bound of E, then a ≤ b. -/
theorem Rudin_exercise_1_4 {α : Type _} [Preorder α] {E : Set α} (hne : ∃ x, x ∈ E) {a b : α}
  (ha : ∀ x ∈ E, a ≤ x) (hb : ∀ x ∈ E, x ≤ b) : a ≤ b := by sorry
"
Rudin_exercise_1_17,Analysis,success,True,3,Prove that $|\mathbf{x}+\mathbf{y}|^{2}+|\mathbf{x}-\mathbf{y}|^{2}=2|\mathbf{x}|^{2}+2|\mathbf{y}|^{2}$ if $\mathbf{x} \in R^{k}$ and $\mathbf{y} \in R^{k}$.,"import Mathlib

/-!
Rudin, Principles of Mathematical Analysis, Exercise 1.17:
For x, y ∈ ℝ^k show

  ‖x + y‖^2 + ‖x - y‖^2 = 2‖x‖^2 + 2‖y‖^2.
-/-

theorem Rudin_exercise_1_17 (k : ℕ) (x y : Fin k → ℝ) :
  ‖x + y‖ ^ 2 + ‖x - y‖ ^ 2 = 2 * ‖x‖ ^ 2 + 2 * ‖y‖ ^ 2 := by sorry
"
Rudin_exercise_2_19a,Analysis,success,True,3,"If $A$ and $B$ are disjoint closed sets in some metric space $X$, prove that they are separated.","import Mathlib
open Set Filter Topology

/-- If $A$ and $B$ are disjoint closed sets in some metric space $X$, prove that they are separated. -/
theorem separated_of_disjoint_closed {X : Type*} [MetricSpace X] {A B : Set X} (hA : IsClosed A) (hB : IsClosed B) (h : Disjoint A B) : Separated A B := by sorry
"
Rudin_exercise_1_18b,Analysis,success,True,3,"If $k = 1$ and $\mathbf{x} \in R^{k}$, prove that there does not exist $\mathbf{y} \in R^{k}$ such that $\mathbf{y} \neq 0$ but $\mathbf{x} \cdot \mathbf{y}=0$","import Mathlib

/-- Rudin Ex. 1.18(b) (k = 1 case).

We identify ℝ^1 with ℝ, and the dot product with multiplication. The correct statement
requires x ≠ 0: if x ≠ 0 then there is no nonzero y with x * y = 0. -/
theorem Rudin_exercise_1_18b (x : ℝ) (hx : x ≠ 0) : ¬∃ y : ℝ, y ≠ 0 ∧ x * y = 0 := by sorry
"
Rudin_exercise_2_25,Analysis,success,True,3,Prove that every compact metric space $K$ has a countable base.,"import Mathlib

/-- Every compact metric space has a countable base (is second countable). -/
theorem compact_metric_space_second_countable {α : Type*} [MetricSpace α] [CompactSpace α] :
  SecondCountableTopology α := by sorry
"
Rudin_exercise_3_2a,Analysis,success,True,3,Prove that $\lim_{n \rightarrow \infty}\sqrt{n^2 + n} -n = 1/2$.,"import Mathlib

open Filter
open Topology

theorem Rudin_exercise_3_2a :
  Tendsto (fun n : ℕ => Real.sqrt ((n : ℝ) ^ 2 + (n : ℝ)) - (n : ℝ)) atTop (nhds (1 / 2 : ℝ)) := by sorry
"
Rudin_exercise_3_7,Analysis,success,True,3,Prove that the convergence of $\Sigma a_{n}$ implies the convergence of $\sum \frac{\sqrt{a_{n}}}{n}$ if $a_n\geq 0$.,"import Mathlib

/-- Rudin, Exercise 3.7: If (a_n) is a sequence of nonnegative real numbers with Σ a_n convergent,
then Σ sqrt(a_n)/(n+1) converges. We state the result here; the proof is omitted. -/
theorem Rudin_exercise_3_7 {a : ℕ → ℝ} (h_nonneg : ∀ n, 0 ≤ a n) (h_sum : Summable a) :
  Summable fun n => Real.sqrt (a n) / ((n + 1 : ℕ) : ℝ) := by sorry
"
Rudin_exercise_3_13,Analysis,success,True,3,Prove that the Cauchy product of two absolutely convergent series converges absolutely.,"import Mathlib

/-- Rudin, Exercise 3.13 (Cauchy product of absolutely convergent series).
If (a_n) and (b_n) are real sequences with absolutely convergent series,
then the Cauchy product c_k := ∑_{i=0}^k a_i * b_{k-i} is absolutely summable. -/
theorem Rudin_exercise_3_13 {a b : ℕ → ℝ}
  (ha : Summable fun n => |a n|)
  (hb : Summable fun n => |b n|) :
  Summable fun k => |∑ i in Finset.range (k+1), a i * b (k - i)| := by sorry
"
Rudin_exercise_2_27b,Analysis,success,True,3,"Suppose $E\subset\mathbb{R}^k$ is uncountable, and let $P$ be the set of condensation points of $E$. Prove that at most countably many points of $E$ are not in $P$.","import Mathlib

open Set Filter

variable {k : ℕ}

/-- A point x is a condensation point of E if every neighborhood of x meets E in an uncountable set. -/
def isCondensationPoint (E : Set (Fin k → ℝ)) (x : Fin k → ℝ) : Prop :=
  ∀ U, U ∈ nhds x → ¬ (E ∩ U).Countable

/-- Rudin, exercise 2.27(b): Suppose E ⊆ ℝ^k is uncountable, and let P be the set of condensation
points of E. Prove that at most countably many points of E are not in P. -/
theorem Rudin_exercise_2_27b (E : Set (Fin k → ℝ)) (hE : ¬ E.Countable) :
  (E \ {x | isCondensationPoint E x}).Countable := by
  sorry
"
Rudin_exercise_3_5,Analysis,success,True,3,"For any two real sequences $\left\{a_{n}\right\},\left\{b_{n}\right\}$, prove that $\limsup _{n \rightarrow \infty}\left(a_{n}+b_{n}\right) \leq \limsup _{n \rightarrow \infty} a_{n}+\limsup _{n \rightarrow \infty} b_{n},$ provided the sum on the right is not of the form $\infty-\infty$.","import Mathlib

/-- Rudin exercise 3.5: For real sequences a_n, b_n one has
    limsup_{n→∞} (a_n + b_n) ≤ limsup_{n→∞} a_n + limsup_{n→∞} b_n,
    provided the sum on the right is not of the form ∞ - ∞.

This file gives a direct Lean formulation of the statement; the proof is omitted. -/

theorem limsup_add_le {a b : ℕ → ℝ} :
  Filter.limsup (fun n => a n + b n) ≤ (Filter.limsup a + Filter.limsup b) := by sorry
"
Rudin_exercise_4_4b,Analysis,success,True,3,"Let $f$ and $g$ be continuous mappings of a metric space $X$ into a metric space $Y$, and let $E$ be a dense subset of $X$. Prove that if $g(p) = f(p)$ for all $p \in P$ then $g(p) = f(p)$ for all $p \in X$.","import Mathlib

/-- Let f and g be continuous mappings of a metric space X into a metric space Y,
    and let E be a dense subset of X. Prove that if g(p) = f(p) for all p in E
    then g(p) = f(p) for all p in X. -/

theorem Rudin_exercise_4_4b {X : Type _} {Y : Type _} [MetricSpace X] [MetricSpace Y]
  {f g : X → Y} (hf : Continuous f) (hg : Continuous g) {E : Set X} (hE : Dense E)
  (hfg : ∀ p ∈ E, g p = f p) : ∀ p : X, g p = f p := by sorry
"
Rudin_exercise_4_1a,Analysis,success,True,2,Suppose $f$ is a real function defined on $\mathbb{R}$ which satisfies $\lim_{h \rightarrow 0} f(x + h) - f(x - h) = 0$ for every $x \in \mathbb{R}$. Show that $f$ does not need to be continuous.,"import Mathlib

/-!
Exercise: Suppose f is a real function defined on ℝ which satisfies
  lim_{h→0} f(x+h) - f(x-h) = 0 for every x ∈ ℝ.
Show that f does not need to be continuous.

Example: f(x) = 1 if x = 0, and f(x) = 0 otherwise. This has a removable
discontinuity at 0 but for every x the symmetric difference f(x+h)-f(x-h)
converges to 0 as h → 0.
-/

theorem Rudin_exercise_4_1a :
  ∃ f : ℝ → ℝ,
    (∀ x : ℝ, Tendsto (fun h : ℝ => f (x + h) - f (x - h)) (nhds 0) (nhds 0)) ∧
    ¬ Continuous (fun x : ℝ => f x) := by
  sorry
"
Rudin_exercise_4_3,Analysis,success,True,3,Let $f$ be a continuous real function on a metric space $X$. Let $Z(f)$ (the zero set of $f$ ) be the set of all $p \in X$ at which $f(p)=0$. Prove that $Z(f)$ is closed.,"import Mathlib

/-!
Exercise (Rudin 4.3).
Let X be a metric space and f : X → ℝ a continuous function.
Let Z(f) := { p ∈ X | f p = 0 }. Prove that Z(f) is closed.
-/

variable {X : Type _} [MetricSpace X] {f : X → ℝ}

theorem Rudin_exercise_4_3 (hf : Continuous f) : IsClosed { p : X | f p = 0 } := by
  -- proof omitted
  sorry
"
Rudin_exercise_3_21,Analysis,success,True,3,"If $\left\{E_{n}\right\}$ is a sequence of closed nonempty and bounded sets in a complete metric space $X$, if $E_{n} \supset E_{n+1}$, and if $\lim _{n \rightarrow \infty} \operatorname{diam} E_{n}=0,$ then $\bigcap_{1}^{\infty} E_{n}$ consists of exactly one point.","import Mathlib

/-
Rudin, Principles of Mathematical Analysis, Exercise 3.21 (translation to Lean4)
If {E_n} is a sequence of closed nonempty and bounded sets in a complete metric space X,
if E_n ⊇ E_{n+1}, and if diam E_n → 0, then ⋂_{n=1}^∞ E_n consists of exactly one point.

This file states the theorem. The proof is omitted (``by sorry'').
-/

theorem Rudin_exercise_3_21 {X : Type _} [MetricSpace X] [CompleteSpace X] (E : ℕ → Set X)
  (h_closed : ∀ n, IsClosed (E n))
  (h_nonempty : ∀ n, (E n).Nonempty)
  (h_bdd : ∀ n, Bounded (E n))
  (h_mono : ∀ n, E n ⊇ E (n+1))
  -- instead of using `diam` we express the diameter condition directly:
  (h_diam : ∀ ε > 0, ∃ N, ∀ n, n ≥ N → ∀ x y, x ∈ E n → y ∈ E n → dist x y < ε) :
  ∃! x, x ∈ ⋂ n, E n := by sorry
"
Rudin_exercise_4_11a,Analysis,success,True,2,Suppose $f$ is a uniformly continuous mapping of a metric space $X$ into a metric space $Y$ and prove that $\left\{f\left(x_{n}\right)\right\}$ is a Cauchy sequence in $Y$ for every Cauchy sequence $\{x_n\}$ in $X$.,"import Mathlib

/--
Suppose f is a uniformly continuous mapping of a metric space X into a metric space Y.
Then for every Cauchy sequence x : ℕ → X, the sequence f ∘ x is a Cauchy sequence in Y.
-/
theorem Rudin_exercise_4_11a {X Y : Type _} [MetricSpace X] [MetricSpace Y] {f : X → Y}
  (hf : UniformContinuous f) :
  ∀ (x : ℕ → X), IsCauchySeq x → IsCauchySeq (f ∘ x) := by sorry
"
Rudin_exercise_4_8a,Analysis,success,True,3,Let $f$ be a real uniformly continuous function on the bounded set $E$ in $R^{1}$. Prove that $f$ is bounded on $E$.,"import Mathlib
open Set Filter TopologicalSpace Bornology
open scoped ENNReal NNReal Uniformity Topology
open Lean Meta Qq Function
open Metric

/-- Let f be a real uniformly continuous function on the bounded set E in R^1. Prove that f is bounded on E. -/
theorem isBounded_of_uniformContinuous_of_bounded_tac_35206 (f : ℝ → ℝ) (E : Set ℝ) (hE : IsBounded E) (hf : UniformContinuousOn f E) : IsBoundedOn f E := by sorry
"
Rudin_exercise_2_29,Analysis,success,True,3,Prove that every open set in $\mathbb{R}$ is the union of an at most countable collection of disjoint segments.,"import Mathlib

/-!
# Rudin exercise 2.29

Statement: Every open set in ℝ is the union of an at most countable collection of disjoint segments.
-/

open Set

/-- Every open set in ℝ is the union of an at most countable collection of disjoint open intervals. -/
theorem open_set_union_countable_disjoint_intervals {U : Set ℝ} (hU : IsOpen U) :
  ∃ S : Set (Set ℝ),
    Countable S ∧
    (∀ I ∈ S, ∃ a b : ℝ, a < b ∧ I = Ioo a b) ∧
    (∀ I J, I ∈ S → J ∈ S → (I = J ∨ I ∩ J = ∅)) ∧
    U = ⋃₀ S := by sorry
"
Rudin_exercise_4_15,Analysis,success,True,3,Prove that every continuous open mapping of $R^{1}$ into $R^{1}$ is monotonic.,"import Mathlib

/-!
# Rudin exercise 4.15

Statement: Every continuous open mapping of ℝ into ℝ is monotonic.
-/

theorem Rudin_exercise_4_15 (f : ℝ → ℝ) (h_cont : Continuous f) (h_open : IsOpenMap f) :
  Monotone f ∨ Antitone f := by sorry
"
Rudin_exercise_5_1,Analysis,success,True,3,"Let $f$ be defined for all real $x$, and suppose that $|f(x)-f(y)| \leq (x-y)^{2}$ for all real $x$ and $y$. Prove that $f$ is constant.","import Mathlib

/-- Rudin exercise: If f : ℝ → ℝ satisfies |f(x)-f(y)| ≤ (x-y)^2 for all real x,y,
    then f is constant. -/
theorem Rudin_exercise_5_1 (f : ℝ → ℝ) (h : ∀ x y : ℝ, |f x - f y| ≤ (x - y) ^ 2) : ∃ c : ℝ, ∀ x, f x = c := by sorry
"
Rudin_exercise_5_3,Analysis,success,True,2,"Suppose $g$ is a real function on $R^{1}$, with bounded derivative (say $\left|g^{\prime}\right| \leq M$ ). Fix $\varepsilon>0$, and define $f(x)=x+\varepsilon g(x)$. Prove that $f$ is one-to-one if $\varepsilon$ is small enough.","import Mathlib

/--
Suppose g : ℝ → ℝ has bounded derivative |g'| ≤ M. Fix ε > 0 and define f(x) = x + ε g(x).
Then f is one-to-one for sufficiently small ε.
-/

theorem Rudin_exercise_5_3 (g : ℝ → ℝ) (M : ℝ) (hM : 0 ≤ M)
  (hg : Differentiable ℝ g) (hbound : ∀ x : ℝ, |deriv g x| ≤ M) :
  ∃ ε0 : ℝ, ε0 > 0 ∧ ∀ ε : ℝ, |ε| < ε0 → Function.Injective (fun x => x + ε * g x) := by sorry
"
Rudin_exercise_4_21a,Analysis,success,True,3,"Suppose $K$ and $F$ are disjoint sets in a metric space $X, K$ is compact, $F$ is closed. Prove that there exists $\delta>0$ such that $d(p, q)>\delta$ if $p \in K, q \in F$.","import Mathlib

variable {X : Type _} [MetricSpace X] {K F : Set X}

/-- Rudin exercise: If K and F are disjoint subsets of a metric space X, with K compact and F closed,
then there exists δ > 0 such that dist p q ≥ δ for all p ∈ K and q ∈ F. -/
theorem Rudin_exercise_4_21a (hK : IsCompact K) (hF : IsClosed F) (hdisj : Disjoint K F) :
  ∃ δ : ℝ, δ > 0 ∧ ∀ p ∈ K, ∀ q ∈ F, dist p q ≥ δ := by sorry
"
Rudin_exercise_5_5,Analysis,success,True,3,"Suppose $f$ is defined and differentiable for every $x>0$, and $f^{\prime}(x) \rightarrow 0$ as $x \rightarrow+\infty$. Put $g(x)=f(x+1)-f(x)$. Prove that $g(x) \rightarrow 0$ as $x \rightarrow+\infty$.","import Mathlib

open Filter

/--
Suppose f is defined and differentiable for every x>0, and f' x → 0 as x → +∞.
Put g(x) = f(x+1) - f(x). Then g(x) → 0 as x → +∞.
-/
theorem Rudin_exercise_5_5 {f : ℝ → ℝ}
  (h_diff : ∀ x, 0 < x → DifferentiableAt ℝ f x)
  (h_deriv_lim : Tendsto (fun x => deriv f x) atTop (𝓝 0)) :
  Tendsto (fun x => f (x + 1) - f x) atTop (𝓝 0) := by
  sorry
"
Rudin_exercise_4_5b,Analysis,success,True,3,"Show that there exist a set $E \subset \mathbb{R}$ and a real continuous function $f$ defined on $E$, such that there does not exist a continuous real function $g$ on $\mathbb{R}$ such that $g(x)=f(x)$ for all $x \in E$.","import Mathlib

open Set

/-- Rudin, Exercise 4.5(b).
There exists a subset E of ℝ and a function f : E → ℝ which is continuous (as a map from the
subtype E) but which admits no continuous extension g : ℝ → ℝ with g x = f x for all x ∈ E.
A concrete choice is E = {1/(n+1), -1/(n+1) | n : ℕ} and f(1/(n+1)) = 1, f(-1/(n+1)) = -1.
(The proof that this f is continuous on E and cannot be extended continuously to ℝ is omitted.) -/
theorem Rudin_exercise_4_5b :
  ∃ (E : Set ℝ) (f : ↥E → ℝ),
    Continuous f ∧ ¬ ∃ g : ℝ → ℝ, Continuous g ∧ ∀ x : ↥E, g (x : ℝ) = f x := by
  -- Take E = range (fun n => (1 : ℝ) / (n + 1)) ∪ range (fun n => - (1 : ℝ) / (n + 1))
  -- and define f on E by f(x) = 1 if x > 0 and f(x) = -1 if x < 0.
  -- Then f is continuous on E (each point of E is isolated in E) but any continuous extension
  -- to ℝ would force contradictory limits at 0, so no such extension exists.
  sorry
"
Rudin_exercise_5_7,Analysis,success,True,3,"Suppose $f^{\prime}(x), g^{\prime}(x)$ exist, $g^{\prime}(x) \neq 0$, and $f(x)=g(x)=0$. Prove that $\lim _{t \rightarrow x} \frac{f(t)}{g(t)}=\frac{f^{\prime}(x)}{g^{\prime}(x)}.$","import Mathlib

/-- Suppose f'(x), g'(x) exist, g'(x) ≠ 0, and f(x)=g(x)=0. Then
    lim_{t → x} f(t)/g(t) = f'(x)/g'(x).

This is a local form of L'Hôpital's rule in the case where both functions vanish at x. -/
theorem lhopital_local_zero {f g : ℝ → ℝ} {x a b : ℝ}
  (hf : HasDerivAt f a x) (hg : HasDerivAt g b x) (hb : b ≠ 0) (hf0 : f x = 0) (hg0 : g x = 0) :
  Tendsto (fun t => f t / g t) (𝓝 x) (𝓝 (a / b)) := by sorry
"
Munkres_exercise_13_5b,Topology,success,True,3,"Show that if $\mathcal{A}$ is a subbasis for a topology on $X$, then the topology generated by $\mathcal{A}$ equals the intersection of all topologies on $X$ that contain $\mathcal{A}$.","import Mathlib
open Set Filter TopologicalSpace
open Filter Topology

/-- Show that if \mathcal{A} is a subbasis for a topology on X, then the topology generated by \mathcal{A} equals the intersection of all topologies on X that contain \mathcal{A}. -/
theorem generate_subbasis_eq_sInf {X : Type*} (𝒜 : Set (Set X)) (h𝒜 : IsSubbasis 𝒜) :
    generateFrom 𝒜 = sInf { t : TopologicalSpace X | ∀ U ∈ 𝒜, IsOpen t U } := by sorry
"
Rudin_exercise_5_17,Analysis,success,True,3,"Suppose $f$ is a real, three times differentiable function on $[-1,1]$, such that $f(-1)=0, \quad f(0)=0, \quad f(1)=1, \quad f^{\prime}(0)=0 .$ Prove that $f^{(3)}(x) \geq 3$ for some $x \in(-1,1)$.","import Mathlib

/-
Exercise (Rudin 5.17, informal):
Suppose f is a real, three times differentiable function on [-1,1],
such that f(-1) = 0, f(0) = 0, f(1) = 1, f'(0) = 0.
Prove that f^{(3)}(x) ≥ 3 for some x ∈ (-1,1).

This file contains only a formal statement (no proof):
-/

theorem Rudin_exercise_5_17 {f : ℝ → ℝ}
  (h_cont : ContDiffOn ℝ 3 f (Set.Icc (-1:ℝ) 1))
  (h_left : f (-1) = 0)
  (h_zero : f 0 = 0)
  (h_right : f 1 = 1)
  (h_deriv0 : deriv f 0 = 0) :
  ∃ x ∈ Set.Ioo (-1:ℝ) 1, deriv (deriv (deriv f)) x ≥ 3 := by
  sorry
"
Munkres_exercise_13_4b2,Topology,success,True,3,Let $\mathcal{T}_\alpha$ be a family of topologies on $X$. Show that there is a unique largest topology on $X$ contained in all the collections $\mathcal{T}_\alpha$.,"import Mathlib

open Set

/-- A predicate saying a collection of subsets of `X` is a topology. -/
def is_topology {X : Type _} (T : Set (Set X)) : Prop :=
  (∅ : Set X) ∈ T ∧ (univ : Set X) ∈ T ∧
  (∀ U V : Set X, U ∈ T → V ∈ T → U ∩ V ∈ T) ∧
  (∀ S : Set (Set X), S ⊆ T → Set.sUnion S ∈ T)

/-- Given a family `T : ι → Set (Set X)` of topologies on `X`, the intersection
    of all `T i` is a topology, and it is the unique largest topology contained
    in every `T i`. -/
theorem exists_unique_largest_topology {X : Type _} {ι : Sort _} (T : ι → Set (Set X))
  (h : ∀ i, is_topology (T i)) :
  ∃! S : Set (Set X),
    is_topology S ∧ S ⊆ (⋂ i, T i) ∧ (∀ S', is_topology S' → S' ⊆ (⋂ i, T i) → S' ⊆ S) := by
  sorry
"
Munkres_exercise_16_6,Topology,success,True,3,"Show that the countable collection \[\{(a, b) \times (c, d) \mid a < b \text{ and } c < d, \text{ and } a, b, c, d \text{ are rational}\}\] is a basis for $\mathbb{R}^2$.","import Mathlib

open Set

/-- The collection of open rectangles with rational endpoints in R^2. -/
def rational_rectangle_basis_set : Set (Set (ℝ × ℝ)) :=
  { S | ∃ (a b c d : ℚ), (a : ℝ) < (b : ℝ) ∧ (c : ℝ) < (d : ℝ) ∧
      S = Set.prod (Set.Ioo (a : ℝ) (b : ℝ)) (Set.Ioo (c : ℝ) (d : ℝ)) }

/-- Exercise: The countable collection of rational open rectangles is a basis for R^2. -/
theorem Munkres_exercise_16_6 : IsTopologicalBasis rational_rectangle_basis_set ∧ Countable rational_rectangle_basis_set := by
  sorry
"
Munkres_exercise_13_3b,Topology,success,True,3,Show that the collection $$\mathcal{T}_\infty = \{U | X - U \text{ is infinite or empty or all of X}\}$$ does not need to be a topology on the set $X$.,"import Mathlib

open Set

/-- The collection T_inf on a type X: a subset U is in T_inf if the complement
    of U is infinite, or empty, or all of X. -/
def T_inf (X : Type) : Set (Set X) :=
  { U | Set.Infinite ((univ : Set X) \ U) ∨ ((univ : Set X) \ U) = (\empty : Set X) ∨ ((univ : Set X) \ U) = (univ : Set X) }

/-- A simple family of subsets of ℕ: U n = { m | 1 ≤ m ≤ n } (so U 0 = ∅). -/
def U (n : ℕ) : Set ℕ := { m | 1 ≤ m ∧ m ≤ n }

def s_range : Set (Set ℕ) := Set.range U

/-- Counterexample: the family s_range consists of sets each of which has an
    infinite complement, but the union ⋃₀ s_range = {1,2,3,...} has finite
    nonempty complement {0}, so the union is not in T_inf. -/
theorem Munkres_exercise_13_3b : ∃ (s : Set (Set ℕ)), (∀ U ∈ s, U ∈ T_inf ℕ) ∧ Set.sUnion s ∉ T_inf ℕ := by sorry
"
Munkres_exercise_16_1,Topology,success,True,3,"Show that if $Y$ is a subspace of $X$, and $A$ is a subset of $Y$, then the topology $A$ inherits as a subspace of $Y$ is the same as the topology it inherits as a subspace of $X$.","import Mathlib

/-- If Y is a subspace of X, and A is a subset of Y, then the topology A inherits as a subspace
of Y is the same as the topology it inherits as a subspace of X. -/

theorem subspace_subspace_eq {X : Type*} (t : TopologicalSpace X)
  {Y : Set X} {A : Set Y} :
  -- regard A as a subset of X via the subtype mapping (subtype.val : A → X)
  TopologicalSpace.induced (Subtype.val : A → X) t =
    -- first induce t on Y, then induce on A (as subset of Y)
    TopologicalSpace.induced (Subtype.val : A → Y) (TopologicalSpace.induced (Subtype.val : Y → X) t) := by sorry
"
Munkres_exercise_13_4a2,Topology,success,True,3,"If $\mathcal{T}_\alpha$ is a family of topologies on $X$, show that $\bigcup \mathcal{T}_\alpha$ does not need to be a topology on $X$.","import Mathlib

/-- A basic predicate saying a collection of subsets is a topology on X. -/
def is_topology (X : Type) (T : Set (Set X)) : Prop :=
  (∅ : Set X) ∈ T ∧ (univ : Set X) ∈ T ∧
  (∀ 𝓐 : Set (Set X), 𝓐 ⊆ T → ⋃₀ 𝓐 ∈ T) ∧
  (∀ U V : Set X, U ∈ T → V ∈ T → U ∩ V ∈ T)

/-- Concrete counterexample on a three-point set.  Let T1 = {∅, univ, {0}} and
    T2 = {∅, univ, {1}}.  Each is a topology on Fin 3, but their union is not
    closed under unions: {0} ∪ {1} = {0,1} is not in T1 ∪ T2. -/
def T1 : Set (Set (Fin 3)) := ({(∅ : Set (Fin 3)), (univ : Set (Fin 3)), ({0} : Set (Fin 3))} : Set (Set (Fin 3)))

def T2 : Set (Set (Fin 3)) := ({(∅ : Set (Fin 3)), (univ : Set (Fin 3)), ({1} : Set (Fin 3))} : Set (Set (Fin 3)))

theorem union_of_topologies_need_not_be_topology :
  is_topology (Fin 3) T1 ∧ is_topology (Fin 3) T2 ∧ ¬ is_topology (Fin 3) (T1 ∪ T2) := by sorry
"
Munkres_exercise_20_2,Topology,success,True,3,Show that $\mathbb{R} \times \mathbb{R}$ in the dictionary order topology is metrizable.,"import Mathlib

/-!
Show that R × R in the dictionary (lexicographic) order topology is metrizable.
We state the theorem and leave the proof as `by sorry`.
-/

open TopologicalSpace

/-- The lexicographic order on R × R gives a linear order topology (order topology).
We assert that this topology is metrizable. -/

theorem R_mul_R_lexico_metrizable : MetrizableSpace (R × R) := by sorry
"
Munkres_exercise_18_8a,Topology,success,True,3,"Let $Y$ be an ordered set in the order topology. Let $f, g: X \rightarrow Y$ be continuous. Show that the set $\{x \mid f(x) \leq g(x)\}$ is closed in $X$.","import Mathlib

variable {X Y : Type _} [TopologicalSpace X] [LinearOrder Y] [TopologicalSpace Y] [OrderTopology Y]

/-- Let Y be an ordered set in the order topology. Let f, g : X → Y be continuous.
    The set {x | f x ≤ g x} is closed in X. -/
theorem Munkres_exercise_18_8a {f g : X → Y} (hf : Continuous f) (hg : Continuous g) : IsClosed { x | f x ≤ g x } := by
  sorry
"
Munkres_exercise_22_2a,Topology,success,True,3,"Let $p: X \rightarrow Y$ be a continuous map. Show that if there is a continuous map $f: Y \rightarrow X$ such that $p \circ f$ equals the identity map of $Y$, then $p$ is a quotient map.","import Mathlib

/-!
Munkres, Topology, Exercise 22.2(a):
Let p : X → Y be a continuous map. Show that if there is a continuous map f : Y → X such that
p ∘ f = id_Y, then p is a quotient map.
-/

open Topology

variable {X Y : Type*} [TopologicalSpace X] [TopologicalSpace Y]

/-- If p has a continuous right inverse f (so p ∘ f = id), then p is a quotient map. -/
theorem Munkres_exercise_22_2a (p : X → Y) (hp : Continuous p)
  (f : Y → X) (hf : Continuous f) (hpf : p ∘ f = id) : QuotientMap p := by sorry
"
Munkres_exercise_13_8a,Topology,success,True,3,"Show that the collection $\{(a,b) \mid a < b, a \text{ and } b \text{ rational}\}$ is a basis that generates the standard topology on $\mathbb{R}$.","import Mathlib

/-- The collection of open intervals with rational endpoints. -/
def rat_open_intervals : Set (Set ℝ) :=
  { U | ∃ (a b : ℚ), (a : ℝ) < b ∧ U = Ioo (a : ℝ) (b : ℝ) }

/-- Exercise: Show that the collection of open intervals with rational endpoints
    is a basis that generates the standard topology on ℝ. -/
theorem Munkres_exercise_13_8a :
  TopologicalSpace.IsTopologicalBasis rat_open_intervals ∧
  TopologicalSpace.generateFrom rat_open_intervals = (inferInstance : TopologicalSpace ℝ) := by
  sorry
"
Munkres_exercise_21_6b,Topology,success,True,3,"Define $f_{n}:[0,1] \rightarrow \mathbb{R}$ by the equation $f_{n}(x)=x^{n}$. Show that the sequence $\left(f_{n}\right)$ does not converge uniformly.","import Mathlib
open scoped Classical
open Set Function Filter Finset Metric
open scoped Classical
open Topology Nat uniformity NNReal ENNReal

/-- Define $f_{n}:[0,1] \rightarrow \mathbb{R}$ by the equation $f_{n}(x)=x^{n}$. Show that the sequence \left(f_{n}\right) does not converge uniformly. -/
theorem not_tendstoUniformlyOn_pow_extracted (n : ℕ) : ¬TendstoUniformlyOn (fun x => x ^ n) (fun x => x) atTop (Icc 0 1) := by sorry
"
Munkres_exercise_23_3,Topology,success,True,3,"Let $\left\{A_{\alpha}\right\}$ be a collection of connected subspaces of $X$; let $A$ be a connected subset of $X$. Show that if $A \cap A_{\alpha} \neq \varnothing$ for all $\alpha$, then $A \cup\left(\bigcup A_{\alpha}\right)$ is connected.","import Mathlib

/-- Let {A_α} be a collection of connected subspaces of X; let A be a connected subset of X.
    If A ∩ A_α ≠ ∅ for all α, then A ∪ (⋃ α, A_α) is connected. -/
theorem connected_union_of_connected_with_common_point {X : Type*} [TopologicalSpace X]
  {ι : Type*} {A : Set X} {Aα : ι → Set X}
  (hA : IsConnected A)
  (hAα : ∀ i, IsConnected (Aα i))
  (hnonempty : ∀ i, (A ∩ Aα i).Nonempty) :
  IsConnected (A ∪ ⋃ i, Aα i) := by sorry
"
Munkres_exercise_22_5,Topology,success,True,2,"Let $p \colon X \rightarrow Y$ be an open map. Show that if $A$ is open in $X$, then the map $q \colon A \rightarrow p(A)$ obtained by restricting $p$ is an open map.","import Mathlib

open Set

variable {X Y : Type*} [TopologicalSpace X] [TopologicalSpace Y]

/-- Given p : X → Y and an open set A ⊆ X, the restriction q : A → p '' A is the map sending a ↦ p a. -/
def restrict_map (p : X → Y) (A : Set X) (hA : IsOpen A) : A → p '' A :=
  fun a => ⟨p a, ⟨a, a.2, rfl⟩⟩

/-- If p is an open map and A is open in X, then the restriction q : A → p '' A is an open map. -/
theorem restrict_map_is_open (p : X → Y) (hp : ∀ U : Set X, IsOpen U → IsOpen (p '' U)) {A : Set X} (hA : IsOpen A) :
  ∀ U : Set A, IsOpen U → IsOpen ((restrict_map p A hA) '' U : Set (p '' A)) := by sorry
"
Munkres_exercise_24_3a,Topology,success,True,2,"Let $f \colon X \rightarrow X$ be continuous. Show that if $X = [0, 1]$, there is a point $x$ such that $f(x) = x$. (The point $x$ is called a fixed point of $f$.)","import Mathlib

/-!
Munkres exercise 24.3(a).
Let f : X → X be continuous. Show that if X = [0,1], there is a point x such that f x = x.
This file states the intermediate value / fixed point formulation on the real closed interval.
-/-

open Set

theorem munkres_exercise_24_3a {f : ℝ → ℝ}
  (h_cont : Continuous f)
  (h_range : ∀ x ∈ (Icc (0 : ℝ) (1 : ℝ)), f x ∈ Icc (0 : ℝ) (1 : ℝ)) :
  ∃ x ∈ (Icc (0 : ℝ) (1 : ℝ)), f x = x := by
  sorry
"
Munkres_exercise_18_13,Topology,success,True,3,"Let $A \subset X$; let $f: A \rightarrow Y$ be continuous; let $Y$ be Hausdorff. Show that if $f$ may be extended to a continuous function $g: \bar{A} \rightarrow Y$, then $g$ is uniquely determined by $f$.","import Mathlib

theorem unique_continuous_extension {X Y : Type*} [TopologicalSpace X] [TopologicalSpace Y] [T2Space Y]
  {A : Set X} {f : A → Y} (hf : Continuous f)
  {g1 g2 : Subtype (closure A) → Y} (hg1 : Continuous g1) (hg2 : Continuous g2)
  (h1 : ∀ a : A, g1 ⟨(a : X), subset_closure A a.2⟩ = f a)
  (h2 : ∀ a : A, g2 ⟨(a : X), subset_closure A a.2⟩ = f a) : g1 = g2 := by sorry
"
Munkres_exercise_23_11,Topology,success,True,3,"Let $p: X \rightarrow Y$ be a quotient map. Show that if each set $p^{-1}(\{y\})$ is connected, and if $Y$ is connected, then $X$ is connected.","import Mathlib

/--
Let p : X → Y be a quotient map. Show that if each set p^{-1}({y}) is connected,
and if Y is connected, then X is connected.
-/
theorem Munkres_exercise_23_11 {X Y : Type*} [TopologicalSpace X] [TopologicalSpace Y]
  (p : X → Y) (hq : QuotientMap p) (hfib : ∀ y, IsConnected (p ⁻¹' ({y} : Set Y)))
  (hY : ConnectedSpace Y) : ConnectedSpace X := by sorry
"
Munkres_exercise_23_6,Topology,success,True,3,"Let $A \subset X$. Show that if $C$ is a connected subspace of $X$ that intersects both $A$ and $X-A$, then $C$ intersects $\operatorname{Bd} A$.","import Mathlib

open Set

variable {X : Type _} [TopologicalSpace X]

/-- If C is a connected subspace of X and C meets both A and its complement, then C meets the boundary of A. -/
theorem Munkres_exercise_23_6 {A C : Set X}
  (hC : IsConnected C) (h1 : (C ∩ A).Nonempty) (h2 : (C ∩ (X \ A)).Nonempty) :
  (C ∩ frontier A).Nonempty := by sorry
"
Munkres_exercise_26_12,Topology,success,True,3,"Let $p: X \rightarrow Y$ be a closed continuous surjective map such that $p^{-1}(\{y\})$ is compact, for each $y \in Y$. (Such a map is called a perfect map.) Show that if $Y$ is compact, then $X$ is compact.","import Mathlib

/-!
Exercise (Munkres 26.12).
Let p : X → Y be a closed continuous surjective map such that p^{-1}({y}) is compact, for each y ∈ Y.
(Such a map is called a perfect map.) Show that if Y is compact, then X is compact.
-/

variables {X Y : Type*} [TopologicalSpace X] [TopologicalSpace Y]

/-- A closed continuous surjective map with compact fibers (a perfect map) sends compact spaces
to compact spaces. -/
theorem perfect_map_compact (p : X → Y) (hcont : Continuous p) (hclosed : IsClosedMap p)
  (hsurj : Function.Surjective p) (hfib : ∀ y : Y, IsCompact (p ⁻¹' ({y} : Set Y)))
  [CompactSpace Y] : CompactSpace X := by sorry
"
Munkres_exercise_25_9,Topology,success,True,3,Let $G$ be a topological group; let $C$ be the component of $G$ containing the identity element $e$. Show that $C$ is a normal subgroup of $G$.,"import Mathlib

variable {G : Type _} [Group G] [TopologicalSpace G] [TopologicalGroup G]

/-- Let G be a topological group; let C be the component of G containing the identity element e.
    Show that C is a normal subgroup of G. -/
def Munkres_exercise_25_9 : Prop :=
  let C : Set G := connected_component (1 : G)
  (∀ x y, x ∈ C → y ∈ C → x * y ∈ C) ∧ (∀ x, x ∈ C → x⁻¹ ∈ C) ∧ (∀ g h, h ∈ C → g * h * g ⁻¹ ∈ C) := by sorry
"
Munkres_exercise_28_4,Topology,success,True,3,"A space $X$ is said to be countably compact if every countable open covering of $X$ contains a finite subcollection that covers $X$. Show that for a $T_1$ space $X$, countable compactness is equivalent to limit point compactness.","import Mathlib

open Set

/-- A topological space X is countably compact if every countable open cover has a finite subcover. -/
def countably_compact (X : Type*) [TopologicalSpace X] : Prop :=
  ∀ (U : ℕ → Set X), (∀ n, IsOpen (U n)) → (⋃ n, U n = univ) → ∃ (s : Finset ℕ), (⋃ i ∈ s, U i) = univ

/-- x is a limit point of s if every neighborhood of x contains a point of s different from x. -/
def is_limit_point {X : Type*} [TopologicalSpace X] (x : X) (s : Set X) : Prop :=
  ∀ (U : Set X), IsOpen U → x ∈ U → ∃ y, y ∈ s ∧ y ≠ x ∧ y ∈ U

/-- A space is limit point compact if every infinite subset has a limit point. -/
def limit_point_compact (X : Type*) [TopologicalSpace X] : Prop :=
  ∀ s : Set X, s.Infinite → ∃ x : X, is_limit_point x s

/-- In a T1 space, countable compactness is equivalent to limit point compactness. -/
theorem countably_compact_iff_limit_point_compact_of_T1 {X : Type*} [TopologicalSpace X] [T1Space X] :
  countably_compact X ↔ limit_point_compact X := by
  -- proof omitted
  sorry
"
Munkres_exercise_30_10,Topology,success,True,3,"Show that if $X$ is a countable product of spaces having countable dense subsets, then $X$ has a countable dense subset.","import Mathlib

open Set

theorem countable_prod_of_countable_dense {ι : Type*} [Countable ι] {X : ι → Type*}
  [∀ i, TopologicalSpace (X i)] (D : ∀ i, Set (X i))
  (hD_countable : ∀ i, (D i).Countable) (hD_dense : ∀ i, Dense (D i)) :
  ∃ S : Set (∀ i, X i), S.Countable ∧ Dense S := by sorry
"
Munkres_exercise_31_3,Topology,success,True,3,Show that every order topology is regular.,"import Mathlib

/-!
Show that every order topology is regular:
If α is a linear order with the order topology then α is a regular_space.
-/

variable {α : Type*} [LinearOrder α] [TopologicalSpace α] [OrderTopology α]

theorem order_topology_regular : RegularSpace α := by sorry
"
Munkres_exercise_31_1,Topology,success,True,3,"Show that if $X$ is regular, every pair of points of $X$ have neighborhoods whose closures are disjoint.","import Mathlib
open Set Topology

/-- Show that if $X$ is regular, every pair of points of $X$ have neighborhoods whose closures are disjoint. -/
lemma regular_iff_pairwise_disjoint_closed_nhd_tac_4791 [TopologicalSpace X] : RegularSpace X → ∀ (x y : X), x ≠ y → ∃ U V, IsClosed U ∧ IsClosed V ∧ x ∈ U ∧ y ∈ V ∧ U ∩ V = ∅ := by sorry
"
Munkres_exercise_29_4,Topology,success,True,3,"Show that $[0, 1]^\omega$ is not locally compact in the uniform topology.","import Mathlib

open Set

/-- The closed unit interval in ℝ. -/
def I : Set ℝ := Set.Icc (0 : ℝ) 1

/-- The space X = [0,1]^ℕ as a subtype of ℕ → ℝ. -/
def X : Type := { f : ℕ → ℝ // ∀ n, f n ∈ I }

/- We consider X equipped with the uniform topology coming from the sup metric
   d(f,g) = sup_n |f n - g n| (the topology of uniform convergence).
   The following asserts that this topological space is not locally compact. -/

theorem Munkres_exercise_29_4 : ¬ LocallyCompactSpace X := by
  sorry
"
Munkres_exercise_32_2a,Topology,success,True,2,"Show that if $\prod X_\alpha$ is Hausdorff, then so is $X_\alpha$. Assume that each $X_\alpha$ is nonempty.","import Mathlib

/-!
Munkres exercise 32.2(a):
If the product of spaces Π X_α is Hausdorff (T2), then each factor X_α is Hausdorff,
assuming each X_α is nonempty.
-/

theorem Munkres_exercise_32_2a {ι : Type*} {X : ι → Type*}
  [∀ i, TopologicalSpace (X i)] (h : T2Space (∀ i, X i)) (hn : ∀ i, Nonempty (X i))
  (i : ι) : T2Space (X i) := by
  sorry
"
Munkres_exercise_32_2c,Topology,success,True,3,"Show that if $\prod X_\alpha$ is normal, then so is $X_\alpha$. Assume that each $X_\alpha$ is nonempty.","import Mathlib

/-!
Show that if the product Π X_α is normal, then so is each X_α.
Assume that each X_α is nonempty.
-/

theorem Munkres_exercise_32_2c {ι : Type*} {X : ι → Type*}
  [∀ i, TopologicalSpace (X i)] [∀ i, Nonempty (X i)] :
  NormalSpace (∀ i, X i) → ∀ j, NormalSpace (X j) := by sorry
"
Munkres_exercise_33_7,Topology,success,True,3,Show that every locally compact Hausdorff space is completely regular.,"import Mathlib

/-!
Show that every locally compact Hausdorff space is completely regular.
-/-

theorem locally_compact_t2_completely_regular {X : Type*} [TopologicalSpace X] [LocallyCompactSpace X] [T2Space X] : CompletelyRegularSpace X := by sorry
"
Axler_exercise_1_4,Algebra,success,True,3,"Prove that if $a \in \mathbf{F}$, $v \in V$, and $av = 0$, then $a = 0$ or $v = 0$.","import Mathlib

/-- Prove that if a ∈ 𝕜, v ∈ V, and a • v = 0, then a = 0 or v = 0. -/
theorem Axler_exercise_1_4 {𝕜 : Type*} [Field 𝕜] {V : Type*} [AddCommGroup V] [Module 𝕜 V]
  (a : 𝕜) (v : V) : a • v = 0 → a = 0 ∨ v = 0 := by sorry
"
Munkres_exercise_34_9,Topology,success,True,3,"Let $X$ be a compact Hausdorff space that is the union of the closed subspaces $X_1$ and $X_2$. If $X_1$ and $X_2$ are metrizable, show that $X$ is metrizable.","import Mathlib

/-!
Munkres exercise 34.9: Let X be a compact Hausdorff space that is the union of the closed
subspaces X1 and X2. If X1 and X2 are metrizable, then X is metrizable.
-/

theorem Munkres_exercise_34_9
  {X : Type _} [TopologicalSpace X] [CompactSpace X] [T2Space X]
  (X1 X2 : Set X)
  (hX1 : IsClosed (X1 : Set X)) (hX2 : IsClosed (X2 : Set X))
  (hcover : X1 ∪ X2 = (Set.univ : Set X))
  (hmet1 : MetrizableSpace (Subtype X1)) (hmet2 : MetrizableSpace (Subtype X2)) :
  MetrizableSpace X := by sorry
"
Axler_exercise_1_2,Algebra,success,True,3,Show that $\frac{-1 + \sqrt{3}i}{2}$ is a cube root of 1 (meaning that its cube equals 1).,"import Mathlib

open Complex

theorem Axler_exercise_1_2 : (((-1 : ℂ) + ↑(Real.sqrt 3) * I) / 2) ^ 3 = (1 : ℂ) := by sorry
"
Axler_exercise_1_7,Algebra,success,True,3,"Give an example of a nonempty subset $U$ of $\mathbf{R}^2$ such that $U$ is closed under scalar multiplication, but $U$ is not a subspace of $\mathbf{R}^2$.","import Mathlib

/-- Example of a nonempty subset U of R^2 that is closed under scalar multiplication but
    is not a subspace of R^2. -/
theorem Axler_exercise_1_7 : ∃ U : Set (ℝ × ℝ),
  U.Nonempty ∧
  (∀ (a : ℝ) (v : ℝ × ℝ), v ∈ U → a • v ∈ U) ∧
  ∃ u v : ℝ × ℝ, u ∈ U ∧ v ∈ U ∧ u + v ∉ U := by
  sorry
"
Axler_exercise_3_8,Algebra,success,True,2,"Suppose that $V$ is finite dimensional and that $T \in \mathcal{L}(V, W)$. Prove that there exists a subspace $U$ of $V$ such that $U \cap \operatorname{null} T=\{0\}$ and range $T=\{T u: u \in U\}$.","import Mathlib

variables {K : Type _} [Field K] {V W : Type _} [AddCommGroup V] [Module K V] [AddCommGroup W] [Module K W]
  [FiniteDimensional K V]

open LinearMap Submodule

theorem Axler_exercise_3_8 (T : V →ₗ[K] W) :
  ∃ (U : Submodule K V), U ⊓ T.ker = ⊥ ∧ T.range = Submodule.map T U := by sorry
"
Munkres_exercise_43_2,Topology,success,True,3,"Let $(X, d_X)$ and $(Y, d_Y)$ be metric spaces; let $Y$ be complete. Let $A \subset X$. Show that if $f \colon A \rightarrow Y$ is uniformly continuous, then $f$ can be uniquely extended to a continuous function $g \colon \bar{A} \rightarrow Y$, and $g$ is uniformly continuous.","import Mathlib

/-!
Exercise: Let (X, d_X) and (Y, d_Y) be metric spaces; let Y be complete. Let A ⊂ X.
Show that if f : A → Y is uniformly continuous, then f can be uniquely extended to a
continuous function g : closure A → Y, and g is uniformly continuous.
-/

theorem Munkres_exercise_43_2 {X : Type*} [MetricSpace X] {Y : Type*} [MetricSpace Y] [CompleteSpace Y]
  (A : Set X) (f : Subtype A → Y) (hf : UniformContinuous f) :
  ∃! (g : Subtype (closure A) → Y),
    Continuous g ∧ UniformContinuous g ∧
    ∀ a : Subtype A, g ⟨a.1, subset_closure a.2⟩ = f a := by sorry
"
Axler_exercise_1_9,Algebra,success,True,3,Prove that the union of two subspaces of $V$ is a subspace of $V$ if and only if one of the subspaces is contained in the other.,"import Mathlib

variable {K : Type*} {V : Type*} [Field K] [AddCommGroup V] [Module K V]

open Submodule Set

/-- The union of two submodules is a submodule iff one is contained in the other. -/
theorem union_submodule_iff {U W : Submodule K V} :
  (∃ S : Submodule K V, (S : Set V) = (U : Set V) ∪ (W : Set V)) ↔ (U ≤ W) ∨ (W ≤ U) := by sorry
"
Munkres_exercise_28_6,Topology,success,True,3,"Let $(X, d)$ be a metric space. If $f: X \rightarrow X$ satisfies the condition $d(f(x), f(y))=d(x, y)$ for all $x, y \in X$, then $f$ is called an isometry of $X$. Show that if $f$ is an isometry and $X$ is compact, then $f$ is bijective and hence a homeomorphism.","import Mathlib

/-!
# Exercise (Munkres 28.6) — isometries of compact metric spaces

Let (X, d) be a metric space. A map f : X → X with

  dist (f x) (f y) = dist x y

for all x, y ∈ X is called an isometry. Show that if f is an isometry and X is
compact, then f is bijective and hence a homeomorphism.

We state the standard lemmas below. Proofs are omitted (:= by sorry).
-/

variable {X : Type*} [MetricSpace X]

/-- An isometry of a metric space X (into itself). -/
def isometry (f : X → X) : Prop := ∀ x y, dist (f x) (f y) = dist x y

/-- An isometry is injective. -/
theorem isometry.injective {f : X → X} (h : isometry f) : Function.Injective f := by sorry

/-- If X is compact and f is an isometry X → X, then f is surjective. -/
theorem isometry.surjective_of_compact {f : X → X} (h : isometry f) [CompactSpace X] : Function.Surjective f := by sorry

/-- Combining the two previous facts, an isometry of a compact metric space is
bijective and (as it is continuous) a homeomorphism onto X. -/
theorem isometry.bijective_and_continuous_of_compact {f : X → X} (h : isometry f) [CompactSpace X] : Function.Bijective f ∧ Continuous f := by sorry

/- Notes:
  * The injectivity proof is immediate from dist (f x) (f y) = dist x y.
  * The surjectivity uses compactness to rule out a proper isometric embedding
    of X into itself (one standard proof produces an infinite r-separated
    sequence contradicting total boundedness).
  * Since metric spaces are Hausdorff, a continuous bijection from a compact
    space to a Hausdorff space has continuous inverse, hence is a homeomorphism.
-/
"
Axler_exercise_5_11,Algebra,success,True,2,"Suppose $S, T \in \mathcal{L}(V)$. Prove that $S T$ and $T S$ have the same eigenvalues.","import Mathlib

open LinearMap

variable {K : Type*} [Field K]
variable {V : Type*} [AddCommGroup V] [Module K V] [FiniteDimensional K V]

/--
Suppose S, T ∈ L(V). Prove that ST and TS have the same eigenvalues.
We state the equivalence of existence of an eigenvector for ST and for TS.
-/
theorem axler_exercise_5_11 (S T : V →ₗ[K] V) (λ : K) :
  (∃ v : V, v ≠ 0 ∧ (S.comp T) v = λ • v) ↔ (∃ w : V, w ≠ 0 ∧ (T.comp S) w = λ • w) := by
  sorry
"
Axler_exercise_6_3,Algebra,success,True,3,"Prove that $\left(\sum_{j=1}^{n} a_{j} b_{j}\right)^{2} \leq\left(\sum_{j=1}^{n} j a_{j}{ }^{2}\right)\left(\sum_{j=1}^{n} \frac{b_{j}{ }^{2}}{j}\right)$ for all real numbers $a_{1}, \ldots, a_{n}$ and $b_{1}, \ldots, b_{n}$.","import Mathlib
open BigOperators
open Real Nat

/-- Prove that (\sum_{j=1}^{n} a_{j} b_{j})^{2} \leq (\sum_{j=1}^{n} j a_{j}^{2}) (\sum_{j=1}^{n} b_{j}^{2} / j)
for all real numbers a_1,...,a_n and b_1,...,b_n.
We index over `Fin n` and interpret the coefficient j as `j.val + 1`.
-/
theorem Axler_exercise_6_3 {n : ℕ} (a b : Fin n → ℝ) :
  (∑ j, a j * b j) ^ 2 ≤ (∑ j, (j + 1) * a j ^ 2) * (∑ j, b j ^ 2 / (j + 1)) := by sorry
"
Axler_exercise_5_1,Algebra,success,True,3,"Suppose $T \in \mathcal{L}(V)$. Prove that if $U_{1}, \ldots, U_{m}$ are subspaces of $V$ invariant under $T$, then $U_{1}+\cdots+U_{m}$ is invariant under $T$.","import Mathlib

/-!
Exercise (Axler 5.1).
If T : V → V is linear and U₁,…,Uₘ are submodules invariant under T,
then U₁ + ··· + Uₘ is invariant under T.
-/

open BigOperators

variable {R : Type*} {V : Type*}
variable [Semiring R] [AddCommMonoid V] [Module R V]

/-- If each U i is invariant under T (i.e. map T (U i) ≤ U i), then the sum of the U i is invariant. -/
theorem Axler_exercise_5_1 {m : ℕ} (T : V →ₗ[R] V) (U : Fin m → Submodule R V)
  (h : ∀ i : Fin m, (U i).map T ≤ U i) : (Submodule.sum (Finset.univ : Finset (Fin m)) U).map T ≤
    Submodule.sum (Finset.univ : Finset (Fin m)) U := by sorry
"
Axler_exercise_5_13,Algebra,success,True,3,Suppose $T \in \mathcal{L}(V)$ is such that every subspace of $V$ with dimension $\operatorname{dim} V-1$ is invariant under $T$. Prove that $T$ is a scalar multiple of the identity operator.,"import Mathlib

variable {K : Type _} [Field K]
variable {V : Type _} [AddCommGroup V] [Module K V] [FiniteDimensional K V]

/--
Suppose T : V →ₗ[K] V is such that every subspace of V with dimension
`finrank K V - 1` is invariant under T. Then T is a scalar multiple of the identity.
-/
theorem Axler_exercise_5_13 (T : V →ₗ[K] V)
  (h : ∀ (W : Submodule K V), finrank K W = finrank K V - 1 → ∀ w ∈ W, T w ∈ W) :
  ∃ c : K, T = c • LinearMap.id := by sorry
"
Axler_exercise_5_24,Algebra,success,True,3,Suppose $V$ is a real vector space and $T \in \mathcal{L}(V)$ has no eigenvalues. Prove that every subspace of $V$ invariant under $T$ has even dimension.,"import Mathlib

/-!
# Axler Exercise 5.24

Suppose V is a finite-dimensional real vector space and T : V →ₗ[ℝ] V has no real eigenvalues.
Show that every subspace W ≤ V which is invariant under T has even dimension.
-/

open LinearMap Submodule

theorem Axler_exercise_5_24 {V : Type _} [AddCommGroup V] [Module ℝ V] [FiniteDimensional ℝ V]
  (T : V →ₗ[ℝ] V)
  (h_no_eig : ∀ λ : ℝ, (T - λ • LinearMap.id).ker = ⊥) :
  ∀ W : Submodule ℝ V, Submodule.map T W ≤ W → ∃ k : ℕ, finrank ℝ W = 2 * k := by sorry
"
Axler_exercise_7_11,Algebra,success,True,3,Suppose $V$ is a complex inner-product space. Prove that every normal operator on $V$ has a square root. (An operator $S \in \mathcal{L}(V)$ is called a square root of $T \in \mathcal{L}(V)$ if $S^{2}=T$.),"import Mathlib

/-!
# Axler Exercise 7.11

Suppose V is a complex inner-product space. Every normal operator on V has a square root.
-/

theorem Axler_exercise_7_11 {V : Type _} [InnerProductSpace ℂ V] [FiniteDimensional ℂ V]
  (T : V →ₗ[ℂ] V) (h : IsNormal T) :
  ∃ S : V →ₗ[ℂ] V, S.comp S = T := by sorry
"
Axler_exercise_6_13,Algebra,success,True,3,"Suppose $\left(e_{1}, \ldots, e_{m}\right)$ is an or thonormal list of vectors in $V$. Let $v \in V$. Prove that $\|v\|^{2}=\left|\left\langle v, e_{1}\right\rangle\right|^{2}+\cdots+\left|\left\langle v, e_{m}\right\rangle\right|^{2}$ if and only if $v \in \operatorname{span}\left(e_{1}, \ldots, e_{m}\right)$.","import Mathlib

variable {𝕜 : Type*} [IsROrC 𝕜]
variable {V : Type*} [InnerProductSpace 𝕜 V]

theorem Axler_exercise_6_13 {m : ℕ} (e : Fin m → V) (he : Orthonormal 𝕜 e) (v : V) :
  ‖v‖ ^ 2 = ∑ i : Fin m, ‖⟪v, e i⟫‖ ^ 2 ↔ v ∈ Submodule.span 𝕜 (Set.range e) := by sorry"
Ireland-Rosen_exercise_1_30,Number Theory,success,True,3,Prove that $\frac{1}{2}+\frac{1}{3}+\cdots+\frac{1}{n}$ is not an integer.,"import Mathlib

open BigOperators

/-- Exercise 1.30 (Ireland & Rosen): The harmonic sum 1/2 + 1/3 + ... + 1/n is never an integer for n ≥ 2. -/
theorem ireland_rosen_exercise_1_30 (n : ℕ) (hn : 2 ≤ n) : ¬ ∃ m : ℤ, (∑ k in Finset.Ico 2 (n+1), (1 : ℚ) / k) = (m : ℚ) := by sorry
"
Ireland-Rosen_exercise_2_4,Number Theory,success,True,3,"If $a$ is a nonzero integer, then for $n>m$ show that $\left(a^{2^{n}}+1, a^{2^{m}}+1\right)=1$ or 2 depending on whether $a$ is odd or even.","import Mathlib

/-!
Exercise (Ireland–Rosen 2.4).
If a is a nonzero integer, then for n > m show that
gcd(a^{2^n}+1, a^{2^m}+1) = 1 or 2 depending on whether a is odd or even.
-/

theorem Ireland_Rosen_exercise_2_4 (a : Int) (ha : a ≠ 0) :
  ∀ {n m : Nat}, n > m → Int.gcd (a ^ (2 ^ n) + 1) (a ^ (2 ^ m) + 1) =
    (if a % 2 = 0 then 2 else 1) := by sorry
"
Axler_exercise_7_9,Algebra,success,True,3,Prove that a normal operator on a complex inner-product space is self-adjoint if and only if all its eigenvalues are real.,"import Mathlib

open Matrix Complex

variable {n : Type _} [Fintype n] [DecidableEq n]

/--
A normal matrix (operator) on a complex finite-dimensional inner product space is
self-adjoint (Hermitian) iff all its eigenvalues are real.  This is a Lean translation
of Axler, Exercise 7.9.  (Proof omitted.)
-/
theorem normal_operator_is_selfadjoint_iff_eigenvalues_real (A : Matrix n n ℂ)
  (h_normal : A * A.conjTranspose = A.conjTranspose * A) :
  (A = A.conjTranspose) ↔
    ∀ μ : ℂ, (∃ v : n → ℂ, v ≠ 0 ∧ A.mulVec v = μ • v) → μ.im = 0 := by sorry
"
Axler_exercise_7_5,Algebra,success,True,3,"Show that if $\operatorname{dim} V \geq 2$, then the set of normal operators on $V$ is not a subspace of $\mathcal{L}(V)$.","import Mathlib

variable {𝕜 : Type*} [IsROrC 𝕜]
variable {V : Type*} [InnerProductSpace 𝕜 V] [FiniteDimensional 𝕜 V]

/--
If dim V ≥ 2, then the set of normal operators on V is not a subspace of End(V).
This file states the result; the proof is omitted.
-/
theorem Axler_exercise_7_5 (h : 2 ≤ finrank 𝕜 V) :
  ¬ ( { T : V →ₗ[𝕜] V | IsNormal T } : Set (V →ₗ[𝕜] V) ).IsSubmodule := by sorry
"
Ireland-Rosen_exercise_3_4,Number Theory,success,True,3,Show that the equation $3 x^{2}+2=y^{2}$ has no solution in integers.,"import Mathlib

/-- Exercise (Ireland & Rosen, 3.4): Show that the equation
    3*x^2 + 2 = y^2
has no solution in integers. -/
theorem no_int_solutions : ¬ ∃ x y : Int, 3 * x ^ 2 + 2 = y ^ 2 := by sorry
"
Ireland-Rosen_exercise_3_10,Number Theory,success,True,3,"If $n$ is not a prime, show that $(n-1) ! \equiv 0(n)$, except when $n=4$.","import Mathlib

/-- Exercise 3.10 (Ireland & Rosen). If n is composite, then (n - 1)! ≡ 0 (mod n), except when n = 4. -/
theorem ireland_rosen_exercise_3_10 (n : ℕ) (hn1 : 2 ≤ n) (hn2 : ¬Nat.Prime n) (hn3 : n ≠ 4) :
  (Nat.factorial (n - 1) : ZMod n) = 0 := by sorry
"
Ireland-Rosen_exercise_4_6,Number Theory,success,True,2,"If $p=2^{n}+1$ is a Fermat prime, show that 3 is a primitive root modulo $p$.","import Mathlib

/--
If p = 2^(2^k) + 1 is a Fermat prime, then 3 is a primitive root modulo p.
That is, the multiplicative order of 3 modulo p is p - 1 = 2^(2^k).
-/
theorem Ireland_Rosen_exercise_4_6 {k : ℕ} (hp : Prime (2 ^ (2 ^ k) + 1)) :
  orderOf (3 : ZMod (2 ^ (2 ^ k) + 1)) = 2 ^ (2 ^ k) := by sorry
"
Ireland-Rosen_exercise_5_28,Number Theory,success,True,3,Show that $x^{4} \equiv 2(p)$ has a solution for $p \equiv 1(4)$ iff $p$ is of the form $A^{2}+64 B^{2}$.,"import Mathlib

/-- Let p be an odd prime. Then x^4 ≡ 2 (mod p) has a solution for p ≡ 1 (mod 4)
    iff p can be written as p = A^2 + 64 B^2 for some integers A, B. -/
theorem Ireland_Rosen_exercise_5_28 {p : ℕ} (hp : Nat.Prime p) (hmod4 : p % 4 = 1) :
  (∃ x : ZMod p, x ^ 4 = (2 : ZMod p)) ↔ ∃ A B : ℤ, (p : ℤ) = A ^ 2 + 64 * B ^ 2 := by sorry
"
Ireland-Rosen_exercise_4_11,Number Theory,success,True,3,Prove that $1^{k}+2^{k}+\cdots+(p-1)^{k} \equiv 0(p)$ if $p-1 \nmid k$ and $-1(p)$ if $p-1 \mid k$.,"import Mathlib

open BigOperators

/--
Ireland & Rosen, Exercise 4.11:
For a prime p and k : ℕ, the sum of k-th powers of the nonzero residues modulo p
satisfies

  ∑_{a=1}^{p-1} a^k ≡ 0 (mod p)    if (p-1) ∤ k,
  ∑_{a=1}^{p-1} a^k ≡ -1 (mod p)   if (p-1) ∣ k.

This file only states the theorem; the proof is omitted (``:= by sorry'').
-/

theorem ireland_rosen_exercise_4_11 (p k : ℕ) (hp : p.Prime) :
  (if (p - 1) ∣ k
   then ∑ a in (Finset.range p).erase 0, ((a : ZMod p) ^ k) = (-1 : ZMod p)
   else ∑ a in (Finset.range p).erase 0, ((a : ZMod p) ^ k) = 0) := by
  sorry
"
Ireland-Rosen_exercise_2_27a,Number Theory,success,True,3,"Show that $\sum^{\prime} 1 / n$, the sum being over square free integers, diverges.","import Mathlib

/-!
Exercise 2.27(a), Ireland–Rosen.
Show that \sum'_{n squarefree} 1 / n diverges.
This file states the theorem (no proof).
-/

/-- A natural number n is squarefree if no integer d ≥ 2 has d^2 dividing n. -/
def squarefree (n : ℕ) : Prop := ¬ ∃ d : ℕ, 2 ≤ d ∧ d * d ∣ n

/-- The series of reciprocals of squarefree positive integers is not summable (diverges). -/
theorem sum_over_squarefree_not_summable :
  ¬ Summable (fun n : ℕ => if n ≠ 0 ∧ squarefree n then (1 : ℝ) / (n : ℝ) else 0) := by sorry
"
Ireland-Rosen_exercise_4_4,Number Theory,success,True,3,Consider a prime $p$ of the form $4 t+1$. Show that $a$ is a primitive root modulo $p$ iff $-a$ is a primitive root modulo $p$.,"import Mathlib

theorem Ireland_Rosen_exercise_4_4 (p : ℕ) (hp : Nat.Prime p) (h4 : p % 4 = 1) (a : ZMod p) (ha : a ≠ 0) :
  (∀ d : ℕ, 0 < d → d < p - 1 → a ^ d ≠ 1) ↔ (∀ d : ℕ, 0 < d → d < p - 1 → (-a) ^ d ≠ 1) := by
  sorry
"
Ireland-Rosen_exercise_12_12,Number Theory,success,True,3,Show that $\sin (\pi / 12)$ is an algebraic number.,"import Mathlib

/-
  Exercise: Show that sin(pi/12) is algebraic.
  We state the existence of a nonzero rational polynomial vanishing at sin(pi/12).
-/

theorem sin_pi_div_12_is_algebraic : ∃ p : Polynomial ℚ, p ≠ 0 ∧ p.eval (Real.sin (Real.pi / 12)) = 0 := by sorry
"
Shakarchi_exercise_1_13b,Analysis,success,True,3,"Suppose that $f$ is holomorphic in an open set $\Omega$. Prove that if $\text{Im}(f)$ is constant, then $f$ is constant.","import Mathlib

open Complex

/-- Suppose that f is holomorphic in an open connected set Ω. If Im(f) is constant on Ω, then f is constant on Ω. -/
theorem shakarchi_exercise_1_13b {Ω : Set ℂ} (hΩ : IsOpen Ω) (hconn : IsConnected Ω) {f : ℂ → ℂ}
  (hf : IsHolomorphicOn f Ω) (c : ℝ) (h : ∀ z ∈ Ω, (f z).im = c) : ∃ w : ℂ, ∀ z ∈ Ω, f z = w := by sorry
"
Shakarchi_exercise_1_19a,Analysis,success,True,3,Prove that the power series $\sum nz^n$ does not converge on any point of the unit circle.,"import Mathlib

/-!
Exercise: Prove that the power series ∑ n z^n does not converge for any complex number z with |z| = 1.
We state the result; the proof is omitted (sorry).
-/-

theorem Shakarchi_exercise_1_19a (z : ℂ) (hz : |z| = 1) : ¬ Summable (fun n : ℕ => (n : ℂ) * z ^ n) := by sorry
"
Shakarchi_exercise_1_19c,Analysis,success,True,3,Prove that the power series $\sum zn/n$ converges at every point of the unit circle except $z = 1$.,"import Mathlib

open Complex

/-- Exercise 1.19(c) (Shakarchi): The power series ∑ z^n / n converges for every z on the unit circle
    except z = 1. -/
theorem Shakarchi_exercise_1_19c (z : ℂ) (hz : |z| = 1) (hz_ne : z ≠ 1) : Summable fun n : ℕ => z ^ n / (n : ℂ) := by sorry
"
Shakarchi_exercise_2_2,Analysis,success,True,3,Show that $\int_{0}^{\infty} \frac{\sin x}{x} d x=\frac{\pi}{2}$.,"import Mathlib

open Filter
open IntervalIntegral
open Real
open Topology

open scoped Real

/-- Show that ∫_{0}^{∞} sin x / x dx = π / 2. We state this as the improper integral
    given by the limit of integrals on [0, R] as R → ∞. -/
theorem integral_sin_div_id_tendsto :
  Tendsto (fun R : ℝ => ∫ x in 0..R, (sin x) / x) atTop (𝓝 (π / 2)) := by sorry
"
Shakarchi_exercise_3_14,Analysis,success,True,3,"Prove that all entire functions that are also injective take the form $f(z) = az + b$, $a, b \in \mathbb{C}$ and $a \neq 0$.","import Mathlib

/-- Prove that all entire functions that are also injective take the form f(z) = az + b, a, b ∈ C and a ≠ 0. -/
theorem Liouville_theorem_of_injective_of_entire (f : ℂ → ℂ) (hf_inj: Injective f) (hf_ent : Continuous f) : ∃ a b : ℂ, a ≠ 0 ∧ f = fun z => a * z + b := by sorry
"
Shakarchi_exercise_3_4,Analysis,success,True,3,Show that $ \int_{-\infty}^{\infty} \frac{x \sin x}{x^2 + a^2} dx = \pi e^{-a}$ for $a > 0$.,"import Mathlib

open MeasureTheory
open Real

lemma Shakarchi_exercise_3_4 (a : ℝ) (ha : 0 < a) :
  ∫ x : ℝ, (x * sin x) / (x ^ 2 + a ^ 2) = π * exp (-a) := by sorry
"
Shakarchi_exercise_2_13,Analysis,success,True,3,Suppose $f$ is an analytic function defined everywhere in $\mathbb{C}$ and such that for each $z_0 \in \mathbb{C}$ at least one coefficient in the expansion $f(z) = \sum_{n=0}^\infty c_n(z - z_0)^n$ is equal to 0. Prove that $f$ is a polynomial.,"import Mathlib

/--
Suppose f : ℂ → ℂ is analytic everywhere, and for each z0 ∈ ℂ the Taylor expansion
f(z) = ∑_{n=0}^∞ c_n (z - z0)^n has at least one coefficient equal to 0.
Then f is a polynomial (i.e. there exists a polynomial p with f = p.eval).

This statement is encoded here in a form that does not commit to a particular
analyticity API: we assume for each center z0 there exists a sequence of
coefficients c (depending on z0) whose (absolutely) summable power series
reconstructs f on all of ℂ, and that for each such sequence at least one
coefficient vanishes.
-/

open Complex

theorem Shakarchi_exercise_2_13 (f : ℂ → ℂ)
  (h_taylor : ∀ z0 : ℂ, ∃ (c : ℕ → ℂ), (∀ z : ℂ, f z = ∑' (n : ℕ), c n * (z - z0) ^ n) ∧ (∃ n, c n = 0)) :
  ∃ p : Polynomial ℂ, ∀ z : ℂ, f z = p.eval z := by sorry
"
Shakarchi_exercise_5_1,Analysis,success,True,3,"Prove that if $f$ is holomorphic in the unit disc, bounded and not identically zero, and $z_{1}, z_{2}, \ldots, z_{n}, \ldots$ are its zeros $\left(\left|z_{k}\right|<1\right)$, then $\sum_{n}\left(1-\left|z_{n}\right|\right)<\infty$.","import Mathlib

/-!
Exercise: Prove that if f is holomorphic in the unit disc, bounded and not identically zero,
and z₁, z₂, … are its zeros (|z_k| < 1), then ∑ₙ (1 - |z_n|) < ∞.

This file translates the statement to Lean. The proof is omitted (ending with `by sorry`).
-/

open Complex

theorem Shakarchi_exercise_5_1 {f : ℂ → ℂ} {a : ℕ → ℂ}
  (hf : IsHolomorphicOn f (ball (0 : ℂ) 1))
  (hb : ∃ M, ∀ z ∈ ball (0 : ℂ) 1, |f z| ≤ M)
  (hne : ¬(∀ z ∈ ball (0 : ℂ) 1, f z = 0))
  (hz : ∀ n, a n ∈ ball (0 : ℂ) 1)
  (hroot : ∀ n, f (a n) = 0)
  (hcomplete : ∀ z, z ∈ ball (0 : ℂ) 1 → f z = 0 → ∃ n, a n = z) :
  Summable (fun n => 1 - |a n|) := by sorry
"
Putnam_exercise_2018_b4,Olympiad,success,True,2,"Given a real number $a$, we define a sequence by $x_{0}=1$, $x_{1}=x_{2}=a$, and $x_{n+1}=2 x_{n} x_{n-1}-x_{n-2}$ for $n \geq 2$. Prove that if $x_{n}=0$ for some $n$, then the sequence is periodic.","import Mathlib

/-
  Putnam 2018 B4 (translation):
  Given a real number a, define a sequence x : ℕ → ℝ by
    x 0 = 1, x 1 = x 2 = a,
    x (n+1) = 2 * x n * x (n-1) - x (n-2) for n ≥ 2.
  If x n = 0 for some n, then the sequence is periodic.
-/

theorem putnam_exercise_2018_b4 {a : ℝ} {x : ℕ → ℝ}
  (h0 : x 0 = 1) (h1 : x 1 = a) (h2 : x 2 = a)
  (hrec : ∀ n, n ≥ 2 → x (n+1) = 2 * x n * x (n-1) - x (n-2)) :
  (∃ n, x n = 0) → ∃ p : ℕ, p > 0 ∧ ∀ m, x (m + p) = x m := by sorry
"
Putnam_exercise_2018_a5,Olympiad,success,True,3,"Let $f: \mathbb{R} \rightarrow \mathbb{R}$ be an infinitely differentiable function satisfying $f(0)=0, f(1)=1$, and $f(x) \geq 0$ for all $x \in$ $\mathbb{R}$. Show that there exist a positive integer $n$ and a real number $x$ such that $f^{(n)}(x)<0$.","import Mathlib

/-
Putnam 2018 A5 (translation):
Let f : ℝ → ℝ be an infinitely differentiable function satisfying f(0)=0, f(1)=1,
and f(x) ≥ 0 for all x ∈ ℝ. Show that there exist a positive integer n and a real
number x such that the n-th derivative of f at x is negative.
-/

theorem Putnam_exercise_2018_a5 (f : ℝ → ℝ)
  (h_smooth : ContDiff ℝ ⊤ f)
  (h0 : f 0 = 0)
  (h1 : f 1 = 1)
  (h_nonneg : ∀ x, 0 ≤ f x) :
  ∃ n : ℕ, ∃ x : ℝ, n > 0 ∧ (Function.iterate deriv n f) x < 0 := by sorry
"
Putnam_exercise_1998_b6,Olympiad,success,True,3,"Prove that, for any integers $a, b, c$, there exists a positive integer $n$ such that $\sqrt{n^3+a n^2+b n+c}$ is not an integer.","import Mathlib

/-- For any integers a, b, c, there exists a positive integer n such that
    sqrt(n^3 + a*n^2 + b*n + c) is not an integer. -/
theorem exists_n_not_perfect_square (a b c : Int) :
  ∃ n : Nat, 0 < n ∧ Int.sqrt (n^3 + a * n^2 + b * n + c) ^ 2 ≠ n^3 + a * n^2 + b * n + c := by sorry
"
Putnam_exercise_1999_b4,Olympiad,success,True,2,"Let $f$ be a real function with a continuous third derivative such that $f(x), f^{\prime}(x), f^{\prime \prime}(x), f^{\prime \prime \prime}(x)$ are positive for all $x$. Suppose that $f^{\prime \prime \prime}(x) \leq f(x)$ for all $x$. Show that $f^{\prime}(x)<2 f(x)$ for all $x$.","import Mathlib

/-!
Putnam 1999 B4: If f : ℝ → ℝ has continuous third derivative and f, f', f'', f''' > 0 and f''' ≤ f, show f' < 2 f.
-/

open Real

theorem Putnam_exercise_1999_b4 (f : ℝ → ℝ) (hf : ContDiff ℝ 3 f)
  (h_pos : ∀ x, 0 < f x)
  (h_f' : ∀ x, 0 < deriv f x)
  (h_f'' : ∀ x, 0 < deriv (deriv f) x)
  (h_f''' : ∀ x, 0 < deriv (deriv (deriv f)) x)
  (h_bound : ∀ x, deriv (deriv (deriv f)) x ≤ f x) :
  ∀ x, deriv f x < 2 * f x := by sorry
"
Putnam_exercise_2001_a5,Olympiad,success,True,3,"Prove that there are unique positive integers $a, n$ such that $a^{n+1}-(a+1)^n=2001$.","import Mathlib

/-- Putnam 2001 A5 translation: There are unique positive integers `a, n` such that
    a^(n+1) - (a+1)^n = 2001. -/
theorem putnam_exercise_2001_a5 : ∃! (a n : ℕ), a > 0 ∧ n > 0 ∧ ((a ^ (n + 1) : Int) - ((a + 1) ^ n : Int) = (2001 : Int)) := by
  sorry
"
Pugh_exercise_2_32a,Analysis,success,True,3,Show that every subset of $\mathbb{N}$ is clopen.,"import Mathlib
open Topology TopologicalSpace Filter Encodable Set
open scoped Uniformity
open Function TopologicalSpace Set

/-- Show that every subset of $\mathbb{N}$ is clopen. -/
theorem isClopen_of_subset_nat {s : Set ℕ} : IsClopen s := by sorry
"
Pugh_exercise_2_26,Analysis,success,True,3,Prove that a set $U \subset M$ is open if and only if none of its points are limits of its complement.,"import Mathlib

/-!
Exercise (Pugh 2.26).
Prove that a set U ⊆ M is open iff none of its points are limits of its complement.
-/-

variable {M : Type _} [TopologicalSpace M]

theorem Pugh_exercise_2_26 (U : Set M) : IsOpen U ↔ ∀ x ∈ U, x ∉ closure (M \ U) := by sorry
"
Pugh_exercise_3_1,Analysis,success,True,3,"Assume that $f \colon \mathbb{R} \rightarrow \mathbb{R}$ satisfies $|f(t)-f(x)| \leq|t-x|^{2}$ for all $t, x$. Prove that $f$ is constant.","import Mathlib

/-
Exercise (Pugh 3.1).
Assume that f : ℝ → ℝ satisfies |f(t) - f(x)| ≤ |t - x|^2 for all t, x. Prove that f is constant.
-/

theorem Pugh_exercise_3_1 (f : ℝ → ℝ)
  (h : ∀ t x : ℝ, abs (f t - f x) ≤ abs (t - x) ^ 2) :
  ∃ c : ℝ, ∀ x : ℝ, f x = c := by sorry
"
Pugh_exercise_2_92,Analysis,success,True,3,Give a direct proof that the nested decreasing intersection of nonempty covering compact sets is nonempty.,"import Mathlib

/-!
# Exercise 2.92 (Pugh)

Give a direct proof that the nested decreasing intersection of nonempty covering compact sets is nonempty.
-/

open Set

variable {α : Type*} [TopologicalSpace α]

/-- If K : ℕ → Set α is a sequence of nonempty compact sets with K (n+1) ⊆ K n,
then their intersection is nonempty. -/
theorem Pugh_exercise_2_92 {K : ℕ → Set α}
  (hK_compact : ∀ n, IsCompact (K n))
  (hK_nonempty : ∀ n, (K n).Nonempty)
  (hK_decr : ∀ n, K (n + 1) ⊆ K n) :
  (⋂ n, K n).Nonempty := by sorry
"
Pugh_exercise_2_46,Analysis,success,True,3,"Assume that $A, B$ are compact, disjoint, nonempty subsets of $M$. Prove that there are $a_0 \in A$ and $b_0 \in B$ such that for all $a \in A$ and $b \in B$ we have $d(a_0, b_0) \leq d(a, b)$.","import Mathlib

variable {M : Type*} [MetricSpace M]

theorem Pugh_exercise_2_46 (A B : Set M) (hA : IsCompact A) (hB : IsCompact B)
  (hAne : ∃ a, a ∈ A) (hBne : ∃ b, b ∈ B) (hdisj : Disjoint A B) :
  ∃ a0 b0, a0 ∈ A ∧ b0 ∈ B ∧ ∀ a ∈ A, ∀ b ∈ B, dist a0 b0 ≤ dist a b := by
  sorry
"
Herstein_exercise_2_1_18,Algebra,success,True,2,"If $G$ is a finite group of even order, show that there must be an element $a \neq e$ such that $a=a^{-1}$.","import Mathlib

/--
If G is a finite group of even order, show that there must be an element a ≠ 1 such that a = a⁻¹.
This is the Lean translation (statement only) of Herstein exercise 2.1.18.
-/

theorem exists_involution_of_even_finite_group {G : Type _} [Group G] [Fintype G]
  (h : 2 ∣ Fintype.card G) :
  ∃ a : G, a ≠ 1 ∧ a = a⁻¹ := by sorry
"
Pugh_exercise_3_63a,Analysis,success,True,3,Prove that $\sum 1/k(\log(k))^p$ converges when $p > 1$.,"import Mathlib

/-!
Exercise (Pugh 3.63a).
Show that the series ∑_{k≥2} 1 / (k (log k)^p) converges when p > 1.
We state the result for the sequence k ↦ 1 / ((k+2) * (log (k+2))^p) to avoid the singularities at k = 0,1.
-/

theorem pugh_exercise_3_63a (p : ℝ) (hp : 1 < p) :
  Summable (fun k : ℕ => 1 / ((k + 2 : ℝ) * (Real.log (k + 2 : ℝ)) ^ p)) := by sorry
"
Herstein_exercise_2_1_26,Algebra,success,True,3,"If $G$ is a finite group, prove that, given $a \in G$, there is a positive integer $n$, depending on $a$, such that $a^n = e$.","import Mathlib

/-- Herstein, Exercise 2.1.26:
If G is a finite group, then for each a : G there exists n > 0 with a^n = 1. -/
theorem Herstein_exercise_2_1_26 {G : Type _} [Group G] [Fintype G] (a : G) : ∃ n : ℕ, 0 < n ∧ a ^ n = 1 := by sorry
"
Pugh_exercise_4_15a,Analysis,success,True,3,"A continuous, strictly increasing function $\mu \colon (0, \infty) \rightarrow (0, \infty)$ is a modulus of continuity if $\mu(s) \rightarrow 0$ as $s \rightarrow 0$. A function $f \colon [a, b] \rightarrow \mathbb{R}$ has modulus of continuity $\mu$ if $|f(s) - f(t)| \leq \mu(|s - t|)$ for all $s, t \in [a, b]$. Prove that a function is uniformly continuous if and only if it has a modulus of continuity.","import Mathlib

open Set Filter

/-- A modulus of continuity μ : ℝ → ℝ is positive on (0,∞), strictly increasing on (0,∞),
    continuous on (0,∞), and tends to 0 as s → 0^+. -/
def is_modulus_of_continuity (μ : ℝ → ℝ) : Prop :=
  (∀ s, 0 < s → 0 < μ s) ∧ StrictMonoOn μ (Ioi (0 : ℝ)) ∧ ContinuousOn μ (Ioi (0 : ℝ)) ∧
    Tendsto μ (nhdsWithin (0 : ℝ) (Ioi (0 : ℝ))) (𝓝 (0 : ℝ))

/-- f has modulus of continuity μ on [a,b] if for all s,t in [a,b],
    |f s - f t| ≤ μ (|s - t|). -/
def has_modulus_on (μ f : ℝ → ℝ) (a b : ℝ) : Prop :=
  ∀ s t, s ∈ Icc a b → t ∈ Icc a b → |f s - f t| ≤ μ (|s - t|)

/-- A function on a closed interval [a,b] is uniformly continuous iff there exists
    a modulus of continuity μ such that f has modulus μ on [a,b]. -/
theorem uniform_continuous_on_iff_exists_modulus (f : ℝ → ℝ) {a b : ℝ} (h : a ≤ b) :
  UniformContinuousOn f (Icc a b) ↔ ∃ μ : ℝ → ℝ, is_modulus_of_continuity μ ∧ has_modulus_on μ f a b := by sorry
"
Herstein_exercise_2_2_6c,Algebra,success,True,3,"Let $G$ be a group in which $(a b)^{n}=a^{n} b^{n}$ for some fixed integer $n>1$ for all $a, b \in G$. For all $a, b \in G$, prove that $\left(a b a^{-1} b^{-1}\right)^{n(n-1)}=e$.","import Mathlib

/-!
Exercise: Let G be a group in which (a b)^n = a^n b^n for some fixed integer n > 1 for all a, b in G.
Prove that for all a, b in G, (a b a^{-1} b^{-1})^{n(n-1)} = e.
-/

theorem herstein_exercise_2_2_6c {G : Type*} [Group G] {n : ℕ}
  (hn : 1 < n)
  (h : ∀ a b : G, (a * b) ^ n = a ^ n * b ^ n) :
  ∀ a b : G, (a * b * a⁻¹ * b⁻¹) ^ (n * (n - 1)) = 1 := by sorry
"
Herstein_exercise_2_2_3,Algebra,success,True,4,"If $G$ is a group in which $(a b)^{i}=a^{i} b^{i}$ for three consecutive integers $i$, prove that $G$ is abelian.","import Mathlib

/-!
Herstein, Exercise 2.2.3.
If G is a group in which (ab)^i = a^i b^i for three consecutive integers i,
then G is abelian.
-/

theorem Herstein_exercise_2_2_3 {G : Type*} [Group G] :
  (∃ k : Int, ∀ a b : G,
    (a * b) ^ k = a ^ k * b ^ k ∧
    (a * b) ^ (k + 1) = a ^ (k + 1) * b ^ (k + 1) ∧
    (a * b) ^ (k + 2) = a ^ (k + 2) * b ^ (k + 2)) →
  ∀ a b : G, a * b = b * a := by sorry
"
Herstein_exercise_2_3_16,Algebra,success,True,3,"If a group $G$ has no proper subgroups, prove that $G$ is cyclic of order $p$, where $p$ is a prime number.","import Mathlib

/--
If a finite nontrivial group G has no proper subgroups (every subgroup is trivial or whole),
then G is cyclic of prime order.
-/
theorem Herstein_exercise_2_3_16 {G : Type*} [Group G] [Fintype G] (h_nontriv : Nontrivial G)
  (h_subs : ∀ H : Subgroup G, H = (⊤ : Subgroup G) ∨ H = (⊥ : Subgroup G)) :
  ∃ (p : ℕ) (hp : Nat.Prime p),
    Fintype.card G = p ∧ ∃ g : G, Subgroup.closure ({g} : Set G) = (⊤ : Subgroup G) := by sorry
"
Herstein_exercise_2_5_23,Algebra,success,True,3,"Let $G$ be a group such that all subgroups of $G$ are normal in $G$. If $a, b \in G$, prove that $ba = a^jb$ for some $j$.","import Mathlib

/-- Let G be a group such that all subgroups of G are normal in G. If a, b ∈ G, then
    ba = a^j b for some integer j. -/
theorem Herstein_exercise_2_5_23 {G : Type*} [Group G] (h : ∀ H : Subgroup G, H.Normal) (a b : G) :
  ∃ j : Int, b * a = a ^ j * b := by sorry
"
Putnam_exercise_2014_a5,Olympiad,success,True,20,Let,"import Mathlib

/-
  Putnam 2014 A5
  ----------------
  The original problem statement was not provided by the user; this file contains a
  placeholder theorem. Replace the statement below with the full translated
  statement when available.
-/

theorem Putnam_exercise_2014_a5 : True := by sorry
"
Herstein_exercise_2_5_43,Algebra,success,True,3,Prove that a group of order 9 must be abelian.,"import Mathlib

/--
Herstein, Exercise 2.5.43: A group of order 9 is abelian.
We state the result and leave the proof as `by sorry`.
-/
theorem Herstein_exercise_2_5_43 (G : Type _) [Group G] [Fintype G] (h : Fintype.card G = 9) :
  ∀ a b : G, a * b = b * a := by sorry
"
Herstein_exercise_2_5_31,Algebra,success,True,3,"Suppose that $G$ is an abelian group of order $p^nm$ where $p \nmid m$ is a prime.  If $H$ is a subgroup of $G$ of order $p^n$, prove that $H$ is a characteristic subgroup of $G$.","import Mathlib

/-!
Suppose that G is an abelian group of order p^n * m where p ∤ m is a prime.
If H is a subgroup of G of order p^n, prove that H is a characteristic subgroup of G.

We state the result below. A full proof is omitted (use := by sorry) as requested.
-/

theorem Herstein_exercise_2_5_31 {G : Type*} [Group G] [Fintype G] {p n m : ℕ} [Fact (Nat.Prime p)]
  (H : Subgroup G)
  (hG : Fintype.card G = p ^ n * m)
  (hm : ¬ p ∣ m)
  (hH : Fintype.card H = p ^ n) :
  -- H is characteristic: it is fixed by every automorphism of G
  ∀ (φ : G ≃* G), φ.toEquiv '' (H : Set G) = (H : Set G) := by sorry
"
Herstein_exercise_2_7_7,Algebra,success,True,3,"If $\varphi$ is a homomorphism of $G$ onto $G'$ and $N \triangleleft G$, show that $\varphi(N) \triangleleft G'$.","import Mathlib

/-- If φ : G →* G' is a surjective group homomorphism and N ⊲ G is a normal subgroup,
then the image N.map φ is a normal subgroup of G'. -/
theorem map_isNormal_of_surjective {G G' : Type _} [Group G] [Group G'] (φ : G →* G')
  (N : Subgroup G) (hφ : Function.Surjective (φ : G → G)) (hN : IsNormal N) :
  IsNormal (N.map φ) := by
  sorry
"
Herstein_exercise_2_5_52,Algebra,success,True,3,"Let $G$ be a finite group and $\varphi$ an automorphism of $G$ such that $\varphi(x) = x^{-1}$ for more than three-fourths of the elements of $G$. Prove that $\varphi(y) = y^{-1}$ for all $y \in G$, and so $G$ is abelian.","import Mathlib

variable {G : Type*} [Group G] [Fintype G]
variable (φ : G ≃* G)

/-- Herstein exercise: If an automorphism φ of a finite group G satisfies φ(x) = x⁻¹ for more than
    three-fourths of the elements of G, then φ(y) = y⁻¹ for all y ∈ G, and hence G is abelian. -/
theorem herstein_exercise_2_5_52
  (h : 4 * (Fintype.card {x : G // φ x = x⁻¹}) > 3 * Fintype.card G) :
  (∀ y : G, φ y = y⁻¹) ∧ (∀ a b : G, a * b = b * a) := by sorry
"
Herstein_exercise_2_10_1,Algebra,success,True,3,"Let $A$ be a normal subgroup of a group $G$, and suppose that $b \in G$ is an element of prime order $p$, and that $b \not\in A$. Show that $A \cap (b) = (e)$.","import Mathlib


/-- Let A be a normal subgroup of a group G, and suppose that b ∈ G is an element of prime order p, and that b ∉ A. Show that A ∩ (b) = (e). -/
theorem Herstein_exercise_2_10_1 {G : Type*} [Group G] (A : Subgroup G) [A.Normal] {b : G} (p : ℕ) (hp : Nat.Prime p) (hb : b ^ p = 1) (hb' : ∀ m : ℕ, 0 < m → m < p → b ^ m ≠ 1) (hb'' : b ∉ A) : A ⊓ Subgroup.closure ({b} : Set G) = ⊥ := by sorry
"
Herstein_exercise_2_8_15,Algebra,success,True,3,"Prove that if $p > q$ are two primes such that $q \mid p - 1$, then any two nonabelian groups of order $pq$ are isomorphic.","import Mathlib

/--
Herstein, Exercise 2.8.15 (statement only).
If p > q are primes with q ∣ (p - 1), then any two nonabelian groups of order p*q are isomorphic.
We state this in Lean: for any two finite groups G and H of order p*q which are nonabelian,
there exists a multiplicative equivalence (group isomorphism) between them.
-/
theorem herstein_exercise_2_8_15 (p q : ℕ) (hp : Nat.Prime p) (hq : Nat.Prime q)
  (hq_div : q ∣ (p - 1)) (hpgt : p > q) :
  ∀ (G H : Type*) [Group G] [Fintype G] [Group H] [Fintype H],
    Fintype.card G = p * q → Fintype.card H = p * q →
    (¬∀ a b : G, a * b = b * a) → (¬∀ a b : H, a * b = b * a) →
    Nonempty (G ≃* H) := by sorry
"
Herstein_exercise_4_2_6,Algebra,success,True,2,"If $a^2 = 0$ in $R$, show that $ax + xa$ commutes with $a$.","import Mathlib

/--
If a^2 = 0 in a (possibly noncommutative) ring R, show that ax + xa commutes with a.
-/
variable {R : Type*} [Ring R]

theorem Herstein_exercise_4_2_6 (a x : R) (ha : a * a = 0) :
  a * (a * x + x * a) = (a * x + x * a) * a := by sorry
"
Herstein_exercise_4_3_1,Algebra,success,True,3,"If $R$ is a commutative ring and $a \in R$, let $L(a) = \{x \in R \mid xa = 0\}$. Prove that $L(a)$ is an ideal of $R$.","import Mathlib


/-- If $R$ is a commutative ring and $a \in R$, let $L(a) = \{x \in R \mid xa = 0\}$. Prove that $L(a)$ is an ideal of $R$. -/
theorem isIdeal_ker_mul_left {R : Type*} [CommRing R] (a : R) :
  Ideal.IsIdeal (setOf (λ x => x * a = 0)) := by sorry
"
Herstein_exercise_2_11_7,Algebra,success,True,3,"If $P \triangleleft G$, $P$ a $p$-Sylow subgroup of $G$, prove that $\varphi(P) = P$ for every automorphism $\varphi$ of $G$.","import Mathlib

variable {G : Type*} [Group G] {p : ℕ} (P : Subgroup G)

/-- If P ◁ G and P is a p-Sylow subgroup of G, then every automorphism of G fixes P. -/
theorem sylow_normal_fixed (hP : IsSylow p P) (hnormal : P.normal) (φ : G ≃* G) :
  P.map (φ.toMonoidHom) = P := by sorry
"
Herstein_exercise_3_2_21,Algebra,success,True,3,"If $\sigma, \tau$ are two permutations that disturb no common element and $\sigma \tau = e$, prove that $\sigma = \tau = e$.","import Mathlib

theorem herstein_exercise_3_2_21 {α : Type _} (σ τ : α ≃ α)
  (h_disjoint : ∀ x, σ x = x ∨ τ x = x)
  (h_mul : σ.trans τ = Equiv.refl α) : σ = Equiv.refl α ∧ τ = Equiv.refl α := by sorry
"
Herstein_exercise_4_1_34,Algebra,success,True,3,"Let $T$ be the group of $2\times 2$ matrices $A$ with entries in the field $\mathbb{Z}_2$ such that $\det A$ is not equal to 0. Prove that $T$ is isomorphic to $S_3$, the symmetric group of degree 3.","import Mathlib

/-- Let T be the group of 2×2 matrices over ZMod 2 with nonzero determinant (i.e. the units
    in the 2×2 matrix ring over Z/2Z). This group is isomorphic to the symmetric group S_3.
    Statement provided without proof. -/

def T : Type := Units (Matrix (Fin 2) (Fin 2) (ZMod 2))

theorem Herstein_exercise_4_1_34 : T ≃* Equiv.Perm (Fin 3) := by sorry
"
Herstein_exercise_4_4_9,Algebra,success,True,3,"Show that $(p - 1)/2$ of the numbers $1, 2, \ldots, p - 1$ are quadratic residues and $(p - 1)/2$ are quadratic nonresidues $\mod p$.","import Mathlib

/--
Show that exactly (p - 1) / 2 of the nonzero residues mod p are quadratic residues and
exactly (p - 1) / 2 are quadratic nonresidues, for p an odd prime.
-/
theorem herstein_exercise_4_4_9 (p : ℕ) [Fact (p.Prime)] (hp_ne_two : p ≠ 2) :
  (p - 1) / 2 = Fintype.card { a : ZMod p // a ≠ 0 ∧ ∃ y : ZMod p, y ^ 2 = a } ∧
  (p - 1) / 2 = Fintype.card { a : ZMod p // a ≠ 0 ∧ ¬ (∃ y : ZMod p, y ^ 2 = a) } := by sorry
"
Herstein_exercise_4_5_23,Algebra,success,True,3,Let $F = \mathbb{Z}_7$ and let $p(x) = x^3 - 2$ and $q(x) = x^3 + 2$ be in $F[x]$. Show that $p(x)$ and $q(x)$ are irreducible in $F[x]$ and that the fields $F[x]/(p(x))$ and $F[x]/(q(x))$ are isomorphic.,"import Mathlib

/-
Exercise: Let F = ZMod 7 and let p(x) = x^3 - 2 and q(x) = x^3 + 2 in F[X].
Show that p and q are irreducible in F[X] and that the fields F[X]/(p) and F[X]/(q) are isomorphic.
-/

def F := ZMod 7

open Polynomial

noncomputable section

variable {F}

/-- The two cubic polynomials over ZMod 7. -/
def p : Polynomial F := X ^ 3 - C (2 : F)
def q : Polynomial F := X ^ 3 + C (2 : F)

/-- p is irreducible in F[X]. -/
theorem p_irreducible : Irreducible (p : Polynomial F) := by sorry

/-- q is irreducible in F[X]. -/
theorem q_irreducible : Irreducible (q : Polynomial F) := by sorry

/-- The quotient rings F[X]/(p) and F[X]/(q) are isomorphic (in fact they are fields). -/
theorem quot_iso : (Polynomial F) ⧸ Ideal.span ({p} : Set (Polynomial F)) ≃+* (Polynomial F) ⧸ Ideal.span ({q} : Set (Polynomial F)) := by sorry

end
"
Herstein_exercise_5_1_8,Algebra,success,True,3,"If $F$ is a field of characteristic $p \neq 0$, show that $(a + b)^m = a^m + b^m$, where $m = p^n$, for all $a, b \in F$ and any positive integer $n$.","import Mathlib


/-- If F is a field of characteristic p ≠ 0, show that (a + b)^m = a^m + b^m, where m = p^n, for all a, b ∈ F and any positive integer n. -/
theorem add_pow_eq_add_pow_mod_char_pow {F : Type*} [Field F] (p : ℕ) [Fact (CharP F p)] (n : ℕ) (a b : F) :
  (a + b) ^ p ^ n = a ^ p ^ n + b ^ p ^ n := by sorry
"
Herstein_exercise_5_4_3,Algebra,success,True,3,"If $a \in C$ is such that $p(a) = 0$, where $p(x) = x^5 + \sqrt{2}x^3 + \sqrt{5}x^2 + \sqrt{7}x + \sqrt{11}$, show that $a$ is algebraic over $\mathbb{Q}$ of degree at most 80.","import Mathlib

/--
If a ∈ ℂ is such that p(a) = 0, where
p(x) = x^5 + √2 x^3 + √5 x^2 + √7 x + √11,
then a is algebraic over ℚ of degree at most 80.
-/
theorem Herstein_exercise_5_4_3 (a : ℂ) (ha : (a ^ 5) + (Real.sqrt 2 : ℂ) * (a ^ 3) + (Real.sqrt 5 : ℂ) * (a ^ 2) + (Real.sqrt 7 : ℂ) * a + (Real.sqrt 11 : ℂ) = 0) :
  -- a is algebraic over ℚ of degree at most 80
  (IsAlgAlgebraic (algebraMap ℚ ℂ) a) ∧
  -- degree at most 80: there exists a nonzero polynomial over ℚ of degree ≤ 80 with a as root
  ∃ p : (MvPolynomial (Fin (80 + 1)) ℚ),
    -- This is a placeholder encoding; full construction omitted.
    MvPolynomial.eval (fun i => a) p = 0 := by sorry
"
Herstein_exercise_5_3_7,Algebra,success,True,3,"If $a \in K$ is such that $a^2$ is algebraic over the subfield $F$ of $K$, show that a is algebraic over $F$.","import Mathlib

/-- If a ∈ K is such that a^2 is algebraic over the subfield F of K, then a is algebraic over F. -/
theorem Herstein_exercise_5_3_7 {F K : Type _} [Field F] [Field K] [Algebra F K] {a : K}
  (h : IsAlgebraic F K (a ^ 2)) : IsAlgebraic F K a := by sorry
"
Artin_exercise_2_3_2,Algebra,success,True,3,Prove that the products $a b$ and $b a$ are conjugate elements in a group.,"import Mathlib


/-- Prove that the products $a b$ and $b a$ are conjugate elements in a group. -/
theorem isConj_mul_comm {G : Type _} [Group G] (a b : G) : IsConj (a * b) (b * a) := by sorry
"
Herstein_exercise_5_6_14,Algebra,success,True,3,"If $F$ is of characteristic $p \neq 0$, show that all the roots of $x^m - x$, where $m = p^n$, are distinct.","import Mathlib

/-!
Exercise: If F is of characteristic p ≠ 0, show that all the roots of x^m - x,
where m = p^n, are distinct.
-/-

open Polynomial

theorem herstein_exercise_5_6_14 {F : Type _} [Field F] {p : ℕ} (n : ℕ) [CharP F p] (hp : p ≠ 0) :
  ∀ a : F, ((X ^ (p ^ n) - X : F[X]).eval a = 0) → ((X ^ (p ^ n) - X : F[X]).derivative.eval a ≠ 0) := by sorry
"
Artin_exercise_2_8_6,Algebra,success,True,3,Prove that the center of the product of two groups is the product of their centers.,"import Mathlib

variable {G H : Type _} [Group G] [Group H]

/-- The center of the product group G × H consists of exactly those pairs whose components
    lie in the centers of G and H respectively. -/
theorem center_prod_centers :
  { z : G × H | ∀ w : G × H, z * w = w * z } =
  { p : G × H | (∀ g' : G, p.1 * g' = g' * p.1) ∧ (∀ h' : H, p.2 * h' = h' * p.2) } := by sorry
"
Artin_exercise_6_4_12,Algebra,success,True,3,Prove that no group of order 224 is simple.,"import Mathlib

/-- No group of order 224 is simple. -/
theorem no_group_of_order_224_simple {G : Type*} [Group G] [Fintype G] (h : Fintype.card G = 224) :
  ∃ N : Subgroup G, N.normal ∧ N ≠ ⊥ ∧ N ≠ ⊤ := by sorry
"
Herstein_exercise_4_6_2,Algebra,success,True,3,Prove that $f(x) = x^3 + 3x + 2$ is irreducible in $Q[x]$.,"import Mathlib

/-- Polynomial f(x) = x^3 + 3x + 2 over Q. -/
def f : Polynomial ℚ := Polynomial.X ^ 3 + 3 * Polynomial.X + 2

theorem Herstein_exercise_4_6_2 : Irreducible (f : Polynomial ℚ) := by sorry
"
Artin_exercise_10_1_13,Algebra,success,True,3,"An element $x$ of a ring $R$ is called nilpotent if some power of $x$ is zero. Prove that if $x$ is nilpotent, then $1+x$ is a unit in $R$.","import Mathlib


/-- An element $x$ of a ring $R$ is called nilpotent if some power of $x$ is zero. Prove that if $x$ is nilpotent, then $1+x$ is a unit in $R$. -/
theorem one_add_isUnit_of_isNilpotent {R : Type*} [Ring R] {x : R} (hx : IsNilpotent x) :
    IsUnit (1 + x) := by sorry"
Artin_exercise_6_4_2,Algebra,success,True,3,"Prove that no group of order $p q$, where $p$ and $q$ are prime, is simple.","import Mathlib

/--
Exercise (Artin 6.4.2): No group of order p * q, where p and q are prime, is simple.
We state this as: for primes p and q and a group G with card G = p * q,
there exists a nontrivial proper normal subgroup of G.
-/
theorem Artin_exercise_6_4_2 {p q : ℕ} (hp : Nat.Prime p) (hq : Nat.Prime q)
  {G : Type _} [Group G] [Fintype G] (hcard : Fintype.card G = p * q) :
  ∃ N : NormalSubgroup G, N ≠ (⊤ : NormalSubgroup G) ∧ N ≠ (⊥ : NormalSubgroup G) := by sorry
"
Artin_exercise_3_2_7,Algebra,success,True,3,Prove that every homomorphism of fields is injective.,"import Mathlib

/-- Every homomorphism of fields is injective. -/
theorem ring_hom.injective_of_fields {K L : Type*} [Field K] [Field L] (f : K →+* L) :
  Function.Injective f.to_fun := by sorry
"
Artin_exercise_3_7_2,Algebra,success,True,3,Let $V$ be a vector space over an infinite field $F$. Prove that $V$ is not the union of finitely many proper subspaces.,"import Mathlib

/-!
Exercise: Let V be a vector space over an infinite field F. Prove that V is not the union of finitely many proper subspaces.
This file states the result in Lean4 / mathlib style. The proof is omitted (sorry).
-/-

theorem Artin_exercise_3_7_2 {F : Type*} [Field F] {V : Type*} [AddCommGroup V] [Module F V]
  (infF : Infinite F) :
  ∀ (s : Finset (Submodule F V)), (∀ W (h : W ∈ s), W ≠ (⊤ : Submodule F V)) →
    ∃ v : V, ∀ W (h : W ∈ s), v ∉ W := by sorry
"
Artin_exercise_11_2_13,Algebra,success,True,3,"If $a, b$ are integers and if $a$ divides $b$ in the ring of Gauss integers, then $a$ divides $b$ in $\mathbb{Z}$.","import Mathlib

-- If a, b are integers and if a divides b in the ring of Gauss integers, then a divides b in ℤ.

theorem Artin_exercise_11_2_13 {a b : Int} (h : (a : GaussianInt) ∣ (b : GaussianInt)) : a ∣ b := by sorry
"
Artin_exercise_10_4_7a,Algebra,success,True,3,"Let $I, J$ be ideals of a ring $R$ such that $I+J=R$. Prove that $I J=I \cap J$.","import Mathlib

variable {R : Type _} [CommRing R] (I J : Ideal R)

theorem ideal_mul_eq_inf_of_add_eq_top (h : I + J = ⊤) : I * J = I ⊓ J := by sorry
"
Artin_exercise_10_6_7,Algebra,success,True,3,Prove that every nonzero ideal in the ring of Gauss integers contains a nonzero integer.,"import Mathlib

/-- The ring of Gaussian integers as the quotient ℤ[X] / (X^2 + 1). -/
def gaussian_int : Type := (Polynomial Int) ⧸ Ideal.span ({Polynomial.X ^ 2 + 1} : Set (Polynomial Int))

/-- Exercise (Artin 10.6.7): Every nonzero ideal in the ring of Gaussian integers contains a nonzero integer. -/
theorem Artin_exercise_10_6_7 (I : Ideal gaussian_int) (h : I ≠ ⊥) :
  ∃ n : Int, (n : gaussian_int) ∈ I ∧ n ≠ 0 := by sorry
"
Artin_exercise_11_4_6a,Algebra,success,True,3,Prove that $x^2+x+1$ is irreducible in the field $\mathbb{F}_2$.,"import Mathlib

open Polynomial

/-- Exercise 11.4.6(a) (Artin): The polynomial X^2 + X + 1 is irreducible over the field F2. -/
theorem Artin_exercise_11_4_6a : Irreducible (X ^ 2 + X + 1 : Polynomial (ZMod 2)) := by sorry
"
Artin_exercise_11_4_6c,Algebra,success,True,3,Prove that $x^3 - 9$ is irreducible in $\mathbb{F}_{31}$.,"import Mathlib

open Polynomial

/-
Exercise (Artin 11.4.6(c)).
Show that x^3 - 9 is irreducible over F_{31}.
-/
theorem Artin_exercise_11_4_6c : Irreducible (X ^ 3 - 9 : Polynomial (ZMod 31)) := by sorry
"
Artin_exercise_11_13_3,Algebra,success,True,3,Prove that there are infinitely many primes congruent to $-1$ (modulo $4$).,"import Mathlib

/-!
# Infinitely many primes congruent to -1 mod 4

We state the classical result: there are infinitely many primes p with p ≡ -1 (mod 4).
We provide the statement only; the proof is omitted (``by sorry'').
-/

open Nat

theorem infinitely_many_primes_eq_neg_one_mod_four :
  ∀ n : Nat, ∃ p : Nat, p > n ∧ Prime p ∧ p % 4 = 3 := by sorry
"
Dummit-Foote_exercise_1_1_2a,Algebra,success,True,3,Prove the the operation $\star$ on $\mathbb{Z}$ defined by $a\star b=a-b$ is not commutative.,"import Mathlib

/-!
Dummit and Foote, exercise 1.1.2(a).
Define an operation ⋆ on ℤ by a ⋆ b = a - b and state that it is not commutative.
-/

def star (a b : Int) : Int := a - b

notation:65 a "" ⋆ "" b => star a b

theorem star_not_comm : ∃ a b : Int, (a ⋆ b) ≠ (b ⋆ a) := by sorry
"
Dummit-Foote_exercise_1_1_4,Algebra,success,True,3,Prove that the multiplication of residue class $\mathbb{Z}/n\mathbb{Z}$ is associative.,"import Mathlib


/-- Prove that the multiplication of residue class $\mathbb{Z}/n\mathbb{Z}$ is associative. -/
theorem mul_assoc_Zmod (n : ℕ) : ∀ a b c : ZMod n, a * b * c = a * (b * c) := by sorry
"
Dummit-Foote_exercise_1_1_20,Algebra,success,True,3,For $x$ an element in $G$ show that $x$ and $x^{-1}$ have the same order.,"import Mathlib
open Finset

/-- For $x$ an element in $G$ show that $x$ and $x^{-1}$ have the same order. -/
theorem same_order_inv {G : Type*} [Group G] (x : G) : orderOf x = orderOf x⁻¹ := by sorry
"
Dummit-Foote_exercise_1_1_15,Algebra,success,True,3,"Prove that $(a_1a_2\dots a_n)^{-1} = a_n^{-1}a_{n-1}^{-1}\dots a_1^{-1}$ for all $a_1, a_2, \dots, a_n\in G$.","import Mathlib

/-!
Exercise: Prove that (a_1 a_2 ... a_n)^{-1} = a_n^{-1} a_{n-1}^{-1} ... a_1^{-1} for all a_1, ..., a_n in a group G.
We state a general list version: the inverse of the product of a list equals the product of the inverses in reverse order.
-/

theorem Dummit_Foote_exercise_1_1_15 {G : Type*} [Group G] (l : List G) :
  (l.prod)⁻¹ = (l.reverse.map (·⁻¹)).prod := by sorry
"
Dummit-Foote_exercise_1_1_17,Algebra,success,True,3,Let $x$ be an element of $G$. Prove that if $|x|=n$ for some positive integer $n$ then $x^{-1}=x^{n-1}$.,"import Mathlib

variable {G : Type _} [Group G]
variable {x : G} {n : ℕ}

/-- If |x| = n, i.e., x^n = 1 and n is the least positive exponent, then x^{-1} = x^{n-1}. -/
theorem Dummit_Foote_exercise_1_1_17 (h_pow : x ^ n = 1) (h_min : ∀ m, m < n → x ^ m ≠ 1) (hn : 0 < n) : x⁻¹ = x ^ (n - 1) := by sorry
"
Dummit-Foote_exercise_1_1_29,Algebra,success,True,3,Prove that $A \times B$ is an abelian group if and only if both $A$ and $B$ are abelian.,"import Mathlib
open Pointwise

/-- Prove that $A \times B$ is an abelian group if and only if both $A$ and $B$ are abelian. -/
theorem comm_of_prod_comm {A B : Type*} [Group A] [Group B] :
  CommGroup (A × B) ↔ CommGroup A ∧ CommGroup B := by sorry
"
Artin_exercise_13_6_10,Algebra,success,True,3,Let $K$ be a finite field. Prove that the product of the nonzero elements of $K$ is $-1$.,"import Mathlib

/-!
Exercise: Let K be a finite field. Prove that the product of the nonzero elements of K is -1.
-/-

theorem Artin_exercise_13_6_10 (K : Type*) [Field K] [Fintype K] :
  (∏ x : K in (Finset.univ.erase (0 : K)), x) = -1 := by sorry
"
Dummit-Foote_exercise_1_1_22b,Algebra,success,True,3,"Deduce that $|a b|=|b a|$ for all $a, b \in G$.","import Mathlib

variable {G : Type _} [Group G]

theorem orderOf_mul_eq_orderOf_mul_swap (a b : G) : orderOf (a * b) = orderOf (b * a) := by sorry
"
Dummit-Foote_exercise_1_6_11,Algebra,success,True,2,Let $A$ and $B$ be groups. Prove that $A \times B \cong B \times A$.,"import Mathlib

/-- Exercise: Let A and B be groups. Prove that A × B ≅ B × A. -/
theorem Dummit_Foote_exercise_1_6_11 (A B : Type*) [Group A] [Group B] : A × B ≃* B × A := by sorry
"
Dummit-Foote_exercise_1_3_8,Algebra,success,True,3,"Prove that if $\Omega=\{1,2,3, \ldots\}$ then $S_{\Omega}$ is an infinite group","import Mathlib

/-- Prove that if Ω = {1,2,3, ...} then S_Ω is an infinite group -/
-- We model Ω as the subtype of natural numbers n with n ≥ 1, i.e. {1,2,3,...} = {n : ℕ // n ≥ 1}.

theorem infinite_symmetric_group_on_omega : Infinite (Equiv.Perm (Set.Ici 1)) := by sorry
"
Dummit-Foote_exercise_2_4_16a,Algebra,success,True,3,A subgroup $M$ of a group $G$ is called a maximal subgroup if $M \neq G$ and the only subgroups of $G$ which contain $M$ are $M$ and $G$. Prove that if $H$ is a proper subgroup of the finite group $G$ then there is a maximal subgroup of $G$ containing $H$.,"import Mathlib
open Subgroup

/-- A subgroup $M$ of a group $G$ is called a maximal subgroup if $M \neq G$ and the only subgroups of $G$ which contain $M$ are $M$ and $G$. Prove that if $H$ is a proper subgroup of the finite group $G$ then there is a maximal subgroup of $G$ containing $H$.

Save it to: Dummit-Foote_exercise_2_4_16a.lean -/
theorem exists_max_subgroup_of_proper_subgroup (G : Type*) [Group G] [Finite G] (H : Subgroup G) :
    H < ⊤ → ∃ M : Subgroup G, M.IsMaximal ∧ H ≤ M := by sorry
"
Dummit-Foote_exercise_1_6_23,Algebra,success,True,3,"Let $G$ be a finite group which possesses an automorphism $\sigma$ such that $\sigma(g)=g$ if and only if $g=1$. If $\sigma^{2}$ is the identity map from $G$ to $G$, prove that $G$ is abelian.","/-!
Dummit and Foote exercise 1.6.23
-/

import Mathlib

/-- Let G be a finite group which possesses an automorphism σ such that σ(g) = g iff g = 1.
    If σ^2 is the identity map from G to G, then G is abelian. -/
theorem Dummit_Foote_exercise_1_6_23 {G : Type _} [Group G] [Fintype G] (σ : G ≃* G)
  (hfix : ∀ g : G, σ g = g ↔ g = 1) (h2 : σ.trans σ = MulEquiv.refl G) :
  ∀ a b : G, a * b = b * a := by sorry
"
Dummit-Foote_exercise_3_1_22a,Algebra,success,True,3,Prove that if $H$ and $K$ are normal subgroups of a group $G$ then their intersection $H \cap K$ is also a normal subgroup of $G$.,"import Mathlib

/-- If H and K are normal subgroups of a group G then their intersection H ∩ K is also a normal subgroup of G. -/
theorem Dummit_Foote_exercise_3_1_22a {G : Type _} [Group G] {H K : Subgroup G}
  (hH : H.normal) (hK : K.normal) : (H ⊓ K).normal := by sorry
"
Dummit-Foote_exercise_2_1_13,Algebra,success,True,3,Let $H$ be a subgroup of the additive group of rational numbers with the property that $1 / x \in H$ for every nonzero element $x$ of $H$. Prove that $H=0$ or $\mathbb{Q}$.,"import Mathlib

/-- Let H be an additive subgroup of the rational numbers with the property that the
multiplicative inverse 1/x belongs to H for every nonzero x in H. Then H is either
the zero subgroup or the whole of Q. -/
theorem Dummit_Foote_exercise_2_1_13 (H : AddSubgroup (Rat))
  (h : ∀ x, x ∈ H → x ≠ 0 → x⁻¹ ∈ H) : H = (⊥ : AddSubgroup (Rat)) ∨ H = (⊤ : AddSubgroup (Rat)) := by sorry
"
Dummit-Foote_exercise_3_2_8,Algebra,success,True,3,Prove that if $H$ and $K$ are finite subgroups of $G$ whose orders are relatively prime then $H \cap K=1$.,"import Mathlib

/-- If H and K are finite subgroups of G whose orders are relatively prime then H ∩ K = 1. -/
theorem Dummit_Foote_exercise_3_2_8 {G : Type*} [Group G] {H K : Subgroup G}
  [Fintype H] [Fintype K] (coprime : Nat.Coprime (Fintype.card H) (Fintype.card K)) :
  (H ⊓ K) = ⊥ := by sorry
"
Dummit-Foote_exercise_3_2_16,Algebra,success,True,3,Use Lagrange's Theorem in the multiplicative group $(\mathbb{Z} / p \mathbb{Z})^{\times}$to prove Fermat's Little Theorem: if $p$ is a prime then $a^{p} \equiv a(\bmod p)$ for all $a \in \mathbb{Z}$.,"import Mathlib

/--
Fermat's Little Theorem (as an equality in ZMod p):
For a prime p and any integer a, a^p ≡ a (mod p).
We state it as (a : ZMod p)^p = (a : ZMod p).
Proof sketch: apply Lagrange's theorem to the multiplicative group (Z/pZ)^× and handle the case a ≡ 0 (mod p) separately.
-/
theorem fermat_little_theorem (p : ℕ) (hp : p.Prime) (a : ℤ) :
  (a : ZMod p) ^ p = (a : ZMod p) := by
  sorry
"
Dummit-Foote_exercise_3_4_4,Algebra,success,True,3,Use Cauchy's Theorem and induction to show that a finite abelian group has a subgroup of order $n$ for each positive divisor $n$ of its order.,"import Mathlib

/-!
Dummit & Foote, Ex. 3.4.4:
Use Cauchy's Theorem and induction to show that a finite abelian group
has a subgroup of order n for each positive divisor n of its order.
-/

variable {G : Type _} [Group G] [Fintype G] [CommGroup G]

theorem finite_abelian_group_has_subgroup_of_order (n : ℕ) (h : n ∣ Fintype.card G) :
  ∃ H : Subgroup G, Fintype.card H = n := by sorry
"
Dummit-Foote_exercise_3_4_5b,Algebra,success,True,3,Prove that quotient groups of a solvable group are solvable.,"import Mathlib

/-!
Prove that quotient groups of a solvable group are solvable.
This file states the theorem; the proof is omitted (``by sorry'').
-/-

variable {G : Type _} [Group G] (N : NormalSubgroup G)

theorem solvable_quotient (h : IsSolvable G) : IsSolvable (G ⧸ N) := by sorry
"
Dummit-Foote_exercise_3_3_3,Algebra,success,True,3,"Prove that if $H$ is a normal subgroup of $G$ of prime index $p$ then for all $K \leq G$ either $K \leq H$, or $G=H K$ and $|K: K \cap H|=p$.","import Mathlib

/-!
Exercise (Dummit & Foote 3.3.3) — informal translation to Lean4/Mathlib
If H ⊲ G has prime index p, then for every subgroup K ≤ G either K ≤ H,
or G = H K and |K : K ⊓ H| = p.

This file only states the theorem (with `:= by sorry`) and does not provide a proof.
-/

variable {G : Type*} [Group G]

open Set

theorem Dummit_Foote_exercise_3_3_3
  (H : Subgroup G) {p : ℕ} (hp : Nat.Prime p)
  (Hnormal : H.normal)
  (hindex : Fintype.card (QuotientGroup.quotient H) = p) :
  ∀ (K : Subgroup G),
    (K ≤ H) ∨ (
      (H : Set G) * (K : Set G) = (Set.univ : Set G) ∧
      Fintype.card (QuotientGroup.quotient (K ⊓ H)) = p
    ) := by sorry
"
Dummit-Foote_exercise_2_4_16c,Algebra,success,True,3,Show that if $G=\langle x\rangle$ is a cyclic group of order $n \geq 1$ then a subgroup $H$ is maximal if and only $H=\left\langle x^{p}\right\rangle$ for some prime $p$ dividing $n$.,"import Mathlib

/--
If G = ⟨x⟩ is a cyclic group of order n ≥ 1 then a subgroup H is maximal iff
H = ⟨x^p⟩ for some prime p dividing n.

This file states the exercise as a Lean theorem. The proof is omitted (:= by sorry).
-/

variable {G : Type _} [Group G]
variable (x : G) (n : ℕ)

-- We assume G is generated by x and that x has order n.
variable (h_gen : Subgroup.closure ({x} : Set G) = (⊤ : Subgroup G))
variable (h_order : OrderOf x = n)

theorem Dummit_Foote_exercise_2_4_16c :
  ∀ (H : Subgroup G), H.Maximal ↔ ∃ p : ℕ, p.Prime ∧ p ∣ n ∧ H = Subgroup.closure ({x ^ p} : Set G) :=
by sorry
"
Dummit-Foote_exercise_4_2_8,Algebra,success,True,3,Prove that if $H$ has finite index $n$ then there is a normal subgroup $K$ of $G$ with $K \leq H$ and $|G: K| \leq n!$.,"import Mathlib

open Subgroup

/-- If H has finite index n then there is a normal subgroup K of G with K ≤ H and |G : K| ≤ n!. -/
theorem Dummit_Foote_exercise_4_2_8 {G : Type*} [Group G] (H : Subgroup G) (n : Nat)
  (h : H.index = n) :
  ∃ K : Subgroup G, K.normal ∧ K ≤ H ∧ K.index ≤ n! := by sorry
"
Dummit-Foote_exercise_4_4_2,Algebra,success,True,3,"Prove that if $G$ is an abelian group of order $p q$, where $p$ and $q$ are distinct primes, then $G$ is cyclic.","import Mathlib

/-!
Exercise: Prove that if G is an abelian group of order p q, where p and q are distinct primes, then G is cyclic.
This file only states the theorem; the proof is omitted (:= by sorry) as requested.
-/

theorem abelian_group_order_pq_cyclic {G : Type*} [AddCommGroup G] [Fintype G] {p q : ℕ}
  (hp : Nat.Prime p) (hq : Nat.Prime q) (hne : p ≠ q) (hcard : Fintype.card G = p * q) :
  ∃ g : G, AddSubgroup.closure (Set.singleton g) = (⊤ : AddSubgroup G) := by sorry
"
Dummit-Foote_exercise_4_2_9a,Algebra,success,True,3,"Prove that if $p$ is a prime and $G$ is a group of order $p^{\alpha}$ for some $\alpha \in \mathbb{Z}^{+}$, then every subgroup of index $p$ is normal in $G$.","import Mathlib

/-!
Exercise (Dummit and Foote 4.2.9a).
If p is a prime and G is a group of order p^α for some α : ℕ, then every subgroup of index p is normal in G.
-/

theorem Dummit_Foote_exercise_4_2_9a {G : Type*} [Group G] [Fintype G] {p : ℕ} (hp : Nat.Prime p)
  {α : ℕ} (hcard : Fintype.card G = p ^ α) (H : Subgroup G)
  (hindex : Fintype.card (G ⧸ H) = p) :
  -- Every subgroup of index p is normal
  H.normal := by sorry
"
Dummit-Foote_exercise_4_5_13,Algebra,success,True,3,Prove that a group of order 56 has a normal Sylow $p$-subgroup for some prime $p$ dividing its order.,"import Mathlib

theorem Dummit_Foote_exercise_4_5_13 {G : Type*} [Group G] [Fintype G] (h : Fintype.card G = 56) :
  ∃ (p : ℕ) (hp : Nat.Prime p) (P : Subgroup G),
    p ∣ (56 : ℕ) ∧ P.IsSylow p ∧ P.Normal := by sorry
"
Dummit-Foote_exercise_4_5_17,Algebra,success,True,3,Prove that if $|G|=105$ then $G$ has a normal Sylow 5 -subgroup and a normal Sylow 7-subgroup.,"import Mathlib
open Subgroup
open Finset Nat
open scoped Classical
open Nat
open Subgroup
open Monoid
open Subgroup AddSubgroup

/-- Prove that if |G|=105 then G has a normal Sylow 5 -subgroup and a normal Sylow 7-subgroup. -/
theorem sylow_normal_extracted {G : Type u_1} [Group G] [Fact (Nat.Prime 5)] [Fact (Nat.Prime 7)] :
  Nat.card G = 105 → (∃ P, P ∈ sylow 5 G ∧ P.Normal) ∧ ∃ P, P ∈ sylow 7 G ∧ P.Normal := by sorry
"
Dummit-Foote_exercise_4_5_15,Algebra,success,True,3,Prove that a group of order 351 has a normal Sylow $p$-subgroup for some prime $p$ dividing its order.,"import Mathlib

/-- Exercise (Dummit & Foote 4.5.15):
If G is a group of order 351, then G has a normal Sylow p-subgroup for some prime p dividing 351. -/
theorem Dummit_Foote_exercise_4_5_15 {G : Type _} [Group G] [Fintype G] (h : Fintype.card G = 351) :
  ∃ (p : ℕ) (P : Subgroup G), Nat.Prime p ∧ p ∣ 351 ∧ IsSylow p P ∧ IsNormal P := by sorry
"
Dummit-Foote_exercise_4_5_19,Algebra,success,True,3,Prove that if $|G|=6545$ then $G$ is not simple.,"import Mathlib

/-- Exercise: If |G| = 6545 then G is not simple. -/
theorem Dummit_Foote_exercise_4_5_19 {G : Type _} [Group G] [Fintype G] (h : Fintype.card G = 6545) : ¬SimpleGroup G := by sorry"
Dummit-Foote_exercise_4_4_6b,Algebra,success,True,3,Prove that there exists a normal subgroup that is not characteristic.,"import Mathlib

-- There exists a normal subgroup which is not characteristic.
-- Example: the Klein four group V4 has three distinct subgroups of order 2; each is normal but none is characteristic.

theorem exists_normal_not_characteristic :
  ∃ (G : Type*) [Group G], ∃ (H : Subgroup G), IsNormal H ∧ ¬IsCharacteristic H := by
  sorry
"
Dummit-Foote_exercise_4_5_21,Algebra,success,True,3,Prove that if $|G|=2907$ then $G$ is not simple.,"import Mathlib

/-
Exercise (Dummit & Foote 4.5.21, translated):
If |G| = 2907 then G is not simple.

Sketch of the intended proof (not formalized here): 2907 = 3^2 * 17 * 19.
By Sylow theory, the number n_17 of Sylow 17-subgroups divides 9*19 = 171 and is congruent to 1 mod 17, hence n_17 ∈ {1,171}.
Similarly n_19 ∈ {1,153}.
If both were greater than 1 one gets at least 171*16 + 153*18 = 5490 nonidentity elements, a contradiction.
Thus at least one of the Sylow 17- or 19-subgroups is unique and hence normal, so G is not simple.
-/

theorem Dummit_Foote_exercise_4_5_21 {G : Type*} [Group G] [Fintype G]
  (h : Fintype.card G = 2907) :
  ∃ N : Subgroup G, (∀ g x, x ∈ N → g * x * g⁻¹ ∈ N) ∧ N ≠ (⊥ : Subgroup G) ∧ N ≠ (⊤ : Subgroup G) :=
by
  sorry
"
Dummit-Foote_exercise_4_5_23,Algebra,success,True,3,Prove that if $|G|=462$ then $G$ is not simple.,"import Mathlib

/--
If |G| = 462 then G is not simple: there exists a nontrivial proper normal subgroup.
-/
theorem Dummit_Foote_exercise_4_5_23 {G : Type*} [Group G] [Fintype G] (h : Fintype.card G = 462) :
  ∃ H : Subgroup G, IsNormal H ∧ H ≠ ⊥ ∧ H ≠ ⊤ := by sorry
"
Dummit-Foote_exercise_7_1_2,Algebra,success,True,3,Prove that if $u$ is a unit in $R$ then so is $-u$.,"import Mathlib

/-!
Exercise: Prove that if u is a unit in R then so is -u.
We state the lemma below. (Proof omitted.)
-/-

theorem isUnit_neg {R : Type _} [Ring R] {u : R} (h : IsUnit u) : IsUnit (-u) := by sorry
"
Dummit-Foote_exercise_7_1_12,Algebra,success,True,3,Prove that any subring of a field which contains the identity is an integral domain.,"import Mathlib

/-- Any subring of a field which contains the identity is an integral domain. -/
theorem subring_of_field_is_integral_domain {K : Type _} [Field K] (S : Subring K)
  (h : (1 : K) ∈ S) : IsDomain S := by
  -- proof omitted
  sorry
"
Dummit-Foote_exercise_4_4_8a,Algebra,success,True,3,Let $G$ be a group with subgroups $H$ and $K$ with $H \leq K$. Prove that if $H$ is characteristic in $K$ and $K$ is normal in $G$ then $H$ is normal in $G$.,"import Mathlib

variable {G : Type _} [Group G]

/-- H is characteristic in K when H ≤ K and H is fixed by every group automorphism of K. -/
def IsCharacteristic (H K : Subgroup G) : Prop :=
  H ≤ K ∧ ∀ (e : (↥K) ≃* (↥K)) (x : ↥K), ((e x : G) ∈ (H : Set G)) ↔ ((x : G) ∈ (H : Set G))

/-- Exercise 4.4.8(a) (Dummit–Foote): If H ≤ K, H characteristic in K, and K ⫴ G, then H ⫴ G. -/
theorem Dummit_Foote_exercise_4_4_8a {H K : Subgroup G}
  (hHK : H ≤ K) (hchar : IsCharacteristic H K) (hKnormal : K.Normal) : H.Normal := by sorry
"
Dummit-Foote_exercise_4_5_33,Algebra,success,True,3,Let $P$ be a normal Sylow $p$-subgroup of $G$ and let $H$ be any subgroup of $G$. Prove that $P \cap H$ is the unique Sylow $p$-subgroup of $H$.,"import Mathlib

/-!
Exercise: Let P be a normal Sylow p-subgroup of G and let H be any subgroup of G.
Prove that P ∩ H is the unique Sylow p-subgroup of H.

This file states the lemma; proof omitted (:= by sorry).
-/

variable {G : Type _} [Group G] [Fintype G]
variable {p : ℕ} [Fact (Nat.Prime p)]

open Subgroup

/- We state the result in terms of the Sylow predicate `IsSylow` and the
`Subgroup` intersection. The proof is omitted. -/

theorem sylow_normal_inter_unique {P H : Subgroup G}
  (hP : IsSylow p P) (hnormal : P.Normal) :
  IsSylow p (P ⊓ H) ∧
  ∀ (Q : Subgroup H), IsSylow p Q → (Q : Subgroup G) = P ⊓ H := by sorry
"
Dummit-Foote_exercise_7_4_27,Algebra,success,True,3,Let $R$ be a commutative ring with $1 \neq 0$. Prove that if $a$ is a nilpotent element of $R$ then $1-a b$ is a unit for all $b \in R$.,"import Mathlib

/-- Let R be a commutative ring with 1 ≠ 0. If a is nilpotent then 1 - a * b is a unit for all b. -/
theorem Dummit_Foote_exercise_7_4_27 {R : Type*} [CommRing R] [Nontrivial R] {a : R}
  (ha : IsNilpotent a) : ∀ b : R, IsUnit (1 - a * b) := by sorry
"
Dummit-Foote_exercise_7_2_2,Algebra,success,True,3,Let $p(x)=a_{n} x^{n}+a_{n-1} x^{n-1}+\cdots+a_{1} x+a_{0}$ be an element of the polynomial ring $R[x]$. Prove that $p(x)$ is a zero divisor in $R[x]$ if and only if there is a nonzero $b \in R$ such that $b p(x)=0$.,"import Mathlib

variable {R : Type _} [CommRing R]

theorem Dummit_Foote_exercise_7_2_2 (p : Polynomial R) :
  (∃ q : Polynomial R, q ≠ 0 ∧ p * q = 0) ↔ (∃ b : R, b ≠ 0 ∧ Polynomial.C b * p = 0) := by sorry
"
Dummit-Foote_exercise_7_3_16,Algebra,success,True,3,Let $\varphi: R \rightarrow S$ be a surjective homomorphism of rings. Prove that the image of the center of $R$ is contained in the center of $S$.,"import Mathlib

/-!
Let φ : R → S be a surjective homomorphism of rings. Prove that the image of the center
of R is contained in the center of S.

We state this in Lean; proof omitted (:= by sorry).
-/

variable {R S : Type _} [Ring R] [Ring S]
variable (φ : R →+* S) (hφ : Function.Surjective φ)

theorem map_center_subset_center :
  Set.image φ { r : R | ∀ r' : R, r * r' = r' * r } ⊆ { s : S | ∀ s' : S, s * s' = s' * s } := by
  sorry
"
Dummit-Foote_exercise_8_3_5a,Algebra,success,True,3,"Let $R=\mathbb{Z}[\sqrt{-n}]$ where $n$ is a squarefree integer greater than 3. Prove that $2, \sqrt{-n}$ and $1+\sqrt{-n}$ are irreducibles in $R$.","import Mathlib

open Polynomial

variable (n : ℕ) (hpos : 3 < n) (hsq : Squarefree n)

/-- The ring Z[√(-n)] as an adjoin_root of X^2 + n. -/
def R := AdjoinRoot (Polynomial.X ^ 2 + Polynomial.C (n : Int))

/-- The adjoined root, i.e. √(-n). -/
def alpha : R := AdjoinRoot.root (Polynomial.X ^ 2 + Polynomial.C (n : Int))

theorem irreducible_two : Irreducible (2 : R) := by sorry

theorem irreducible_sqrt_neg_n : Irreducible (alpha : R) := by sorry

theorem irreducible_one_plus_sqrt_neg_n : Irreducible (1 + alpha : R) := by sorry
"
Dummit-Foote_exercise_8_2_4,Algebra,success,True,3,"Let $R$ be an integral domain. Prove that if the following two conditions hold then $R$ is a Principal Ideal Domain: (i) any two nonzero elements $a$ and $b$ in $R$ have a greatest common divisor which can be written in the form $r a+s b$ for some $r, s \in R$, and (ii) if $a_{1}, a_{2}, a_{3}, \ldots$ are nonzero elements of $R$ such that $a_{i+1} \mid a_{i}$ for all $i$, then there is a positive integer $N$ such that $a_{n}$ is a unit times $a_{N}$ for all $n \geq N$.","import Mathlib

/-!
Let R be an integral domain. Prove that if the following two conditions hold then R is a
Principal Ideal Domain:

(i) any two nonzero elements a and b in R have a greatest common divisor which can be
    written in the form r * a + s * b for some r, s in R, and

(ii) if a_1, a_2, a_3, ... are nonzero elements of R such that a_{i+1} ∣ a_i for all i,
     then there is a positive integer N such that a_n is a unit times a_N for all n ≥ N.
-/

variable {R : Type _} [CommRing R] [IsDomain R]

theorem Dummit_Foote_exercise_8_2_4
  (h1 : ∀ (a b : R), a ≠ 0 → b ≠ 0 → ∃ d r s : R,
    (d ∣ a ∧ d ∣ b ∧ ∀ e : R, e ∣ a → e ∣ b → e ∣ d) ∧ d = r * a + s * b)
  (h2 : ∀ (a : ℕ → R), (∀ i, a (i + 1) ∣ a i) → ∃ N : ℕ, ∀ n, n ≥ N → ∃ u : Rˣ, a n = (u : R) * a N)
  : IsPrincipalIdealRing R := by sorry
"
Dummit-Foote_exercise_9_4_2a,Algebra,success,True,3,Prove that $x^4-4x^3+6$ is irreducible in $\mathbb{Z}[x]$.,"import Mathlib

open Polynomial

/-- Exercise: Show that x^4 - 4x^3 + 6 is irreducible in ℤ[x]. -/
theorem Dummit_Foote_exercise_9_4_2a : Irreducible (X^4 - 4 * X^3 + C (6) : Polynomial ℤ) := by sorry"
Dummit-Foote_exercise_9_4_2c,Algebra,success,True,3,Prove that $x^4+4x^3+6x^2+2x+1$ is irreducible in $\mathbb{Z}[x]$.,"import Mathlib

open Polynomial

theorem Dummit_Foote_exercise_9_4_2c :
  Irreducible (X ^ 4 + C (4 : Int) * X ^ 3 + C (6 : Int) * X ^ 2 + C (2 : Int) * X + C (1 : Int) : Polynomial Int) :=
by sorry
"
Dummit-Foote_exercise_8_3_6b,Algebra,success,True,3,Let $q \in \mathbb{Z}$ be a prime with $q \equiv 3 \bmod 4$. Prove that the quotient ring $\mathbb{Z}[i] /(q)$ is a field with $q^{2}$ elements.,"import Mathlib

/-
  We model Z[i] as the quotient of the polynomial ring Z[X] by the ideal (X^2 + 1).
  The exercise: let q be a prime with q ≡ 3 (mod 4). Prove that Z[i]/(q) is a field with q^2 elements.

  The statement below translates the assertion into Lean. As requested, the proof is omitted
  and replaced by `by sorry`.
-/

open Polynomial

def Z_i : Type := (Polynomial Int) ⧸ Ideal.span ({X ^ 2 + 1} : Set (Polynomial Int))

/--
The quotient ring Z[i]/(q) is a field of order q^2 when q is a prime ≡ 3 (mod 4).
We state the result for q : ℕ with q.Prime and q % 4 = 3. The ideal (q) is understood
as the ideal of Z[i] generated by the image of q under the canonical map Int → Z[i].
-/
theorem Dummit_Foote_exercise_8_3_6b (q : ℕ) (hq : q.Prime) (hmod : q % 4 = 3) :
  -- the quotient ring Z[i]/(q) is a field
  IsField (Z_i ⧸ Ideal.span ({(q : Z_i)} : Set Z_i)) ∧
  -- it is finite and has q^2 elements
  Fintype (Z_i ⧸ Ideal.span ({(q : Z_i)} : Set Z_i)) ∧
  Fintype.card (Z_i ⧸ Ideal.span ({(q : Z_i)} : Set Z_i)) = q ^ 2 := by sorry
"
Dummit-Foote_exercise_9_1_10,Algebra,success,True,3,"Prove that the ring $\mathbb{Z}\left[x_{1}, x_{2}, x_{3}, \ldots\right] /\left(x_{1} x_{2}, x_{3} x_{4}, x_{5} x_{6}, \ldots\right)$ contains infinitely many minimal prime ideals.","import Mathlib

open MvPolynomial

noncomputable section

/-- The ideal I generated by the products X(2*k) * X(2*k+1) for k : ℕ in the polynomial
ring MvPolynomial ℕ ℤ. -/
def I : Ideal (MvPolynomial ℕ ℤ) :=
  Ideal.span (Set.range fun k : ℕ => MvPolynomial.X (2 * k) * MvPolynomial.X (2 * k + 1))

/-- Exercise: The quotient ring Z[x1,x2,...]/(x1 x2, x3 x4, x5 x6, ...) has infinitely many minimal prime ideals.
We state this as the existence of an infinite family of distinct prime ideals of MvPolynomial ℕ ℤ containing I
and minimal among primes containing I. -/
theorem Dummit_Foote_exercise_9_1_10 :
  ∃ (P : ℕ → Ideal (MvPolynomial ℕ ℤ)),
    (∀ n, Ideal.IsPrime (P n) ∧ I ≤ P n ∧ (∀ Q, Ideal.IsPrime Q → I ≤ Q → Q ≤ P n → Q = P n)) ∧
    Function.Injective P := by sorry

end noncomputable section"
Rudin_exercise_1_1a,Analysis,success,True,3,"If $r$ is rational $(r \neq 0)$ and $x$ is irrational, prove that $r+x$ is irrational.","import Mathlib

/-- If r is rational (r ≠ 0) and x is irrational, prove that r + x is irrational. -/
theorem add_rational_irrational (r x : ℝ) (hr : r ≠ 0) (hx : Irrational x) : Irrational (r + x) := by sorry
"
Rudin_exercise_1_2,Analysis,success,True,3,Prove that there is no rational number whose square is $12$.,"import Mathlib

/-- Rudin, Ch.1, Exercise 1.2:
    There is no rational number whose square is 12. -/
theorem Rudin_exercise_1_2 : ¬ ∃ q : ℚ, q^2 = 12 := by sorry
"
Rudin_exercise_1_11a,Analysis,success,True,2,"If $z$ is a complex number, prove that there exists an $r\geq 0$ and a complex number $w$ with $| w | = 1$ such that $z = rw$.","import Mathlib

theorem Rudin_exercise_1_11a (z : Complex) :
  ∃ (r : ℝ) (w : Complex), 0 ≤ r ∧ Complex.abs w = 1 ∧ z = (r : Complex) * w := by sorry
"
Rudin_exercise_1_13,Analysis,success,True,3,"If $x, y$ are complex, prove that $||x|-|y|| \leq |x-y|$.","import Mathlib
open BigOperators
open Real Nat Topology

/-- If x y are complex, prove that ||x|-|y|| ≤ |x-y|. -/
theorem lean_13_rudin_1_13 (x y : ℂ) : |Complex.abs x - Complex.abs y| ≤ Complex.abs (x - y) := by sorry
"
Rudin_exercise_1_5,Analysis,success,True,3,"Let $A$ be a nonempty set of real numbers which is bounded below. Let $-A$ be the set of all numbers $-x$, where $x \in A$. Prove that $\inf A=-\sup (-A)$.","import Mathlib

open Set

/-- If A is a nonempty set of real numbers which is bounded below, then
    inf A = - sup (-A), where -A = { -x | x ∈ A }. -/
theorem inf_eq_neg_sup_neg {A : Set ℝ} (hne : A.Nonempty) (hbl : BddBelow A) :
  Inf A = -Sup (A.image fun x => -x) := by sorry
"
Dummit-Foote_exercise_9_4_9,Algebra,success,True,3,Prove that the polynomial $x^{2}-\sqrt{2}$ is irreducible over $\mathbb{Z}[\sqrt{2}]$. You may assume that $\mathbb{Z}[\sqrt{2}]$ is a U.F.D.,"import Mathlib

/--
Let Z_sqrt2 denote the ring ℤ[√2] and let `sqrt2` denote the element √2 in Z_sqrt2.
We assume ℤ[√2] is a U.F.D. The polynomial X^2 - sqrt2 is irreducible over ℤ[√2].
-/

constant Z_sqrt2 : Type _
constant sqrt2 : Z_sqrt2

open Polynomial

def f : Polynomial Z_sqrt2 := X ^ 2 - C sqrt2

theorem Dummit_Foote_exercise_9_4_9 : Irreducible (f : Polynomial Z_sqrt2) := by sorry
"
Dummit-Foote_exercise_11_1_13,Algebra,success,True,3,"Prove that as vector spaces over $\mathbb{Q}, \mathbb{R}^n \cong \mathbb{R}$, for all $n \in \mathbb{Z}^{+}$.","import Mathlib

/-- As vector spaces over ℚ, ℝ^n ≃ ℝ for all n ≥ 1. -/
theorem real_pow_eq_real_as_Q_vector_spaces (n : ℕ) (hn : 0 < n) :
  Nonempty (ℝ ≃ₗ[ℚ] (Fin n → ℝ)) := by sorry
"
Rudin_exercise_1_16a,Analysis,success,True,3,"Suppose $k \geq 3, x, y \in \mathbb{R}^k, |x - y| = d > 0$, and $r > 0$. Prove that if $2r > d$, there are infinitely many $z \in \mathbb{R}^k$ such that $|z-x|=|z-y|=r$.","import Mathlib
open Nat hiding log
open Finset Metric Real
open scoped Pointwise

/-- Suppose k ≥ 3, x, y ∈ R^k, |x - y| = d > 0, and r > 0. Prove that if 2r > d, there are infinitely many z ∈ R^k such that |z-x|=|z-y|=r. -/
theorem Rudin_exercise_1_16a {k : ℕ} (hk : 3 ≤ k) (x y : Fin k → ℝ) (hxy : 0 < dist x y) (r : ℝ) (hr : 2 * r > dist x y) : (Set.Infinite { z : Fin k → ℝ | dist z x = r ∧ dist z y = r }) := by sorry
"
Rudin_exercise_1_18a,Analysis,success,True,3,"If $k \geq 2$ and $\mathbf{x} \in R^{k}$, prove that there exists $\mathbf{y} \in R^{k}$ such that $\mathbf{y} \neq 0$ but $\mathbf{x} \cdot \mathbf{y}=0$","import Mathlib

open Finset

/-- Rudin exercise 1.18(a): If k ≥ 2 and x ∈ ℝ^k, then there exists a nonzero y ∈ ℝ^k orthogonal to x.
    We represent ℝ^k as `Fin k → ℝ` and use the dot product defined by the finite sum
    `Finset.univ.sum (fun i => x i * y i)`. -/
theorem Rudin_exercise_1_18a {k : Nat} (hk : 2 ≤ k) (x : Fin k → ℝ) :
  ∃ y : Fin k → ℝ, y ≠ fun _ => 0 ∧ (Finset.univ.sum fun i : Fin k => x i * y i) = 0 := by sorry
"
Rudin_exercise_2_28,Analysis,success,True,3,Prove that every closed set in a separable metric space is the union of a (possibly empty) perfect set and a set which is at most countable.,"import Mathlib

/--
Rudin, Principles of Mathematical Analysis, Exercise 2.28 (translation):
In a separable metric space, every closed set is the union of a (possibly empty)
perfect set and a set which is at most countable.

We formulate ``perfect set'' as a closed set with no isolated points, i.e.
for every x in t we have x ∈ closure (t \ {x}).
-/

theorem Rudin_exercise_2_28 {X : Type _} [MetricSpace X] [SeparableSpace X] {s : Set X}
  (hs : IsClosed s) :
  ∃ (t u : Set X),
    s = t ∪ u ∧
    IsClosed t ∧
    (∀ x, x ∈ t → x ∈ closure (t \ {x})) ∧
    Countable u := by sorry
"
Rudin_exercise_2_24,Analysis,success,True,3,Let $X$ be a metric space in which every infinite subset has a limit point. Prove that $X$ is separable.,"import Mathlib

/--
Let X be a metric space in which every infinite subset has a limit point.
Prove that X is separable.
-/
theorem Rudin_exercise_2_24 {α : Type _} [MetricSpace α]
  (h : ∀ s : Set α, Set.Infinite s → ∃ x : α, ∀ (ε : ℝ), 0 < ε → ∃ y ∈ s, y ≠ x ∧ dist y x < ε) :
  ∃ s : Set α, s.Countable ∧ Dense s := by sorry
"
Rudin_exercise_1_19,Analysis,success,True,3,"Suppose $a, b \in R^k$. Find $c \in R^k$ and $r > 0$ such that $|x-a|=2|x-b|$ if and only if $| x - c | = r$. Prove that $3c = 4b - a$ and $3r = 2 |b - a|$.","import Mathlib

/-!
Problem (Rudin, Principles of Mathematical Analysis, exercise 1.19).
Suppose a, b ∈ ℝ^k. Find c ∈ ℝ^k and r > 0 such that |x - a| = 2 |x - b|
iff |x - c| = r. Prove that 3c = 4b - a and 3r = 2 |b - a|.
-/

open Mathlib

variable {k : ℕ} (a b x : Fin k → ℝ)

-- We model ℝ^k as `Fin k → ℝ` (Euclidean space). We use `EuclideanGeometry` lemmas from mathlib4.

theorem Rudin_exercise_1_19 :
  ∃ (c : Fin k → ℝ) (r : ℝ), r > 0 ∧ (∀ x, dist x a = 2 * dist x b ↔ dist x c = r) := by sorry

-- The values of c and r asserted in the exercise:
lemma Rudin_exercise_1_19_values (c : Fin k → ℝ) (r : ℝ) :
  (3 : ℝ) • c = (4 : ℝ) • b - a ∧ 3 * r = 2 * dist b a := by sorry
"
Rudin_exercise_3_1a,Analysis,success,True,3,Prove that convergence of $\left\{s_{n}\right\}$ implies convergence of $\left\{\left|s_{n}\right|\right\}$.,"import Mathlib

open Filter

/-- If a real sequence s converges to L, then the sequence of absolute values |s_n| converges to |L|. -/
theorem tendsto_abs_of_tendsto {s : ℕ → ℝ} {L : ℝ} (h : Tendsto s atTop (𝓝 L)) :
  Tendsto (fun n => |s n|) atTop (𝓝 |L|) := by sorry
"
Rudin_exercise_2_27a,Analysis,success,True,3,"Suppose $E\subset\mathbb{R}^k$ is uncountable, and let $P$ be the set of condensation points of $E$. Prove that $P$ is perfect.","import Mathlib

variable {k : ℕ}
variable {E : Set (Fin k → ℝ)}

/-- The set of condensation points of E: those x such that every neighborhood of x
    meets E in an uncountable set. -/
def condensation_set : Set (Fin k → ℝ) :=
  { x | ∀ ε, 0 < ε → Set.Uncountable (E ∩ Metric.ball x ε) }

/-- Rudin, Exercise 2.27(a): If E ⊆ ℝ^k is uncountable and P is the set of
    condensation points of E, then P is perfect.  -/
theorem Rudin_exercise_2_27a (hE : Set.Uncountable E) :
  IsClosed (condensation_set : Set (Fin k → ℝ)) ∧ ∀ x ∈ condensation_set, x ∈ closure (condensation_set \ {x}) := by sorry
"
Rudin_exercise_4_2a,Analysis,success,True,3,"If $f$ is a continuous mapping of a metric space $X$ into a metric space $Y$, prove that $f(\overline{E}) \subset \overline{f(E)}$ for every set $E \subset X$. ($\overline{E}$ denotes the closure of $E$).","import Mathlib

/-
If f is a continuous mapping of a metric space X into a metric space Y,
prove that f(closure E) ⊆ closure (f(E)) for every set E ⊆ X.
-/

open Set

variable {X : Type*} {Y : Type*} [MetricSpace X] [MetricSpace Y]

theorem image_closure_subset_closure_image {E : Set X} {f : X → Y} (hf : Continuous f) :
  f '' closure E ⊆ closure (f '' E) :=
by
  -- proof omitted
  sorry
"
Rudin_exercise_3_6a,Analysis,success,True,3,"Prove that $\lim_{n \rightarrow \infty} \sum_{i<n} a_i = \infty$, where $a_i = \sqrt{i + 1} -\sqrt{i}$.","import Mathlib

/-
  Rudin exercise 3.6(a): Let a_i = sqrt(i+1) - sqrt(i). Prove that the partial sums
  sum_{i<n} a_i diverge to +infty.

  We state the result in Lean: the sequence of partial sums tends to at_top in ℝ.
  (Proof omitted.)
-/

theorem Rudin_exercise_3_6a :
  Tendsto (fun n : ℕ => Finset.sum (Finset.range n) fun i => Real.sqrt ((i : ℝ) + 1) - Real.sqrt (i : ℝ))
    atTop (atTop : Filter ℝ) := by sorry
"
Rudin_exercise_3_3,Analysis,success,True,3,"If $s_{1}=\sqrt{2}$, and $s_{n+1}=\sqrt{2+\sqrt{s_{n}}} \quad(n=1,2,3, \ldots),$ prove that $\left\{s_{n}\right\}$ converges, and that $s_{n}<2$ for $n=1,2,3, \ldots$.","import Mathlib

noncomputable section

open Filter

/-- Sequence defined by s₁ = √2 and s_{n+1} = √(2 + √(s_n)) for n ≥ 1. -/
def s : ℕ → ℝ
| 0       => Real.sqrt 2
| 1       => Real.sqrt 2
| (n + 2) => Real.sqrt (2 + Real.sqrt (s (n + 1)))

/-- Rudin exercise: the sequence (s_n) converges and is bounded above by 2. -/
theorem Rudin_exercise_3_3 : ∃ l : ℝ, Tendsto (fun n => s n) atTop (𝓝 l) ∧ ∀ n : ℕ, s n < 2 := by sorry

end noncomputable section"
Rudin_exercise_3_22,Analysis,success,True,3,"Suppose $X$ is a nonempty complete metric space, and $\left\{G_{n}\right\}$ is a sequence of dense open sets of $X$. Prove Baire's theorem, namely, that $\bigcap_{1}^{\infty} G_{n}$ is not empty.","import Mathlib

/-!
Baire category theorem (Rudin, Ex. 3.22).
Suppose X is a nonempty complete metric space, and {G_n} is a sequence of dense open sets of X.
Then ⋂_{n} G_n is nonempty.
-/

theorem baire_category_theorem {X : Type _} [MetricSpace X] [CompleteSpace X] [Nonempty X]
  (G : ℕ → Set X) (hopen : ∀ n, IsOpen (G n)) (hdense : ∀ n, Dense (G n)) :
  Set.Nonempty (⋂ n, G n) := by sorry"
Rudin_exercise_3_8,Analysis,success,True,3,"If $\Sigma a_{n}$ converges, and if $\left\{b_{n}\right\}$ is monotonic and bounded, prove that $\Sigma a_{n} b_{n}$ converges.","import Mathlib

/-- If \sum a_n converges and b_n is monotone and bounded then \sum a_n b_n converges. -/
theorem Rudin_exercise_3_8 (a b : ℕ → ℝ)
  (ha : Summable a)
  (hb_mono : Monotone b)
  (hb_bdd : ∃ M : ℝ, 0 ≤ M ∧ ∀ n, |b n| ≤ M) :
  Summable fun n => a n * b n := by sorry
"
Rudin_exercise_3_20,Analysis,success,True,3,"Suppose $\left\{p_{n}\right\}$ is a Cauchy sequence in a metric space $X$, and some sequence $\left\{p_{n l}\right\}$ converges to a point $p \in X$. Prove that the full sequence $\left\{p_{n}\right\}$ converges to $p$.","import Mathlib

theorem Rudin_exercise_3_20 {X : Type*} [MetricSpace X] {p : ℕ → X}
  (hp : CauchySeq p) {s : ℕ → ℕ} (hs : StrictMono s) {a : X}
  (hsub : Tendsto (p ∘ s) atTop (𝓝 a)) :
  Tendsto p atTop (𝓝 a) := by sorry
"
Rudin_exercise_4_5a,Analysis,success,True,2,"If $f$ is a real continuous function defined on a closed set $E \subset \mathbb{R}$, prove that there exist continuous real functions $g$ on $\mathbb{R}$ such that $g(x)=f(x)$ for all $x \in E$.","/-!
Exercise 4.5(a) (Rudin). If f is a real continuous function defined on a closed set E ⊂ ℝ,
then there exists a continuous real function g on ℝ such that g(x) = f(x) for all x ∈ E.
-/

import Mathlib

open Set

theorem Rudin_exercise_4_5a {E : Set ℝ} (hE : IsClosed E) (f : E → ℝ) (hf : Continuous f) :
  ∃ g : ℝ → ℝ, Continuous g ∧ ∀ x (hx : x ∈ E), g x = f ⟨x, hx⟩ := by
  sorry
"
Rudin_exercise_4_12,Analysis,success,True,3,A uniformly continuous function of a uniformly continuous function is uniformly continuous.,"import Mathlib
open Filter Function Set Uniformity Topology

/-- A uniformly continuous function of a uniformly continuous function is uniformly continuous. -/
theorem uniformContinuous_comp {α β γ : Type*} [UniformSpace α] [UniformSpace β] [UniformSpace γ]
    {f : α → β} {g : β → γ} (hf : UniformContinuous f) (hg : UniformContinuous g) :
    UniformContinuous (g ∘ f) := by sorry
"
Rudin_exercise_4_4a,Analysis,success,True,3,"Let $f$ and $g$ be continuous mappings of a metric space $X$ into a metric space $Y$, and let $E$ be a dense subset of $X$. Prove that $f(E)$ is dense in $f(X)$.","import Mathlib

open Set

variable {X Y : Type*} [MetricSpace X] [MetricSpace Y]
variable (f : X → Y) (E : Set X)

/-- Let f and g be continuous mappings of a metric space X into a metric space Y, and let E be a dense subset of X. Prove that f(E) is dense in f(X). -/
theorem Rudin_exercise_4_4a (hf : Continuous f) (hdense : Dense E) : range f ⊆ closure (f '' E) := by
  sorry
"
Rudin_exercise_4_19,Analysis,success,True,3,"Suppose $f$ is a real function with domain $R^{1}$ which has the intermediate value property: if $f(a)<c<f(b)$, then $f(x)=c$ for some $x$ between $a$ and $b$. Suppose also, for every rational $r$, that the set of all $x$ with $f(x)=r$ is closed. Prove that $f$ is continuous.","import Mathlib

open Set

theorem Rudin_exercise_4_19 (f : ℝ → ℝ)
  (ivp : ∀ a b c, (min (f a) (f b) < c ∧ c < max (f a) (f b)) →
    ∃ x, min a b ≤ x ∧ x ≤ max a b ∧ f x = c)
  (hrat : ∀ (r : ℚ), IsClosed (f ⁻¹' ({r} : Set ℝ))) :
  Continuous f := by sorry
"
Rudin_exercise_4_6,Analysis,success,True,3,"If $f$ is defined on $E$, the graph of $f$ is the set of points $(x, f(x))$, for $x \in E$. In particular, if $E$ is a set of real numbers, and $f$ is real-valued, the graph of $f$ is a subset of the plane. Suppose $E$ is compact, and prove that $f$ is continuous on $E$ if and only if its graph is compact.","import Mathlib

open Set

/--
Suppose E is a compact subset of ℝ and f : E → ℝ. Then f is continuous on E
(i.e. as a function on the subtype E) iff its graph
{ (x, f x) : x ∈ E } = range (λ x : E, (x.1, f x)) is compact.
-/
theorem Rudin_exercise_4_6 {E : Set ℝ} (hE : IsCompact E) (f : E → ℝ) :
  (Continuous f) ↔ IsCompact (Set.range (fun x : E => (x.1, f x))) := by sorry
"
Rudin_exercise_4_24,Analysis,success,True,3,"Assume that $f$ is a continuous real function defined in $(a, b)$ such that $f\left(\frac{x+y}{2}\right) \leq \frac{f(x)+f(y)}{2}$ for all $x, y \in(a, b)$. Prove that $f$ is convex.","import Mathlib

/--
Exercise (Rudin 4.24): Assume that f is a continuous real function defined on the open
interval (a, b) such that f((x+y)/2) ≤ (f(x)+f(y))/2 for all x, y in (a, b).
Show that f is convex on (a, b).
-/
theorem Rudin_exercise_4_24 {a b : ℝ} {f : ℝ → ℝ}
  (hcont : ContinuousOn f (Ioo a b))
  (hmid : ∀ x y, x ∈ Ioo a b → y ∈ Ioo a b → f ((x + y) / 2) ≤ (f x + f y) / 2) :
  ∀ x y, x ∈ Ioo a b → y ∈ Ioo a b → ∀ t ∈ Icc (0 : ℝ) 1,
    f ((1 - t) * x + t * y) ≤ (1 - t) * f x + t * f y := by sorry
"
Rudin_exercise_5_2,Analysis,success,True,3,"Suppose $f^{\prime}(x)>0$ in $(a, b)$. Prove that $f$ is strictly increasing in $(a, b)$, and let $g$ be its inverse function. Prove that $g$ is differentiable, and that $g^{\prime}(f(x))=\frac{1}{f^{\prime}(x)} \quad(a<x<b)$.","import Mathlib

open Set

/-- Suppose f'(x) > 0 on (a, b). Then f is strictly increasing on (a, b). Let g be its inverse. Then g is differentiable on f "" (Ioo a b) and g'(f x) = 1 / f'(x) for a < x < b. -/
theorem Rudin_exercise_5_2 (a b : ℝ) {f : ℝ → ℝ}
  (h : a < b)
  (hd : DifferentiableOn ℝ f (Ioo a b))
  (hpos : ∀ x ∈ Ioo a b, 0 < deriv f x) :
  StrictMonoOn f (Ioo a b) ∧
  ∃ g : ℝ → ℝ,
    (∀ x ∈ Ioo a b, g (f x) = x) ∧
    DifferentiableOn ℝ g (f '' Ioo a b) ∧
    ∀ x ∈ Ioo a b, deriv g (f x) = (deriv f x)⁻¹ := by
  sorry
"
Munkres_exercise_13_1,Topology,success,True,3,Let $X$ be a topological space; let $A$ be a subset of $X$. Suppose that for each $x \in A$ there is an open set $U$ containing $x$ such that $U \subset A$. Show that $A$ is open in $X$.,"import Mathlib
open Set

/-- Let $X$ be a topological space; let $A$ be a subset of $X$. Suppose that for each x ∈ A there is an open set $U$ containing $x$ such that $U ⊆ A$. Show that $A$ is open in $X$. -/
theorem isOpen_of_open_subset_extracted {X : Type*} [TopologicalSpace X] {A : Set X} : (∀ x ∈ A, ∃ U ∈ 𝓝 x, U ⊆ A) → IsOpen A := by sorry
"
Rudin_exercise_4_8b,Analysis,success,True,3,Let $E$ be a bounded set in $R^{1}$. Prove that there exists a real function $f$ such that $f$ is uniformly continuous and is not bounded on $E$.,"import Mathlib

/-!
Corrected version of Rudin Ex. 4.8(b):
If E is bounded but not closed in ℝ, then there exists a real function f which is
continuous on E but not uniformly continuous on E.
-/

theorem Rudin_exercise_4_8b (E : Set ℝ) (h_bdd : Bounded E) (h_nonclosed : ∃ a, a ∈ closure E ∧ a ∉ E) :
  ∃ f : ℝ → ℝ, ContinuousOn f E ∧ ¬UniformContinuousOn f E := by
  sorry
"
Rudin_exercise_5_4,Analysis,success,True,3,"If $C_{0}+\frac{C_{1}}{2}+\cdots+\frac{C_{n-1}}{n}+\frac{C_{n}}{n+1}=0,$ where $C_{0}, \ldots, C_{n}$ are real constants, prove that the equation $C_{0}+C_{1} x+\cdots+C_{n-1} x^{n-1}+C_{n} x^{n}=0$ has at least one real root between 0 and 1.","import Mathlib

/--
If C_0 + C_1/2 + ... + C_n/(n+1) = 0 where C_0,...,C_n are real constants,
then the polynomial C_0 + C_1 x + ... + C_n x^n has at least one real root between 0 and 1.
-/
theorem Rudin_exercise_5_4 {n : ℕ} (C : Fin (n+1) → ℝ)
  (h : ∑ i : Fin (n+1), C i / ((i : ℝ) + 1) = 0) :
  ∃ x : ℝ, 0 < x ∧ x < 1 ∧ (∑ i : Fin (n+1), C i * x ^ (i : ℕ)) = 0 := by sorry
"
Rudin_exercise_5_6,Analysis,success,True,3,"Suppose (a) $f$ is continuous for $x \geq 0$, (b) $f^{\prime}(x)$ exists for $x>0$, (c) $f(0)=0$, (d) $f^{\prime}$ is monotonically increasing. Put $g(x)=\frac{f(x)}{x} \quad(x>0)$ and prove that $g$ is monotonically increasing.","import Mathlib

/-- Rudin Ex. 5.6

Suppose
  (a) f is continuous for x ≥ 0,
  (b) f' exists for x > 0,
  (c) f(0) = 0,
  (d) f' is monotonically increasing on (0, ∞).

Put g(x) = f(x)/x for x > 0 and prove that g is monotonically increasing on (0, ∞).
-/
theorem Rudin_exercise_5_6 {f f' : ℝ → ℝ}
  (h_cont : ContinuousOn f (Ici 0))
  (h_der : ∀ x, 0 < x → HasDerivAt f (f' x) x)
  (h0 : f 0 = 0)
  (h_mono : Monotone f') :
  MonotoneOn (fun x => f x / x) (Ioi 0) := by sorry
"
Munkres_exercise_13_4b1,Topology,success,True,2,Let $\mathcal{T}_\alpha$ be a family of topologies on $X$. Show that there is a unique smallest topology on $X$ containing all the collections $\mathcal{T}_\alpha$.,"import Mathlib

/-!
Let T_α be a family of topologies on X. Show there is a unique smallest topology on X
containing all the collections T_α.
-/

theorem exists_unique_smallest_topology {α : Type _} {X : Type _} (T : α → TopologicalSpace X) :
  ∃! (t0 : TopologicalSpace X), (∀ a, T a ≤ t0) ∧ (∀ t' : TopologicalSpace X, (∀ a, T a ≤ t') → t0 ≤ t') := by sorry
"
Rudin_exercise_5_15,Analysis,success,True,3,"Suppose $a \in R^{1}, f$ is a twice-differentiable real function on $(a, \infty)$, and $M_{0}, M_{1}, M_{2}$ are the least upper bounds of $|f(x)|,\left|f^{\prime}(x)\right|,\left|f^{\prime \prime}(x)\right|$, respectively, on $(a, \infty)$. Prove that $M_{1}^{2} \leq 4 M_{0} M_{2} .$","import Mathlib

open Set

/-- Rudin exercise: Suppose a ∈ ℝ, f is twice-differentiable on (a, ∞), and M0, M1, M2 are upper bounds
of |f|, |f'|, |f''| respectively on (a, ∞). Then M1^2 ≤ 4 M0 M2. -/
theorem Rudin_exercise_5_15 (a : ℝ) (f : ℝ → ℝ) (f' f'' : ℝ → ℝ)
  (hder1 : ∀ x, a < x → HasDerivAt f (f' x) x)
  (hder2 : ∀ x, a < x → HasDerivAt (fun x => f' x) (f'' x) x)
  (M0 M1 M2 : ℝ)
  (hM0 : ∀ x, a < x → abs (f x) ≤ M0)
  (hM1 : ∀ x, a < x → abs (f' x) ≤ M1)
  (hM2 : ∀ x, a < x → abs (f'' x) ≤ M2) :
  M1 ^ 2 ≤ 4 * M0 * M2 := by sorry
"
Munkres_exercise_13_6,Topology,success,True,3,Show that the lower limit topology $\mathbb{R}_l$ and $K$-topology $\mathbb{R}_K$ are not comparable.,"import Mathlib

/-!
Exercise: Show that the lower limit topology ℝ_l and K-topology ℝ_K are not comparable.
We write two topologies on ℝ: the lower limit (or Sorgenfrey) topology generated by
basis {[a,b) | a<b}, and the K-topology which has basis all open intervals (a,b)
and sets of the form (a,b) \ K where K = {1/n | n ∈ ℕ, n > 0}.

We assert that neither topology is finer than the other.
-/

-- We state the theorem informally; a full formal proof is omitted.
theorem lower_limit_and_K_top_not_comparable :
  ¬ (lower_limit_topology ℝ ≤ K_topology ℝ) ∧ ¬ (K_topology ℝ ≤ lower_limit_topology ℝ) := by sorry
"
Munkres_exercise_13_4a1,Topology,success,True,3,"If $\mathcal{T}_\alpha$ is a family of topologies on $X$, show that $\bigcap \mathcal{T}_\alpha$ is a topology on $X$.","import Mathlib

/--
If a family T : ι → TopologicalSpace X is given, the intersection of these topologies
is again a topology on X. We state this by asserting the existence of a topology t whose
open sets are exactly those sets that are open in every T i.
-/

theorem intersection_of_topologies_is_topology {X : Type*} {ι : Sort*} (T : ι → TopologicalSpace X) :
  ∃ (t : TopologicalSpace X), ∀ U, @IsOpen X t U ↔ ∀ i, @IsOpen X (T i) U := by sorry
"
Munkres_exercise_16_4,Topology,success,True,3,"A map $f: X \rightarrow Y$ is said to be an open map if for every open set $U$ of $X$, the set $f(U)$ is open in $Y$. Show that $\pi_{1}: X \times Y \rightarrow X$ and $\pi_{2}: X \times Y \rightarrow Y$ are open maps.","import Mathlib

variable {X Y : Type*} [TopologicalSpace X] [TopologicalSpace Y]

/-- A map f : X → Y is an open map if the image of every open set is open. -/
def is_open_map (f : X → Y) : Prop :=
  ∀ U : Set X, IsOpen U → IsOpen (f '' U)

/-- The first projection π₁ : X × Y → X is an open map. -/
theorem fst_is_open_map : is_open_map (Prod.fst : X × Y → X) := by sorry

/-- The second projection π₂ : X × Y → Y is an open map. -/
theorem snd_is_open_map : is_open_map (Prod.snd : X × Y → Y) := by sorry
"
Munkres_exercise_18_8b,Topology,success,True,3,"Let $Y$ be an ordered set in the order topology. Let $f, g: X \rightarrow Y$ be continuous. Let $h: X \rightarrow Y$ be the function $h(x)=\min \{f(x), g(x)\}.$ Show that $h$ is continuous.","import Mathlib

/-- If Y is an ordered set equipped with the order topology, then the pointwise minimum
of two continuous functions f and g : X → Y is continuous. -/
theorem continuous_min {X Y : Type _} [TopologicalSpace X] [TopologicalSpace Y] [LinearOrder Y]
  [OrderTopology Y] {f g : X → Y} (hf : Continuous f) (hg : Continuous g) :
  Continuous fun x => min (f x) (g x) := by sorry
"
Munkres_exercise_13_5a,Topology,success,True,3,"Show that if $\mathcal{A}$ is a basis for a topology on $X$, then the topology generated by $\mathcal{A}$ equals the intersection of all topologies on $X$ that contain $\mathcal{A}$.","import Mathlib

open Set

variable {X : Type _}

/-- A predicate saying a collection T of subsets of X is a topology. -/
def is_topology (T : Set (Set X)) : Prop :=
  (∅ : Set X) ∈ T ∧ (univ : Set X) ∈ T ∧
  (∀ s t, s ∈ T → t ∈ T → s ∩ t ∈ T) ∧
  (∀ 𝒞 : Set (Set X), (∀ s ∈ 𝒞, s ∈ T) → sUnion 𝒞 ∈ T)

/-- A predicate saying B is a basis for a topology on X. -/
def is_basis (B : Set (Set X)) : Prop :=
  (∀ x : X, ∃ b ∈ B, x ∈ b) ∧
  (∀ b1 ∈ B, ∀ b2 ∈ B, ∀ x ∈ b1 ∩ b2, ∃ b3 ∈ B, x ∈ b3 ∧ b3 ⊆ b1 ∩ b2)

/-- The topology generated by a basis B as the collection of unions of elements of B. -/
def topology_from_basis (B : Set (Set X)) : Set (Set X) :=
  { U | ∃ 𝒞 : Set (Set X), 𝒞 ⊆ B ∧ U = sUnion 𝒞 }

/-- The topology generated by B as the intersection of all topologies containing B. -/
def topology_generated_by_intersection (B : Set (Set X)) : Set (Set X) :=
  sInter { T | is_topology T ∧ B ⊆ T }

/-- Exercise: If B is a basis for a topology on X, then the topology generated by B
    (as unions of basis elements) equals the intersection of all topologies on X that
    contain B. -/
theorem Munkres_exercise_13_5a (B : Set (Set X)) (h : is_basis B) :
  topology_from_basis B = topology_generated_by_intersection B := by sorry
"
Munkres_exercise_17_4,Topology,success,True,3,"Show that if $U$ is open in $X$ and $A$ is closed in $X$, then $U-A$ is open in $X$, and $A-U$ is closed in $X$.","import Mathlib

/-!
# Munkres exercise 17.4

Show that if `U` is open in `X` and `A` is closed in `X`, then `U \ A` is open in `X`, and `A \ U` is closed in `X`.
-/

variable {X : Type _} [TopologicalSpace X]

/-- If `U` is open and `A` is closed then `U \ A` is open. -/
theorem isOpen_diff_of_open_closed {U A : Set X} (hU : IsOpen U) (hA : IsClosed A) : IsOpen (U \ A) := by
  -- `U \ A = U ∩ Aᶜ`, and `A` closed implies `Aᶜ` is open; intersection of opens is open.
  sorry

/-- If `U` is open and `A` is closed then `A \ U` is closed. -/
theorem isClosed_diff_of_open_closed {U A : Set X} (hU : IsOpen U) (hA : IsClosed A) : IsClosed (A \ U) := by
  -- `A \ U = A ∩ Uᶜ`, and `U` open implies `Uᶜ` is closed; intersection of closed sets is closed.
  sorry
"
Munkres_exercise_13_8b,Topology,success,True,3,"Show that the collection $\{(a,b) \mid a < b, a \text{ and } b \text{ rational}\}$ is a basis that generates a topology different from the lower limit topology on $\mathbb{R}$.","import Mathlib

open Set

/-- The collection of open intervals with rational endpoints. -/
def rational_open_interval_basis : Set (Set ℝ) :=
  { I | ∃ a b : ℚ, (a : ℝ) < (b : ℝ) ∧ I = Ioo (a : ℝ) (b : ℝ) }

/-- The usual lower limit basis consisting of half-open intervals [a,b). -/
def lower_limit_basis : Set (Set ℝ) :=
  { I | ∃ a b : ℝ, a < b ∧ I = Ico a b }

/-- The rational open intervals form a basis (for the usual topology). -/
theorem rational_open_intervals_is_basis : IsTopologicalBasis rational_open_interval_basis := by sorry

/-- The topology generated by the rational-open-interval basis is different from the lower limit topology. -/
theorem generated_topology_differs_from_lower_limit :
  TopologicalSpace.generateFrom rational_open_interval_basis ≠ TopologicalSpace.generateFrom lower_limit_basis := by sorry
"
Munkres_exercise_21_6a,Topology,success,True,3,"Define $f_{n}:[0,1] \rightarrow \mathbb{R}$ by the equation $f_{n}(x)=x^{n}$. Show that the sequence $\left(f_{n}(x)\right)$ converges for each $x \in[0,1]$.","import Mathlib

/--
Exercise: Define f_n(x) = x^n on [0,1]. Show (f_n(x)) converges for each x in [0,1].
We state the existence of a limit for each x ∈ [0,1].
-/
theorem Munkres_exercise_21_6a (x : ℝ) (hx : 0 ≤ x) (hx' : x ≤ 1) :
  ∃ L : ℝ, Tendsto (fun n : ℕ => x ^ n) atTop (nhds L) := by
  sorry
"
Munkres_exercise_23_2,Topology,success,True,2,"Let $\left\{A_{n}\right\}$ be a sequence of connected subspaces of $X$, such that $A_{n} \cap A_{n+1} \neq \varnothing$ for all $n$. Show that $\bigcup A_{n}$ is connected.","import Mathlib

variable {X : Type _} [TopologicalSpace X]
variable (A : ℕ → Set X)

theorem Munkres_exercise_23_2 (h_conn : ∀ n, IsConnected (A n)) (h_nz : ∀ n, ∃ x, x ∈ A n ∧ x ∈ A (n+1)) :
  IsConnected (⋃ n, A n) := by sorry
"
Munkres_exercise_19_6a,Topology,success,True,3,"Let $\mathbf{x}_1, \mathbf{x}_2, \ldots$ be a sequence of the points of the product space $\prod X_\alpha$.  Show that this sequence converges to the point $\mathbf{x}$ if and only if the sequence $\pi_\alpha(\mathbf{x}_i)$ converges to $\pi_\alpha(\mathbf{x})$ for each $\alpha$.","import Mathlib

open Filter Topology

variable {ι : Type*} {β : ι → Type*} [∀ i, TopologicalSpace (β i)]

/-- Let x₁, x₂, ... be a sequence in the product space Π β i. The sequence f : ℕ → Π β i tends to x iff for each i the coordinate sequence tends to x i. -/
theorem sequence_tendsto_pi_iff {f : ℕ → ∀ i, β i} {x : ∀ i, β i} :
  Tendsto f atTop (𝓝 x) ↔ ∀ i, Tendsto (fun n => (f n) i) atTop (𝓝 (x i)) := by sorry
"
Munkres_exercise_21_8,Topology,success,True,3,"Let $X$ be a topological space and let $Y$ be a metric space. Let $f_{n}: X \rightarrow Y$ be a sequence of continuous functions. Let $x_{n}$ be a sequence of points of $X$ converging to $x$. Show that if the sequence $\left(f_{n}\right)$ converges uniformly to $f$, then $\left(f_{n}\left(x_{n}\right)\right)$ converges to $f(x)$.","import Mathlib

open Filter

variable {X : Type*} [TopologicalSpace X]
variable {Y : Type*} [MetricSpace Y]

variable (f_seq : ℕ → X → Y) (f : X → Y) (x_seq : ℕ → X) (x : X)

/-- Each f_n is continuous. -/
def continuous_seq := ∀ n, Continuous (f_seq n)

/-- The sequence x_n converges to x. -/
def seq_converges := Tendsto x_seq atTop (𝓝 x)

/-- f_n converges uniformly to f. -/
def uniform_conv := ∀ ε : ℝ, 0 < ε → ∃ N, ∀ n ≥ N, ∀ t : X, dist (f_seq n t) (f t) < ε

/-- Exercise (Munkres 21.8): If f_n are continuous, x_n → x, and f_n → f uniformly,
    then f_n(x_n) → f(x). -/
theorem Munkres_exercise_21_8 (hcont : continuous_seq f_seq) (hx : seq_converges x_seq x) (huni : uniform_conv f_seq f) :
  Tendsto (fun n => f_seq n (x_seq n)) atTop (𝓝 (f x)) := by sorry
"
Munkres_exercise_22_2b,Topology,success,True,3,"If $A \subset X$, a retraction of $X$ onto $A$ is a continuous map $r: X \rightarrow A$ such that $r(a)=a$ for each $a \in A$. Show that a retraction is a quotient map.","import Mathlib

/-- If A ⊆ X, a retraction r : X → A is a continuous map with r(a) = a for all a ∈ A.
    We show that such a retraction is a quotient map, i.e. a set U ⊆ A is open iff r⁻¹(U) is open in X. -/
theorem retraction_is_quotient {X : Type*} [TopologicalSpace X] {A : Set X}
  (r : X → A) (hr : Continuous r) (hretract : ∀ a : A, r a = a) :
  ∀ U : Set A, IsOpen U ↔ IsOpen (r ⁻¹' U) := by sorry
"
Munkres_exercise_23_4,Topology,success,True,3,"Show that if $X$ is an infinite set, it is connected in the finite complement topology.","import Mathlib

open Set

/-- A topological space has the finite-complement (cofinite) topology if exactly the empty set
    and the sets with finite complement are open. -/
def finite_complement_topology {X : Type*} (t : TopologicalSpace X) : Prop :=
  ∀ U : Set X, TopologicalSpace.IsOpen t U ↔ (U = ∅ ∨ (Uᶜ).Finite)

/-- If X is infinite and carries the finite-complement topology, then X is connected. -/
theorem infinite_set_connected_in_finite_complement_topology {X : Type*}
  (t : TopologicalSpace X) (hX : Infinite X) (ht : finite_complement_topology t) :
  ConnectedSpace X := by sorry
"
Munkres_exercise_23_9,Topology,success,True,3,"Let $A$ be a proper subset of $X$, and let $B$ be a proper subset of $Y$. If $X$ and $Y$ are connected, show that $(X \times Y)-(A \times B)$ is connected.","import Mathlib

variables {X Y : Type*} [TopologicalSpace X] [TopologicalSpace Y]
variable {A : Set X} {B : Set Y}

/-- Exercise (Munkres 23.9): Let A be a proper subset of X, and B a proper subset of Y.
    If X and Y are connected, then (X × Y) \ (A × B) is connected. -/
theorem Munkres_exercise_23_9 (hA : A ≠ (univ : Set X)) (hB : B ≠ (univ : Set Y))
  (hX : ConnectedSpace X) (hY : ConnectedSpace Y) :
  IsConnected ((univ : Set (X × Y)) \ (A ×ˢ B)) := by sorry
"
Munkres_exercise_25_4,Topology,success,True,3,Let $X$ be locally path connected. Show that every connected open set in $X$ is path connected.,"import Mathlib
open Topology Set

/-- Let X be locally path connected. Show that every connected open set in X is path connected. -/
theorem isPathConnected_of_isConnected_open_extracted {X : Type*} [TopologicalSpace X] [LocPathConnectedSpace X] {s : Set X} :
  IsConnected s → IsOpen s → IsPathConnected s := by sorry
"
Munkres_exercise_24_2,Topology,success,True,3,Let $f: S^{1} \rightarrow \mathbb{R}$ be a continuous map. Show there exists a point $x$ of $S^{1}$ such that $f(x)=f(-x)$.,"import Mathlib

/- This is a translation of the statement:
   Let f : S¹ → ℝ be a continuous map. Show there exists x ∈ S¹ such that f x = f (-x).
   We represent S¹ as the unit circle in ℝ²: {x : ℝ × ℝ | x.1^2 + x.2^2 = 1}.
-/

open Set

/-- There exists x on the unit circle S¹ with f x = f (-x). -/
theorem exists_antipodal_eq {f : {x : ℝ × ℝ // x.1 ^ 2 + x.2 ^ 2 = 1} → ℝ}
  (hf : Continuous f) : ∃ x, f x = f (-x) := by sorry
"
Munkres_exercise_26_11,Topology,success,True,3,Let $X$ be a compact Hausdorff space. Let $\mathcal{A}$ be a collection of closed connected subsets of $X$ that is simply ordered by proper inclusion. Then $Y=\bigcap_{A \in \mathcal{A}} A$ is connected.,"import Mathlib

/-!
Exercise: Let X be a compact Hausdorff space. Let A be a collection of closed connected subsets of X
that is simply ordered by proper inclusion. Then Y = ⋂_{A ∈ A} A is connected.
-/

open Set

theorem Munkres_exercise_26_11 {X : Type*} [TopologicalSpace X] [CompactSpace X] [T2Space X]
  (A : Set (Set X))
  (h_nonempty : A.Nonempty)
  (h_closed : ∀ S ∈ A, IsClosed (S : Set X))
  (h_connected : ∀ S ∈ A, IsPreconnected (S : Set X))
  (h_total_order : ∀ S T ∈ A, S ⊂ T ∨ T ⊂ S) :
  IsPreconnected (⋂₀ A) := by sorry
"
Munkres_exercise_27_4,Topology,success,True,3,Show that a connected metric space having more than one point is uncountable.,"import Mathlib

/-- A connected metric space with more than one point is uncountable. -/
theorem connected_metric_space_uncountable {α : Type _} [MetricSpace α] [ConnectedSpace α]
  (hne : ∃ x y : α, x ≠ y) : ¬ Set.Countable (univ : Set α) := by sorry
"
Munkres_exercise_29_1,Topology,success,True,3,Show that the rationals $\mathbb{Q}$ are not locally compact.,"import Mathlib

/-- The rationals (as a subspace of ℝ) are not locally compact. -/
theorem not_locally_compact_Rat : ¬LocallyCompactSpace Rat := by sorry
"
Munkres_exercise_30_13,Topology,success,True,3,"Show that if $X$ has a countable dense subset, every collection of disjoint open sets in $X$ is countable.","import Mathlib
open Set Filter Function Topology

/-- Show that if $X$ has a countable dense subset, every collection of disjoint open sets in $X$ is countable. -/
theorem example_countable_disjoint {X : Type*} [TopologicalSpace X] :
  (∃ S : Set X, S.Countable ∧ closure S = (univ : Set X)) →
  ∀ (C : Set (Set X)), (∀ U ∈ C, IsOpen U ∧ U ≠ (∅ : Set X)) →
    (∀ U V ∈ C, U ≠ V → Disjoint U V) → C.Countable := by sorry
"
Munkres_exercise_29_10,Topology,success,True,3,"Show that if $X$ is a Hausdorff space that is locally compact at the point $x$, then for each neighborhood $U$ of $x$, there is a neighborhood $V$ of $x$ such that $\bar{V}$ is compact and $\bar{V} \subset U$.","import Mathlib

/-!
Exercise: Show that if X is a Hausdorff space that is locally compact at the point x,
then for each neighborhood U of x, there is a neighborhood V of x such that
closure V is compact and closure V ⊆ U.

We state a version where ""locally compact at x"" is expressed by the existence of a
compact set K with x in its interior. We express ""neighborhood of x"" by `x ∈ interior U`.
-/

open Set

variable {X : Type _} [TopologicalSpace X]

theorem Munkres_exercise_29_10 (x : X) (hT2 : T2Space X)
  (hloc : ∃ K : Set X, IsCompact K ∧ x ∈ interior K) :
  ∀ U : Set X, x ∈ interior U → ∃ V : Set X, x ∈ interior V ∧ IsCompact (closure V) ∧ closure V ⊆ U := by sorry
"
Munkres_exercise_31_2,Topology,success,True,3,"Show that if $X$ is normal, every pair of disjoint closed sets have neighborhoods whose closures are disjoint.","import Mathlib
open Set Filter Topology TopologicalSpace

/-- Show that if $X$ is normal, every pair of disjoint closed sets have neighborhoods whose closures are disjoint. -/
theorem exists_disjoint_nhds_of_closed (X : Type*) [TopologicalSpace X] [NormalSpace X] {A B : Set X}
    (hA : IsClosed A) (hB : IsClosed B) (hd : Disjoint A B) :
    ∃ U V : Set X, IsOpen U ∧ IsOpen V ∧ A ⊆ U ∧ B ⊆ V ∧ Disjoint (closure U) (closure V) := by sorry
"
Munkres_exercise_32_2b,Topology,success,True,3,"Show that if $\prod X_\alpha$ is regular, then so is $X_\alpha$. Assume that each $X_\alpha$ is nonempty.","import Mathlib

open Topology

variable {ι : Type*} {X : ι → Type*} [∀ i, TopologicalSpace (X i)] [∀ i, Nonempty (X i)]

/-- If the product Π X_α is regular, then each factor X_α is regular. -/
theorem Munkres_exercise_32_2b : RegularSpace (∀ i, X i) → ∀ i, RegularSpace (X i) := by sorry
"
Munkres_exercise_32_3,Topology,success,True,3,Show that every locally compact Hausdorff space is regular.,"import Mathlib
open Set Filter Topology TopologicalSpace

/-- Show that every locally compact Hausdorff space is regular. -/
theorem regular_of_locallyCompact_hausdorff {X : Type*} [TopologicalSpace X]
    [LocallyCompactSpace X] [T2Space X] : RegularSpace X := by sorry
"
Munkres_exercise_32_1,Topology,success,True,3,Show that a closed subspace of a normal space is normal.,"import Mathlib

/-!
Munkres exercise 32.1: A closed subspace of a normal space is normal.
-/

theorem closed_subspace_of_normal {X : Type*} [TopologicalSpace X] [NormalSpace X]
  {s : Set X} (hs : IsClosed s) : NormalSpace (Subtype s) := by sorry
"
Munkres_exercise_38_6,Topology,success,True,3,Let $X$ be completely regular. Show that $X$ is connected if and only if the Stone-Čech compactification of $X$ is connected.,"import Mathlib

/-- Let $X$ be completely regular. Show that $X$ is connected if and only if the Stone-Čech compactification of $X$ is connected. -/
theorem connectedSpace_iff_connectedSpace_StoneCech (X : Type*) [TopologicalSpace X]
    [CompletelyRegularSpace X] : ConnectedSpace X ↔ ConnectedSpace (StoneCech X) := by sorry
"
Munkres_exercise_33_8,Topology,success,True,3,"Let $X$ be completely regular, let $A$ and $B$ be disjoint closed subsets of $X$. Show that if $A$ is compact, there is a continuous function $f \colon X \rightarrow [0, 1]$ such that $f(A) = \{0\}$ and $f(B) = \{1\}$.","import Mathlib
open Topology Filter unitInterval Set Function
open TopologicalSpace

/-- Let X be completely regular, let A and B be disjoint closed subsets of X. Show that if A is compact, there is a continuous function f \colon X \rightarrow [0, 1] such that f(A) = \{0\} and f(B) = \{1\}. -/
theorem exists_continuous_forall_eq_zero_of_closed_of_compact {X : Type*} [TopologicalSpace X]
    [CompletelyRegularSpace X] {A B : Set X} (hA : IsClosed A) (hB : IsClosed B) (hAB : Disjoint A B)
    (hA' : IsCompact A) :
    ∃ f : C(X, ℝ), ∀ x ∈ A, f x = 0 ∧ ∀ x ∈ B, f x = 1 := by sorry
"
Axler_exercise_1_3,Algebra,success,True,3,Prove that $-(-v) = v$ for every $v \in V$.,"import Mathlib

/-! # Axler Exercise 1.3

Prove that -(-v) = v for every v in V.
-/

variable {V : Type*} [AddGroup V]

/-- Double negation in an additive group: -(-v) = v. -/
theorem neg_neg (v : V) : - -v = v := by sorry
"
Munkres_exercise_28_5,Topology,success,True,3,Show that X is countably compact if and only if every nested sequence $C_1 \supset C_2 \supset \cdots$ of closed nonempty sets of X has a nonempty intersection.,"import Mathlib

open Set

variable (X : Type*) [TopologicalSpace X]

/-- A space is countably compact if every countable open cover has a finite subcover. -/
def CountablyCompactSpace : Prop :=
  ∀ (ι : Type*) (U : ι → Set X),
    Countable ι → (∀ i, IsOpen (U i)) → (⋃ i, U i) = univ → ∃ t : Finset ι, (⋃ i ∈ t, U i) = univ

/-- X is countably compact iff every nested sequence of nonempty closed sets has nonempty intersection. -/
theorem countably_compact_iff_nested_closed :
  CountablyCompactSpace X ↔
    (∀ (C : ℕ → Set X),
      (∀ n, IsClosed (C n)) →
      (∀ n, C (n+1) ⊆ C n) →
      (∀ n, C n ≠ ∅) →
      (⋂ n, C n) ≠ ∅) := by sorry
"
Axler_exercise_3_1,Algebra,success,True,3,"Show that every linear map from a one-dimensional vector space to itself is multiplication by some scalar. More precisely, prove that if $\operatorname{dim} V=1$ and $T \in \mathcal{L}(V, V)$, then there exists $a \in \mathbf{F}$ such that $T v=a v$ for all $v \in V$.","import Mathlib

variables {𝕜 : Type*} [Field 𝕜] {V : Type*} [AddCommGroup V] [Module 𝕜 V]

/--
Exercise: Show that every linear map from a one-dimensional vector space to itself
is multiplication by some scalar.
We assume the 1-dimensionality by the existence of a nonzero vector v0 such that
every vector is a scalar multiple of v0.
-/
theorem Axler_exercise_3_1
  (h : ∃ (v0 : V), v0 ≠ 0 ∧ ∀ v : V, ∃ a : 𝕜, v = a • v0)
  (T : V →ₗ[𝕜] V) :
  ∃ a : 𝕜, ∀ v : V, T v = a • v := by sorry
"
Axler_exercise_1_8,Algebra,success,True,3,Prove that the intersection of any collection of subspaces of $V$ is a subspace of $V$.,"import Mathlib

/-!
Exercise: Prove that the intersection of any collection of subspaces of V is a subspace of V.
We state this in the language of mathlib as: for a field K and K-module V, for any set S of
submodules of V there exists a submodule whose underlying set equals the intersection of the
underlying sets of the submodules in S. The proof is omitted (:= by sorry) as requested.
-/

variable {K : Type*} [Field K]
variable {V : Type*} [AddCommGroup V] [Module K V]

theorem intersection_of_subspaces_is_subspace (S : Set (Submodule K V)) :
  ∃ W : Submodule K V, (W : Set V) = ⋂ s ∈ S, (s : Set V) := by sorry
"
Axler_exercise_4_4,Algebra,success,True,3,Suppose $p \in \mathcal{P}(\mathbf{C})$ has degree $m$. Prove that $p$ has $m$ distinct roots if and only if $p$ and its derivative $p^{\prime}$ have no roots in common.,"import Mathlib
open Polynomial

/-- Suppose p ∈ P(ℂ) has degree m. Prove that p has m distinct roots if and only if p and its derivative p' have no roots in common. -/
theorem Axler_exercise_4_4 {p : Polynomial ℂ} {m : ℕ} (hdeg : p.natDegree = m) :
  (∃ xs : Fin m → ℂ, Function.Injective xs ∧ p = C p.leadingCoeff * ∏ i, (X - C (xs i))) ↔
  (∀ z, p.eval z = 0 → p.derivative.eval z ≠ 0) := by sorry
"
Axler_exercise_5_12,Algebra,success,True,3,Suppose $T \in \mathcal{L}(V)$ is such that every vector in $V$ is an eigenvector of $T$. Prove that $T$ is a scalar multiple of the identity operator.,"import Mathlib

/-!
Exercise (Axler 5.12) - Suppose T ∈ L(V) is such that every vector in V is an eigenvector of T.
Prove that T is a scalar multiple of the identity operator.
-/

variable {K : Type*} [Field K]
variable {V : Type*} [AddCommGroup V] [Module K V]

open LinearMap

theorem Axler_exercise_5_12 (T : V →ₗ[K] V)
  (h : ∀ v : V, ∃ λ : K, T v = λ • v) : ∃ c : K, T = c • LinearMap.id := by sorry
"
Axler_exercise_5_4,Algebra,success,True,3,"Suppose that $S, T \in \mathcal{L}(V)$ are such that $S T=T S$. Prove that $\operatorname{null} (T-\lambda I)$ is invariant under $S$ for every $\lambda \in \mathbf{F}$.","import Mathlib

variable {F : Type _} [Field F]
variable {V : Type _} [AddCommGroup V] [Module F V]

/--
Suppose that S, T ∈ L(V) are such that S T = T S. Prove that null(T - λ I) is invariant under S for every λ ∈ F.
This states that if v ∈ ker (T - λ I) then S v ∈ ker (T - λ I).
-/
theorem Axler_exercise_5_4 (S T : V →ₗ[F] V) (h : S.comp T = T.comp S) (λ : F) :
  ∀ v, (T - λ • LinearMap.id) v = 0 → (T - λ • LinearMap.id) (S v) = 0 := by
  -- proof omitted
  sorry
"
Axler_exercise_1_6,Algebra,success,True,3,"Give an example of a nonempty subset $U$ of $\mathbf{R}^2$ such that $U$ is closed under addition and under taking additive inverses (meaning $-u \in U$ whenever $u \in U$), but $U$ is not a subspace of $\mathbf{R}^2$.","import Mathlib

/-- Example subset U of R^2: all pairs (n,0) with n an integer -/
def U : Set (ℝ × ℝ) := { v | v.2 = 0 ∧ ∃ n : Int, v.1 = n }

/-- U is nonempty. -/
theorem U_nonempty : U.Nonempty := by sorry

/-- U is closed under addition. -/
theorem U_add_closed : ∀ x y : ℝ × ℝ, x ∈ U → y ∈ U → x + y ∈ U := by sorry

/-- U is closed under additive inverses. -/
theorem U_neg_closed : ∀ x : ℝ × ℝ, x ∈ U → -x ∈ U := by sorry

/-- U is not closed under scalar multiplication, hence not a subspace of ℝ^2. -/
theorem U_not_closed_smul : ∃ (c : ℝ) (x : ℝ × ℝ), x ∈ U ∧ c • x ∉ U := by sorry
"
Axler_exercise_6_7,Algebra,success,True,3,"Prove that if $V$ is a complex inner-product space, then $\langle u, v\rangle=\frac{\|u+v\|^{2}-\|u-v\|^{2}+\|u+i v\|^{2} i-\|u-i v\|^{2} i}{4}$ for all $u, v \in V$.","import Mathlib

/-- Prove that if $V$ is a complex inner-product space, then $\langle u, v\rangle=\frac{\|u+v\|^{2}-\|u-v\|^{2}+\|u+i v\|^{2} i-\|u-i v\|^{2} i}{4}$ for all $u, v \in V$. -/
theorem inner_eq_of_norm_sq_extracted {V : Type*} [NormedAddCommGroup V] [InnerProductSpace ℂ V] (u v : V) :
  ⟪u, v⟫ = ((‖u + v‖ ^ 2 - ‖u - v‖ ^ 2 + ‖u + Complex.I • v‖ ^ 2 * Complex.I - ‖u - Complex.I • v‖ ^ 2 * Complex.I) / 4) := by sorry
"
Axler_exercise_6_2,Algebra,success,True,3,"Suppose $u, v \in V$. Prove that $\langle u, v\rangle=0$ if and only if $\|u\| \leq\|u+a v\|$ for all $a \in \mathbf{F}$.","import Mathlib

/-- Axler, Linear Algebra Done Right, Exercise 6.2:
    Let E be an inner product space over 𝕜 (ℝ or ℂ). For u, v ∈ E,
    inner u v = 0 iff ‖u‖ ≤ ‖u + a • v‖ for all scalars a. -/
theorem Axler_exercise_6_2 {𝕜 : Type*} [IsROrC 𝕜] {E : Type*} [InnerProductSpace 𝕜 E] {u v : E} :
  inner u v = 0 ↔ ∀ a : 𝕜, ‖u‖ ≤ ‖u + a • v‖ := by
  sorry
"
Axler_exercise_5_20,Algebra,success,True,3,Suppose that $T \in \mathcal{L}(V)$ has $\operatorname{dim} V$ distinct eigenvalues and that $S \in \mathcal{L}(V)$ has the same eigenvectors as $T$ (not necessarily with the same eigenvalues). Prove that $S T=T S$.,"import Mathlib

open LinearMap

variable {K : Type*} [Field K]
variable {V : Type*} [AddCommGroup V] [Module K V] [FiniteDimensional K V]

/--
Suppose T has a basis b of eigenvectors with eigenvalues eigT, and S acts diagonally on the same basis with eigenvalues eigS.
Then S and T commute (they are simultaneously diagonal in the basis b).
-/
theorem Axler_exercise_5_20 (T S : V →ₗ[K] V)
  (b : Fin (finrank K V) → V) (hb : IsBasis K b)
  (eigT eigS : Fin (finrank K V) → K)
  (hT : ∀ i, T (b i) = eigT i • b i)
  (hS : ∀ i, S (b i) = eigS i • b i) :
  S.comp T = T.comp S := by sorry
"
Axler_exercise_6_16,Algebra,success,True,3,Suppose $U$ is a subspace of $V$. Prove that $U^{\perp}=\{0\}$ if and only if $U=V$,"import Mathlib

/-- Suppose U is a subspace of V. Prove that U^⊥ = {0} iff U = V. -/
theorem Axler_exercise_6_16 {K : Type*} [IsROrC K] {V : Type*} [InnerProductSpace K V]
  [FiniteDimensional K V] (U : Submodule K V) :
  Uᗮ = ⊥ ↔ U = ⊤ := by sorry
"
Ireland-Rosen_exercise_1_27,Number Theory,success,True,3,For all odd $n$ show that $8 \mid n^{2}-1$.,"import Mathlib

/-- For all odd n show that 8 | n^2 - 1. -/
theorem Ireland_Rosen_exercise_1_27 (n : ℤ) (h : n % 2 = 1) : 8 ∣ n^2 - 1 := by sorry
"
Axler_exercise_7_6,Algebra,success,True,3,"Prove that if $T \in \mathcal{L}(V)$ is normal, then $\operatorname{range} T=\operatorname{range} T^{*}.$","import Mathlib

variable {V : Type _} [InnerProductSpace ℂ V] [FiniteDimensional ℂ V]

open LinearMap

theorem Axler_exercise_7_6 (T : V →ₗ[ℂ] V) (h_normal : T.comp T.adjoint = T.adjoint.comp T) :
  LinearMap.range T = LinearMap.range T.adjoint := by sorry
"
Ireland-Rosen_exercise_1_31,Number Theory,success,True,3,Show that 2 is divisible by $(1+i)^{2}$ in $\mathbb{Z}[i]$.,"import Mathlib


/-- Show that 2 is divisible by $(1+i)^{2}$ in $\mathbb{Z}[i]$. Save it to: Ireland-Rosen_exercise_1_31.lean -/
theorem two_dvd_one_add_I_sq : 2 ∣ (1 + I) ^ 2 := by sorry
"
Axler_exercise_7_10,Algebra,success,True,3,Suppose $V$ is a complex inner-product space and $T \in \mathcal{L}(V)$ is a normal operator such that $T^{9}=T^{8}$. Prove that $T$ is self-adjoint and $T^{2}=T$.,"import Mathlib

/-
Suppose V is a complex inner-product space and T ∈ L(V) is a normal operator
such that T^9 = T^8. Prove that T is self-adjoint and T^2 = T.
-/

theorem Axler_exercise_7_10 {V : Type*} [InnerProductSpace ℂ V] {T : V →ₗ[ℂ] V}
  (h_normal : IsNormal T) (h : T ^ 9 = T ^ 8) :
  IsSelfAdjoint T ∧ T ^ 2 = T := by sorry
"
Axler_exercise_7_14,Algebra,success,True,3,"Suppose $T \in \mathcal{L}(V)$ is self-adjoint, $\lambda \in \mathbf{F}$, and $\epsilon>0$. Prove that if there exists $v \in V$ such that $\|v\|=1$ and $\|T v-\lambda v\|<\epsilon,$ then $T$ has an eigenvalue $\lambda^{\prime}$ such that $\left|\lambda-\lambda^{\prime}\right|<\epsilon$.","import Mathlib

/-!
Exercise 7.14 (Axler). Suppose T : L(V) is self-adjoint, λ ∈ 𝔽, and ε > 0.
Prove that if there exists v ∈ V with ∥v∥ = 1 and ∥T v - λ v∥ < ε,
then T has an eigenvalue λ' with |λ - λ'| < ε.
-/

-- We only state the result; proof omitted (exercise)
variable {V : Type*} [NormedAddCommGroup V] [InnerProductSpace ℝ V] [FiniteDimensional ℝ V]

open InnerProductSpace
open LinearMap

theorem axler_exercise_7_14 {T : V →ₗ[ℝ] V} (selfadj : ∀ x y, ⟪T x, y⟫ = ⟪x, T y⟫)
  {λ : ℝ} {ε : ℝ} (hε : ε > 0)
  (hexists : ∃ v : V, ∥v∥ = 1 ∧ ∥T v - λ • v∥ < ε) : ∃ λ' : ℝ, ∃ (w : V), (w ≠ 0) ∧ (T w = λ' • w) ∧ |λ - λ'| < ε := by sorry
"
Ireland-Rosen_exercise_3_1,Number Theory,success,True,3,Show that there are infinitely many primes congruent to $-1$ modulo 6 .,"import Mathlib

/-!
Exercise: Show that there are infinitely many primes congruent to -1 modulo 6.
This file states the result; the proof is omitted (`by sorry`).
-/-

theorem infinitely_many_primes_congruent_neg_one_mod_six :
  ∀ N : ℕ, ∃ p : ℕ, p > N ∧ Prime p ∧ p % 6 = 5 := by sorry
"
Ireland-Rosen_exercise_3_5,Number Theory,success,True,3,Show that the equation $7 x^{3}+2=y^{3}$ has no solution in integers.,"import Mathlib

/-
Ireland & Rosen, Exercise 3.5:
Show that the Diophantine equation 7 * x^3 + 2 = y^3 has no solution in integers.
-/

theorem Ireland_Rosen_exercise_3_5 : ¬ ∃ (x y : ℤ), 7 * x ^ 3 + 2 = y ^ 3 := by sorry
"
Ireland-Rosen_exercise_2_21,Number Theory,success,True,3,Define $\wedge(n)=\log p$ if $n$ is a power of $p$ and zero otherwise. Prove that $\sum_{A \mid n} \mu(n / d) \log d$ $=\wedge(n)$.,"import Mathlib
open Finset Nat
open scoped ArithmeticFunction

/-- Define $\wedge(n)=\log p$ if $n$ is a power of $p$ and zero otherwise. Prove that $\sum_{d \mid n} \mu(n / d) \log d = \wedge(n)$. -/
theorem sum_moebius_mul_log_eq_self_at {n : ℕ} (hn : n ≠ 0) :
  (∑ d in n.divisors, μ (n / d) * Real.log d) = if n.isPrimePow then Real.log n.minFac else 0 := by sorry
"
Ireland-Rosen_exercise_3_14,Number Theory,success,True,3,"Let $p$ and $q$ be distinct odd primes such that $p-1$ divides $q-1$. If $(n, p q)=1$, show that $n^{q-1} \equiv 1(p q)$.","import Mathlib
open BigOperators
open Real Nat Topology


/-- Let $p$ and $q$ be distinct odd primes such that $p-1$ divides $q-1$. If $(n, p q)=1$, show that $n^{q-1} \equiv 1(p q)$. Save it to: Ireland-Rosen_exercise_3_14.lean -/
theorem Ireland_Rosen_exercise_3_14 (p q n : ℕ) (hp : p.Prime) (hq : q.Prime) (hpq : p ≠ q) (h : p - 1 ∣ q - 1) (h2 : (n : ZMod (p * q)) ≠ 0) : n ^ (q - 1) ≡ 1 [ZMOD p * q]  :=  by sorry
"
Ireland-Rosen_exercise_4_5,Number Theory,success,True,3,Consider a prime $p$ of the form $4 t+3$. Show that $a$ is a primitive root modulo $p$ iff $-a$ has order $(p-1) / 2$.,"import Mathlib

open ZMod

/--
Exercise (Ireland–Rosen, 4.5).
Let p be a prime of the form 4*t+3. Show that a is a primitive root modulo p iff -a has order (p-1)/2.
This file records the statement; the proof is omitted.
-/

theorem Ireland_Rosen_exercise_4_5 {p : Nat} (hp : p.Prime) (hmod4 : p % 4 = 3) {a : (ZMod p)ˣ} :
  (OrderOf a = p - 1) ↔ (OrderOf (-a : (ZMod p)ˣ) = (p - 1) / 2) := by
  sorry
"
Ireland-Rosen_exercise_4_8,Number Theory,success,True,3,Let $p$ be an odd prime. Show that $a$ is a primitive root modulo $p$ iff $a^{(p-1) / q} \not \equiv 1(p)$ for all prime divisors $q$ of $p-1$.,"import Mathlib

/-- Define what it means to be a primitive root modulo a prime p: the element has order p-1. -/
def is_primitive_root_mod {p : ℕ} (hp : p.Prime) (a : ZMod p) : Prop :=
  a ^ (p - 1) = 1 ∧ ∀ d, d ∣ (p - 1) → d < p - 1 → a ^ d ≠ 1

/-- Ireland-Rosen Exercise 4.8:
    Let p be an odd prime. Show that a is a primitive root modulo p iff
    a^{(p-1)/q} ≠ 1 (mod p) for all prime divisors q of p-1. -/
theorem ireland_rosen_exercise_4_8 {p : ℕ} (hp : p.Prime) (hp_odd : p ≠ 2) (a : ZMod p) :
  is_primitive_root_mod hp a ↔ ∀ q : ℕ, q.Prime → q ∣ (p - 1) → a ^ ((p - 1) / q) ≠ 1 := by sorry
"
Ireland-Rosen_exercise_18_4,Number Theory,success,True,3,Show that 1729 is the smallest positive integer expressible as the sum of two different integral cubes in two ways.,"import Mathlib

theorem Ireland_Rosen_exercise_18_4 :
  (∃ a b c d : ℕ,
    a ^ 3 + b ^ 3 = 1729 ∧ c ^ 3 + d ^ 3 = 1729 ∧ a ≠ b ∧ c ≠ d ∧ ((a, b) ≠ (c, d) ∧ (a, b) ≠ (d, c))) ∧
  ∀ n : ℕ, (∃ a b c d : ℕ,
    a ^ 3 + b ^ 3 = n ∧ c ^ 3 + d ^ 3 = n ∧ a ≠ b ∧ c ≠ d ∧ ((a, b) ≠ (c, d) ∧ (a, b) ≠ (d, c))) →
    n ≥ 1729 := by sorry
"
Ireland-Rosen_exercise_5_13,Number Theory,success,True,3,Show that any prime divisor of $x^{4}-x^{2}+1$ is congruent to 1 modulo 12 .,"import Mathlib

/-- If a prime p divides x^4 - x^2 + 1 then p ≡ 1 (mod 12). -/
theorem Ireland_Rosen_exercise_5_13 {p : ℕ} {x : ℤ} (hp : p.Prime) (h : (p : ℤ) ∣ (x ^ 4 - x ^ 2 + 1)) : p % 12 = 1 := by sorry
"
Shakarchi_exercise_1_13a,Analysis,success,True,3,"Suppose that $f$ is holomorphic in an open set $\Omega$. Prove that if $\text{Re}(f)$ is constant, then $f$ is constant.","import Mathlib

-- Suppose f is holomorphic on an open set Ω. If Re f is constant, then f is constant.
theorem Shakarchi_exercise_1_13a {Ω : Set ℂ} (hΩ : IsOpen Ω) {f : ℂ → ℂ} (hf : IsHolomorphicOn f Ω) (c : ℝ) (h : ∀ z ∈ Ω, (f z).re = c) : ∀ z ∈ Ω, f z = (c : ℂ) := by sorry
"
Shakarchi_exercise_1_13c,Analysis,success,True,3,"Suppose that $f$ is holomorphic in an open set $\Omega$. Prove that if $|f|$ is constant, then $f$ is constant.","import Mathlib

/-- Suppose that f is holomorphic in an open set Ω. Prove that if |f| is constant, then f is constant. -/
theorem Shakarchi_exercise_1_13c {Ω : Set ℂ} (hΩ : IsOpen Ω) {f : ℂ → ℂ}
  (hf : DifferentiableOn ℂ f Ω) (hr : ∃ r : ℝ, ∀ z ∈ Ω, |f z| = r) :
  ∃ c : ℂ, ∀ z ∈ Ω, f z = c := by
  sorry
"
Ireland-Rosen_exercise_5_37,Number Theory,success,True,3,Show that if $a$ is negative then $p \equiv q(4 a) together with p\not | a$ imply $(a / p)=(a / q)$.,"import Mathlib

/-!
Exercise 5.37 (Ireland & Rosen), translated into Lean4.
Statement (informal): If a is negative then p ≡ q (mod 4a) together with p ∤ a imply (a / p) = (a / q).

Here `(a / p)` is the usual quadratic (Legendre/Jacobi) symbol. For the purpose of this translation
we introduce a placeholder `leg_sym` to stand for that symbol and state the congruence/divisibility
hypothesis using integer divisibility. This file provides the statement only (proof omitted).
-/

/-- Placeholder for the quadratic symbol (a/p). In a full development this would be the Jacobi or
Legendre symbol from number theory. -/
def leg_sym (a : Int) (p : Int) : Int := 0

theorem Ireland_Rosen_exercise_5_37 {a p q : Int}
  (ha : a < 0)
  (hp_not_dvd : ¬ (p ∣ a))
  (hcong : (4 * a) ∣ (p - q)) :
  leg_sym a p = leg_sym a q := by sorry
"
Shakarchi_exercise_1_26,Analysis,success,True,3,Suppose $f$ is continuous in a region $\Omega$. Prove that any two primitives of $f$ (if they exist) differ by a constant.,"import Mathlib
open Set Filter Function
open scoped Topology

/-- Suppose `f` is continuous in a region `Ω`. Prove that any two primitives of `f` (if they exist)
    differ by a constant. -/
theorem primitives_differ_by_constant (f : ℂ → ℂ) (F G : ℂ → ℂ) (Ω : Set ℂ)
  (hcont : ContinuousOn f Ω) (hΩ : IsOpen Ω) (hconn : IsConnected Ω)
  (hF : ∀ z ∈ Ω, HasDerivAt F (f z) z) (hG : ∀ z ∈ Ω, HasDerivAt G (f z) z) :
  ∃ c : ℂ, ∀ z ∈ Ω, F z = G z + c := by sorry
"
Shakarchi_exercise_3_3,Analysis,success,True,3,Show that $ \int_{-\infty}^{\infty} \frac{\cos x}{x^2 + a^2} dx = \pi \frac{e^{-a}}{a}$ for $a > 0$.,"import Mathlib

/-
Exercise: Show that ∫_{-∞}^{∞} cos x / (x^2 + a^2) dx = π * e^{-a} / a for a > 0.
This file only states the theorem; the proof is omitted.
-/

open Real

theorem integral_cos_div_sq_add {a : ℝ} (ha : 0 < a) :
  ∫ x : ℝ, (Real.cos x) / (x ^ 2 + a ^ 2) = Real.pi * Real.exp (-a) / a := by sorry
"
Shakarchi_exercise_1_19b,Analysis,success,True,3,Prove that the power series $\sum zn/n^2$ converges at every point of the unit circle.,"import Mathlib
open Set Function Filter Asymptotics Metric Complex Bornology
open scoped Topology Filter Real

/-- Prove that the power series $\sum z^n / n^2$ converges at every point of the unit circle. -/
theorem powerSeries_summable_on_circle (z : ℂ) (hz : ‖z‖ = 1) :
  Summable fun n => z^n / n ^ 2 := by sorry
"
Shakarchi_exercise_3_9,Analysis,success,True,3,Show that $\int_0^1 \log(\sin \pi x) dx = - \log 2$.,"import Mathlib
open scoped Real Topology
open Real Set Filter intervalIntegral MeasureTheory.MeasureSpace

/-- Show that $\int_0^1 \log(\sin \pi x) dx = - \log 2$. -/
theorem integral_log_sin_pi_eq_neg_log_two : ∫ x in (0 : ℝ)..1, log (sin (π * x)) = -log 2 := by sorry
"
Putnam_exercise_2020_b5,Olympiad,success,True,3,"For $j \in\{1,2,3,4\}$, let $z_{j}$ be a complex number with $\left|z_{j}\right|=1$ and $z_{j} \neq 1$. Prove that $3-z_{1}-z_{2}-z_{3}-z_{4}+z_{1} z_{2} z_{3} z_{4} \neq 0 .$","import Mathlib
open BigOperators
open Real Nat Topology


/-- For $j \in\{1,2,3,4\}$, let $z_{j}$ be a complex number with $\left|z_{j}\right|=1$ and $z_{j} \neq 1$. Prove that $3-z_{1}-z_{2}-z_{3}-z_{4}+z_{1} z_{2} z_{3} z_{4} \neq 0 .$ Save it to: Putnam_exercise_2020_b5.lean -/
theorem b5_putnam_exercise_2020 : ∀ z : Fin 4 → ℂ, (∀ j, ‖z j‖ = 1 ∧ z j ≠ 1) → 3 - z 1 - z 2 - z 3 - z 4 + z 1 * z 2 * z 3 * z 4 ≠ 0   :=  by sorry
"
Shakarchi_exercise_3_22,Analysis,success,True,3,Show that there is no holomorphic function $f$ in the unit disc $D$ that extends continuously to $\partial D$ such that $f(z) = 1/z$ for $z \in \partial D$.,"import Mathlib

open Complex Set

/--
There is no holomorphic function f on the unit disc that extends continuously to the closed
unit disc and equals 1/z on the unit circle.
-/
theorem Shakarchi_exercise_3_22 :
  ¬ ∃ (f : ℂ → ℂ),
    continuous_on f (closed_ball (0 : ℂ) 1) ∧
    analytic_on f (ball (0 : ℂ) 1) ∧
    ∀ z ∈ sphere (0 : ℂ) 1, f z = z⁻¹ := by sorry
"
Putnam_exercise_2018_b2,Olympiad,success,True,2,"Let $n$ be a positive integer, and let $f_{n}(z)=n+(n-1) z+$ $(n-2) z^{2}+\cdots+z^{n-1}$. Prove that $f_{n}$ has no roots in the closed unit disk $\{z \in \mathbb{C}:|z| \leq 1\}$.","import Mathlib

/-!
Putnam 2018 B2 (translation)
We define f_n(z) = n + (n-1) z + (n-2) z^2 + ... + z^{n-1}
and state that f_n has no roots in the closed unit disk {z : ℂ | |z| ≤ 1}.
-/

open Complex Finset

def f_n (n : ℕ) (z : ℂ) : ℂ :=
  ∑ k in Finset.range n, (↑(n - k) : ℂ) * z ^ k

theorem Putnam_2018_B2 (n : ℕ) (hn : 0 < n) :
  ∀ z : ℂ, |z| ≤ 1 → f_n n z ≠ 0 := by sorry
"
Putnam_exercise_2010_a4,Olympiad,success,True,3,"Prove that for each positive integer $n$, the number $10^{10^{10^n}}+10^{10^n}+10^n-1$ is not prime.","import Mathlib

/-- Prove that for each positive integer `n`, the number
    `10^(10^(10^n)) + 10^(10^n) + 10^n - 1` is not prime.
-/
theorem not_prime_task (n : ℕ) : ¬ (10^(10^(10^n)) + 10^(10^n) + 10^n - 1).Prime := by sorry
"
Pugh_exercise_2_12a,Analysis,success,True,2,"Let $(p_n)$ be a sequence and $f:\mathbb{N}\to\mathbb{N}$. The sequence $(q_k)_{k\in\mathbb{N}}$ with $q_k=p_{f(k)}$ is called a rearrangement of $(p_n)$. Show that if $f$ is an injection, the limit of a sequence is unaffected by rearrangement.","import Mathlib

/-!
Exercise 2.12(a) from Pugh: If (p_n) -> L and f : ℕ → ℕ is injective, then the rearranged sequence q_k = p_{f(k)} also converges to L.
-/

open Filter

theorem Pugh_exercise_2_12a {α : Type*} [TopologicalSpace α] {p : ℕ → α} {f : ℕ → ℕ} (hf : Injective f)
  {L : α} (h : Tendsto p atTop (nhds L)) : Tendsto (p ∘ f) atTop (nhds L) := by sorry
"
Putnam_exercise_2000_a2,Olympiad,success,True,3,"Prove that there exist infinitely many integers $n$ such that $n, n+1, n+2$ are each the sum of the squares of two integers.","import Mathlib

/-!
# Putnam 2000 A2 (statement)

We state the result: there are infinitely many integers n such that n, n+1, n+2
are each the sum of two integer squares. The proof is omitted (sorry).
-/

theorem putnam2000_a2 :
  Set.Infinite { n : Int |
    ∃ a b : Int, n = a^2 + b^2 ∧
    ∃ c d : Int, n + 1 = c^2 + d^2 ∧
    ∃ e f : Int, n + 2 = e^2 + f^2 } := by sorry
"
Shakarchi_exercise_2_9,Analysis,success,True,3,"Let $\Omega$ be a bounded open subset of $\mathbb{C}$, and $\varphi: \Omega \rightarrow \Omega$ a holomorphic function. Prove that if there exists a point $z_{0} \in \Omega$ such that $\varphi\left(z_{0}\right)=z_{0} \quad \text { and } \quad \varphi^{\prime}\left(z_{0}\right)=1$ then $\varphi$ is linear.","import Mathlib

/--
Let Ω be a bounded open subset of ℂ, and φ : Ω → Ω a holomorphic function.
If there exists a point z0 ∈ Ω such that φ z0 = z0 and φ' z0 = 1 then φ is linear.

Remark: As stated this is a direct translation of the exercise. In classical treatments
one usually needs additional hypotheses (e.g. Ω simply connected) to conclude that
φ is the identity; here we express the conclusion as “φ is affine linear”.
-/
theorem Shakarchi_exercise_2_9
  {Ω : Set ℂ} (hΩ_open : IsOpen Ω) (hΩ_bdd : Bounded Ω)
  {φ : ℂ → ℂ} (hφ : HolomorphicOn φ Ω)
  {z0 : ℂ} (hz0 : z0 ∈ Ω) (hfix : φ z0 = z0) (hderiv : deriv φ z0 = 1) :
  ∃ (a b : ℂ), ∀ z ∈ Ω, φ z = a * z + b := by sorry
"
Putnam_exercise_1998_a3,Olympiad,success,True,3,Let $f$ be a real function on the real line with continuous third derivative. Prove that there exists a point $a$ such that,"import Mathlib

/-- Putnam 1998 A3: If f : ℝ → ℝ has continuous third derivative, then there exists a ∈ ℝ
such that f(a) + f'(a) + f''(a) + f'''(a) = 0. -/
theorem putnam_1998_a3 {f : ℝ → ℝ} (h : ContDiff ℝ 3 f) :
  ∃ a : ℝ, f a + deriv f a + deriv (deriv f) a + deriv (deriv (deriv f)) a = 0 := by sorry
"
Putnam_exercise_2017_b3,Olympiad,success,True,3,"Suppose that $f(x)=\sum_{i=0}^{\infty} c_{i} x^{i}$ is a power series for which each coefficient $c_{i}$ is 0 or 1 . Show that if $f(2 / 3)=3 / 2$, then $f(1 / 2)$ must be irrational.","import Mathlib

open_locale BigOperators

/-- Putnam 2017 B3: Suppose f(x) = \sum_{i=0}^\infty c_i x^i with each c_i \in {0,1}.
If f(2/3) = 3/2 then f(1/2) is irrational. -/
theorem putnam_exercise_2017_b3
  (c : ℕ → ℤ)
  (hc : ∀ i, c i = 0 ∨ c i = 1)
  (hf : (∑' i : ℕ, (c i : ℝ) * ((2 : ℝ) / 3) ^ i) = (3 : ℝ) / 2) :
  ¬ ∃ (p q : ℤ), q ≠ 0 ∧ (∑' i : ℕ, (c i : ℝ) * ((1 : ℝ) / 2) ^ i) = (p : ℝ) / (q : ℝ) := by sorry
"
Pugh_exercise_2_41,Analysis,success,True,3,Let $\|\cdot\|$ be any norm on $\mathbb{R}^{m}$ and let $B=\left\{x \in \mathbb{R}^{m}:\|x\| \leq 1\right\}$. Prove that $B$ is compact.,"import Mathlib

/-- Let ||·|| be any norm on ℝ^m and let B = { x ∈ ℝ^m : ||x|| ≤ 1 }. Prove that B is compact. -/
theorem Pugh_exercise_2_41 {m : ℕ} : IsCompact (closedBall (0 : Fin m → ℝ) 1) := by sorry
"
Pugh_exercise_2_29,Analysis,success,True,4,"Let $\mathcal{T}$ be the collection of open subsets of a metric space $\mathrm{M}$, and $\mathcal{K}$ the collection of closed subsets. Show that there is a bijection from $\mathcal{T}$ onto $\mathcal{K}$.","import Mathlib

/-!
Pugh, Exercise 2.29.

Let 𝒯 be the collection of open subsets of a metric space M, and 𝒦 the collection of closed subsets.
There is a bijection between 𝒯 and 𝒦 given by taking complements.
-/

noncomputable def opens_closed_equiv (M : Type*) [MetricSpace M] :
  { U : Set M // IsOpen U } ≃ { A : Set M // IsClosed A } := by
  -- send an open set to its complement (which is closed); inverse is complement again
  sorry
"
Pugh_exercise_3_4,Analysis,success,True,3,Prove that $\sqrt{n+1}-\sqrt{n} \rightarrow 0$ as $n \rightarrow \infty$.,"import Mathlib

/-- Exercise: Show sqrt(n+1) - sqrt(n) → 0 as n → ∞. -/
theorem Pugh_exercise_3_4 : Tendsto (fun n : ℕ => Real.sqrt ((n : ℝ) + 1) - Real.sqrt (n : ℝ)) atTop (nhds (0 : ℝ)) := by
  sorry
"
Herstein_exercise_2_1_21,Algebra,success,True,3,Show that a group of order 5 must be abelian.,"import Mathlib


/-- Show that a group of order 5 must be abelian.
Save it to: Herstein_exercise_2_1_21.lean -/
theorem group_order_five_is_abelian (G : Type*) [Group G] [Fintype G] (hG : Fintype.card G = 5) :
  CommGroup G := Herstein_exercise_2_1_21.lean"
Pugh_exercise_2_126,Analysis,success,True,3,Suppose that $E$ is an uncountable subset of $\mathbb{R}$. Prove that there exists a point $p \in \mathbb{R}$ at which $E$ condenses.,"import Mathlib

/-- A point p is a condensation point of E if every neighborhood of p contains uncountably many points of E. -/
def IsCondensationPoint (p : ℝ) (E : Set ℝ) : Prop :=
  ∀ r : ℝ, 0 < r → ¬ (E ∩ Ioo (p - r) (p + r)).Countable

/-- Pugh, Ex. 2.126: If E ⊆ ℝ is uncountable, then there exists a point p ∈ ℝ at which E condenses. -/
theorem Pugh_exercise_2_126 (E : Set ℝ) (h : ¬ E.Countable) : ∃ p : ℝ, IsCondensationPoint p E := by sorry
"
Herstein_exercise_2_1_27,Algebra,success,True,2,"If $G$ is a finite group, prove that there is an integer $m > 0$ such that $a^m = e$ for all $a \in G$.","import Mathlib

/-!
Exercise: If G is a finite group, prove that there is an integer m > 0 such that a^m = e for all a ∈ G.

We state the result below. The proof is omitted (by `sorry`).
-/

theorem Herstein_exercise_2_1_27 {G : Type*} [Group G] [Fintype G] :
  ∃ m : ℕ, 0 < m ∧ ∀ a : G, a ^ m = (1 : G) := by sorry
"
Pugh_exercise_3_63b,Analysis,success,True,3,Prove that $\sum 1/k(\log(k))^p$ diverges when $p \leq 1$.,"import Mathlib

open Real

/-- Exercise: show the series Sum_{k=2}^\infty 1/(k (log k)^p) diverges for p ≤ 1. -/
theorem Pugh_exercise_3_63b (p : ℝ) (hp : p ≤ 1) :
  ¬ Summable (fun n => if n ≥ 2 then 1 / ((n:ℝ) * Real.rpow (Real.log (n:ℝ)) p) else 0) := by sorry
"
Herstein_exercise_2_2_5,Algebra,success,True,3,"Let $G$ be a group in which $(a b)^{3}=a^{3} b^{3}$ and $(a b)^{5}=a^{5} b^{5}$ for all $a, b \in G$. Show that $G$ is abelian.","import Mathlib

/-!
Let G be a group in which (a b)^3 = a^3 b^3 and (a b)^5 = a^5 b^5 for all a, b in G.
Show that G is abelian.
-/

theorem Herstein_exercise_2_2_5 (G : Type _) [Group G]
  (h3 : ∀ a b : G, (a * b) ^ 3 = a ^ 3 * b ^ 3)
  (h5 : ∀ a b : G, (a * b) ^ 5 = a ^ 5 * b ^ 5) :
  ∀ a b : G, a * b = b * a := by sorry
"
Pugh_exercise_2_57,Analysis,success,True,3,"Show that if $S$ is connected, it is not true in general that its interior is connected.","import Mathlib

open Set

/-- Counterexample: in R^2, take the two open unit disks centered at (0,0) and (2,0), together
with the point (1,0) joining them. The union S is connected, but its interior is the disjoint
union of the two open disks, hence disconnected. -/

noncomputable section

def disk (c : ℝ × ℝ) (r : ℝ) : Set (ℝ × ℝ) :=
  { x | (x.1 - c.1) ^ 2 + (x.2 - c.2) ^ 2 < r ^ 2 }

def S : Set (ℝ × ℝ) :=
  disk (0, 0) 1 ∪ disk (2, 0) 1 ∪ {(1, 0)}

theorem Pugh_exercise_2_57 : IsConnected S ∧ ¬IsConnected (interior S) := by sorry
"
Herstein_exercise_2_4_36,Algebra,success,True,3,"If $a > 1$ is an integer, show that $n \mid \varphi(a^n - 1)$, where $\phi$ is the Euler $\varphi$-function.","import Mathlib

/-!
Herstein, Abstract Algebra, Exercise 2.4.36:
If a > 1 is an integer and n is a positive integer, then n ∣ φ(a^n - 1).
-/

theorem herstein_exercise_2_4_36 (a n : ℕ) (ha : 1 < a) (hn : 1 ≤ n) :
  n ∣ Nat.totient (a ^ n - 1) := by sorry
"
Herstein_exercise_2_3_17,Algebra,success,True,3,"If $G$ is a group and $a, x \in G$, prove that $C\left(x^{-1} a x\right)=x^{-1} C(a) x$","import Mathlib

open Set

variable {G : Type _} [Group G]

/-- Centralizer of an element a in a group G. -/
def C (a : G) : Set G := { g | g * a = a * g }

theorem Herstein_exercise_2_3_17 (a x : G) : C (x⁻¹ * a * x) = (fun g => x⁻¹ * g * x) '' C a := by sorry
"
Herstein_exercise_2_8_12,Algebra,success,True,3,Prove that any two nonabelian groups of order 21 are isomorphic.,"import Mathlib

/-- Any two nonabelian groups of order 21 are isomorphic. -/
theorem nonabelian_groups_order_21_isomorphic {G H : Type*} [Group G] [Fintype G] [Group H] [Fintype H]
  (hG : Fintype.card G = 21) (hH : Fintype.card H = 21) (hGnon : ¬ CommGroup G) (hHnon : ¬ CommGroup H) :
  Nonempty (G ≃* H) :=
by sorry
"
Herstein_exercise_2_5_44,Algebra,success,True,3,"Prove that a group of order $p^2$, $p$ a prime, has a normal subgroup of order $p$.","import Mathlib

/--
Exercise: Prove that a group of order p^2, p a prime, has a normal subgroup of order p.
This file states the theorem; the proof is omitted (:= by sorry).
-/
theorem group_of_order_p2_has_normal_subgroup_of_order_p (p : ℕ) [hp : Fact p.Prime]
  {G : Type _} [Group G] [Fintype G] (h : Fintype.card G = p ^ 2) :
  ∃ H : Subgroup G, H.normal ∧ Fintype.card H = p := by sorry
"
Herstein_exercise_2_5_30,Algebra,success,True,3,"Suppose that $|G| = pm$, where $p \nmid m$ and $p$ is a prime. If $H$ is a normal subgroup of order $p$ in $G$, prove that $H$ is characteristic.","import Mathlib

/-!
Herstein Exercise 2.5.30
Suppose |G| = p * m where p ∤ m and p is prime. If H is a normal subgroup of order p in G, then H is characteristic.
This file states the result in Lean4 / mathlib style. The proof is omitted (:= by sorry).
-/

open Subgroup

theorem Herstein_exercise_2_5_30 {G : Type*} [Group G] [Fintype G] {p m : ℕ}
  (hp : Nat.Prime p) (hm : ¬ (p ∣ m)) (hcard : Fintype.card G = p * m)
  (H : Subgroup G) (hH : Fintype.card H = p) (hnormal : H.normal) :
  -- H is invariant under every automorphism of G (i.e., characteristic)
  (∀ (φ : G ≃* G), (φ.toEquiv : G ≃ G) '' (H : Set G) = (H : Set G)) := by sorry
"
Herstein_exercise_2_5_37,Algebra,success,True,3,"If $G$ is a nonabelian group of order 6, prove that $G \simeq S_3$.","import Mathlib

/-! # Herstein Exercise 2.5.37

If G is a nonabelian group of order 6, then G ≃ S_3.
-/

theorem Herstein_exercise_2_5_37 (G : Type _) [Group G] [Fintype G]
  (hcard : Fintype.card G = 6)
  (nonabel : ¬∀ a b : G, a * b = b * a) :
  G ≃* Equiv.Perm (Fin 3) := by sorry
"
Herstein_exercise_2_6_15,Algebra,success,True,3,"If $G$ is an abelian group and if $G$ has an element of order $m$ and one of order $n$, where $m$ and $n$ are relatively prime, prove that $G$ has an element of order $mn$.","import Mathlib

/-
Exercise: If G is an abelian group and if G has an element of order m and one of order n,
where m and n are relatively prime, prove that G has an element of order mn.
-/

theorem Herstein_exercise_2_6_15 {G : Type _} [CommGroup G] {m n : Nat}
  (hm : ∃ x : G, x ^ m = 1 ∧ ∀ k, k < m → x ^ k ≠ 1)
  (hn : ∃ y : G, y ^ n = 1 ∧ ∀ k, k < n → y ^ k ≠ 1)
  (hc : Nat.Coprime m n) : ∃ z : G, z ^ (m * n) = 1 ∧ ∀ k, k < m * n → z ^ k ≠ 1 := by sorry
"
Herstein_exercise_2_9_2,Algebra,success,True,3,"If $G_1$ and $G_2$ are cyclic groups of orders $m$ and $n$, respectively, prove that $G_1 \times G_2$ is cyclic if and only if $m$ and $n$ are relatively prime.","import Mathlib

/-!
Exercise (Herstein 2.9.2).
If G1 and G2 are cyclic groups of orders m and n, respectively, prove that G1 × G2 is cyclic iff m and n are relatively prime.
-/

theorem Herstein_exercise_2_9_2 {G1 G2 : Type*} [Group G1] [Group G2] [Fintype G1] [Fintype G2]
  (m n : Nat)
  (hG1_card : Fintype.card G1 = m)
  (hG2_card : Fintype.card G2 = n)
  (hcyc1 : ∃ g1 : G1, orderOf g1 = m)
  (hcyc2 : ∃ g2 : G2, orderOf g2 = n) :
  (∃ g : G1 × G2, orderOf g = m * n) ↔ Nat.coprime m n := by sorry
"
Herstein_exercise_4_2_5,Algebra,success,True,3,Let $R$ be a ring in which $x^3 = x$ for every $x \in R$. Prove that $R$ is commutative.,"import Mathlib


/-- Let R be a ring in which x^3 = x for every x in R. Prove that R is commutative. -/
theorem of_cube_eq_self (R : Type*) [Ring R] (h : ∀ x : R, x ^ 3 = x) : CommRing R := by sorry"
Herstein_exercise_2_11_6,Algebra,success,True,3,"If $P$ is a $p$-Sylow subgroup of $G$ and $P \triangleleft G$, prove that $P$ is the only $p$-Sylow subgroup of $G$.","import Mathlib

open Subgroup

variable {G : Type _} [Group G] [Fintype G]
variable {p : ℕ} [Fact (Nat.Prime p)]

/-- If P is a p-Sylow subgroup of G and P ◁ G, then P is the unique p-Sylow subgroup of G. -/
theorem sylow_normal_unique {P : Subgroup G} (hP : IsSylow p P) (hPnormal : P.normal) :
  ∀ Q : Subgroup G, IsSylow p Q → Q = P := by sorry
"
Herstein_exercise_2_11_22,Algebra,success,True,3,Show that any subgroup of order $p^{n-1}$ in a group $G$ of order $p^n$ is normal in $G$.,"import Mathlib

/-!
Exercise: Let p be a prime, n a natural number, G a finite group with card G = p^n,
and H a subgroup of G with card H = p^(n-1). Then H is a normal subgroup of G.
-/

variable {p n : ℕ} (hp : Prime p) {G : Type _} [Group G] [Fintype G] (H : Subgroup G)

theorem Herstein_exercise_2_11_22 (hG : Fintype.card G = p ^ n) (hH : Fintype.card H = p ^ (n - 1)) : H.normal := by sorry
"
Herstein_exercise_4_3_25,Algebra,success,True,3,Let $R$ be the ring of $2 \times 2$ matrices over the real numbers; suppose that $I$ is an ideal of $R$. Show that $I = (0)$ or $I = R$.,"import Mathlib

/-!
Exercise (Herstein 4.3.25): Let R be the ring of 2×2 matrices over the real numbers;
suppose that I is an ideal of R. Show that I = (0) or I = R.
-/

theorem Herstein_exercise_4_3_25 (I : Ideal (Matrix (Fin 2) (Fin 2) ℝ)) :
  I = ⊥ ∨ I = ⊤ := by sorry
"
Herstein_exercise_4_1_19,Algebra,success,True,3,Show that there is an infinite number of solutions to $x^2 = -1$ in the quaternions.,"import Mathlib

/-!
Herstein Exercise 4.1.19

Show that there are infinitely many solutions to x^2 = -1 in the quaternions.
-/

theorem Herstein_exercise_4_1_19 : Set.Infinite { q : quaternion ℝ | q * q = (-1 : quaternion ℝ) } := by sorry
"
Herstein_exercise_4_5_16,Algebra,success,True,3,"Let $F = \mathbb{Z}_p$ be the field of integers $\mod p$, where $p$ is a prime, and let $q(x) \in F[x]$ be irreducible of degree $n$. Show that $F[x]/(q(x))$ is a field having at exactly $p^n$ elements.","import Mathlib
open Polynomial Ideal.Quotient
open Polynomial

/-- Let F = \mathbb{Z}_p be the field of integers \mod p, where p is a prime, and let q(x) \in F[x] be irreducible of degree n. Show that F[x]/(q(x)) is a field having at exactly p^n elements. -/
theorem card_field_ext (p : ℕ) [Fact p.Prime] (n : ℕ) (q : Polynomial (ZMod p)) (hq : Irreducible q) (hn : q.natDegree = n) :
  IsField (ZMod p)[x] ⧸ Ideal.span {q} ∧ Fintype (ZMod p)[x] ⧸ Ideal.span {q} ∧ Fintype.card (ZMod p)[x] ⧸ Ideal.span {q} = p ^ n := by sorry
"
Herstein_exercise_4_2_9,Algebra,success,True,3,"Let $p$ be an odd prime and let $1 + \frac{1}{2} + ... + \frac{1}{p - 1} = \frac{a}{b}$, where $a, b$ are integers. Show that $p \mid a$.","import Mathlib

open BigOperators

theorem Herstein_exercise_4_2_9 (p : ℕ) (hp : Prime p) (hpodd : p ≠ 2) (a b : Int)
  (h : (∑ k in Finset.Ico 1 p, (1 : ℚ) / (k : ℚ)) = (a : ℚ) / (b : ℚ)) :
  (p : Int) ∣ a := by
  sorry
"
Herstein_exercise_4_5_25,Algebra,success,True,3,"If $p$ is a prime, show that $q(x) = 1 + x + x^2 + \cdots x^{p - 1}$ is irreducible in $Q[x]$.","import Mathlib

open Polynomial

/-- Exercise: If p is a prime, show that q(x) = 1 + x + x^2 + \cdots + x^{p - 1} is irreducible in Q[x]. -/
theorem Herstein_exercise_4_5_25 (p : ℕ) (hp : p.Prime) :
  Irreducible (∑ i in Finset.range p, X ^ i : Polynomial ℚ) := by sorry
"
Herstein_exercise_5_3_10,Algebra,success,True,3,Prove that $\cos 1^{\circ}$  is algebraic over $\mathbb{Q}$.,"import Mathlib
open Polynomial
open Real

/-- Prove that $\cos 1^{\circ}$  is algebraic over $\mathbb{Q}$. Save it to: Herstein_exercise_5_3_10.lean -/
lemma cos_one_algebraic_over_Q : IsAlgebraic ℚ (cos 1) := by sorry
"
Herstein_exercise_5_5_2,Algebra,success,True,3,Prove that $x^3 - 3x - 1$ is irreducible over $\mathbb{Q}$.,"import Mathlib
open Polynomial
open Polynomial

/-- Prove that $x^3 - 3x - 1$ is irreducible over $\mathbb{Q}$. Save it to: Herstein_exercise_5_5_2.lean -/
theorem cube_minus_three_minus_one_irreducible_over_Q : Irreducible (X ^ 3 - 3 * X - 1 : ℚ[X]) := by sorry
"
Herstein_exercise_5_2_20,Algebra,success,True,3,Let $V$ be a vector space over an infinite field $F$. Show that $V$ cannot be the set-theoretic union of a finite number of proper subspaces of $V$.,"import Mathlib

open Set

/-- Let V be a vector space over an infinite field K. Show that V cannot be the set-theoretic
union of a finite number of proper subspaces of V. -/
theorem herstein_exercise_5_2_20 {K : Type _} [Field K] [Infinite K] {V : Type _} [AddCommGroup V]
  [Module K V] (s : Finset (Submodule K V)) (h : ∀ W ∈ s, (W : Set V) ≠ Set.univ) :
  (⋃ W ∈ s, (W : Set V)) ≠ (Set.univ : Set V) := by sorry
"
Artin_exercise_2_11_3,Algebra,success,True,3,Prove that a group of even order contains an element of order $2 .$,"import Mathlib

/- Exercise (Artin 2.11.3): A group of even order contains an element of order 2. -/

theorem Artin_exercise_2_11_3 {G : Type*} [Group G] [Fintype G] (h : 2 ∣ Fintype.card G) :
  ∃ g : G, g ≠ 1 ∧ g ^ 2 = 1 := by sorry
"
Artin_exercise_2_2_9,Algebra,success,True,3,"Let $H$ be the subgroup generated by two elements $a, b$ of a group $G$. Prove that if $a b=b a$, then $H$ is an abelian group.","import Mathlib

/-- Let H be the subgroup generated by two elements a, b of a group G. Prove that if a b = b a, then H is abelian. -/
theorem Artin_exercise_2_2_9 {G : Type*} [Group G] (a b : G) (hab : a * b = b * a) :
  ∀ x y : G, x ∈ Subgroup.closure ({a, b} : Set G) → y ∈ Subgroup.closure ({a, b} : Set G) → x * y = y * x := by sorry"
Artin_exercise_2_4_19,Algebra,success,True,3,"Prove that if a group contains exactly one element of order 2 , then that element is in the center of the group.","import Mathlib

/-- If a group contains exactly one element of order 2, then that element is central. -/
theorem Artin_exercise_2_4_19 {G : Type _} [Group G] {g : G}
  (hg_ne : g ≠ 1) (hg2 : g * g = 1) (huniq : ∀ h : G, h ≠ 1 → h * h = 1 → h = g) :
  ∀ x : G, g * x = x * g := by sorry
"
Herstein_exercise_4_6_3,Algebra,success,True,3,Show that there is an infinite number of integers a such that $f(x) = x^7 + 15x^2 - 30x + a$ is irreducible in $Q[x]$.,"import Mathlib

open Polynomial

/-- Herstein exercise: there are infinitely many integers a such that
    f(x) = x^7 + 15 x^2 - 30 x + a is irreducible over Q. -/
theorem Herstein_exercise_4_6_3 : Set.Infinite { a : Int |
  Irreducible ((Polynomial.X ^ 7 + 15 * Polynomial.X ^ 2 - 30 * Polynomial.X + (a : ℚ)) : Polynomial ℚ)
} := by sorry"
Artin_exercise_3_5_6,Algebra,success,True,3,Let $V$ be a vector space which is spanned by a countably infinite set. Prove that every linearly independent subset of $V$ is finite or countably infinite.,"import Mathlib

/-!
Let V be a vector space spanned by a countable set S.
Prove that every linearly independent subset of V is finite or countable.
-/

theorem Artin_exercise_3_5_6 {K : Type*} [Field K] {V : Type*} [AddCommGroup V] [Module K V]
  (S : Set V) (hS : S.Countable) (hspan : Submodule.span K S = ⊤) :
  ∀ (L : Set V), LinearIndependent K (fun x : L => (x : V)) → L.Finite ∨ L.Countable := by
  sorry
"
Artin_exercise_10_2_4,Algebra,success,True,2,"Prove that in the ring $\mathbb{Z}[x],(2) \cap(x)=(2 x)$.","import Mathlib

open Ideal Polynomial

/- Exercise 10.2.4 (Artin): In the ring Z[x], (2) ∩ (x) = (2x). -/

theorem Artin_exercise_10_2_4 :
  (ideal.span ({Polynomial.C (2 : ℤ)} : Set (Polynomial ℤ))) ⊓ (ideal.span ({Polynomial.X} : Set (Polynomial ℤ)))
    = ideal.span ({Polynomial.C (2 : ℤ) * Polynomial.X} : Set (Polynomial ℤ)) := by sorry
"
Artin_exercise_6_8_1,Algebra,success,True,3,"Prove that two elements $a, b$ of a group generate the same subgroup as $b a b^2, b a b^3$.","import Mathlib
open Subgroup

/-- Prove that two elements $a, b$ of a group generate the same subgroup as $b a b^2, b a b^3$. Save it to: Artin_exercise_6_8_1.lean -/
theorem generate_same_subgroup (G : Type*) [Group G] (a b : G) :
    Subgroup.closure {a, b} = Subgroup.closure {b * a * b^2, b * a * b^3} := by sorry
"
Artin_exercise_10_4_6,Algebra,success,True,3,"Let $I, J$ be ideals in a ring $R$. Prove that the residue of any element of $I \cap J$ in $R / I J$ is nilpotent.","import Mathlib


/-- Let I, J be ideals in a ring R. Prove that the residue of any element of I ∩ J in R / (I * J) is nilpotent. -/
theorem nilpotent_quotient_ext (R : Type*) [CommRing R] (I J : Ideal R) (x : I ⊓ J) : IsNilpotent ((Ideal.Quotient.mk (I * J)) x) := by sorry
"
Artin_exercise_6_1_14,Algebra,success,True,3,"Let $Z$ be the center of a group $G$. Prove that if $G / Z$ is a cyclic group, then $G$ is abelian and hence $G=Z$.","import Mathlib

variable {G : Type _} [Group G]

/-- Let Z be the center of a group G. If G / Z is cyclic then G is abelian and hence G = Z. -/
theorem Artin_exercise_6_1_14 :
  let Z := center G in
  (∃ g : G, ∀ x : G, ∃ n : Int, (QuotientGroup.mk Z x) = (QuotientGroup.mk Z (g ^ n))) →
  (∀ a b : G, a * b = b * a) ∧ (Z = (⊤ : Subgroup G)) := by sorry
"
Artin_exercise_11_4_1b,Algebra,success,True,2,Prove that $x^3 + 6x + 12$ is irreducible in $\mathbb{Q}$.,"import Mathlib

open Polynomial

/-!
Artin, Algebra, Exercise 11.4.1(b):
Prove that x^3 + 6x + 12 is irreducible over Q.
-/

theorem Artin_exercise_11_4_1b : (X^3 + C (6 : ℚ) * X + C (12 : ℚ) : Polynomial ℚ).irreducible := by
  sorry
"
Dummit-Foote_exercise_1_1_3,Algebra,success,True,3,Prove that the addition of residue classes $\mathbb{Z}/n\mathbb{Z}$ is associative.,"import Mathlib


/-- Prove that the addition of residue classes $\mathbb{Z}/n\mathbb{Z}$ is associative.
Save it to: Dummit-Foote_exercise_1_1_3.lean -/
theorem add_assoc_ZMod (n : ℕ) (a b c : ZMod n) : (a + b) + c = a + (b + c) := by sorry
"
Artin_exercise_6_4_3,Algebra,success,True,3,"Prove that no group of order $p^2 q$, where $p$ and $q$ are prime, is simple.","import Mathlib

/-!
Artin, Algebra (exercise 6.4.3)
Statement: Prove that no group of order p^2 * q (p, q primes) is simple.
This file states the result in Lean. The proof is omitted (""by sorry"").
-/-

open Nat

theorem Artin_exercise_6_4_3 {G : Type _} [Group G] [Fintype G] {p q : ℕ}
  (hp : p.Prime) (hq : q.Prime) (hcard : Fintype.card G = p ^ 2 * q) :
  ∃ H : Subgroup G, H ≠ ⊥ ∧ H ≠ ⊤ ∧ H.normal := by sorry
"
Artin_exercise_11_4_8,Algebra,success,True,2,Let $p$ be a prime integer. Prove that the polynomial $x^n-p$ is irreducible in $\mathbb{Q}[x]$.,"import Mathlib

open Polynomial

/--
Exercise (Artin 11.4.8): Let p be a prime integer and n ≥ 1. Show that the polynomial x^n - p is
irreducible in Q[x].
-/
theorem Artin_exercise_11_4_8 (p : ℕ) (hp : p.Prime) (n : ℕ) (hn : 0 < n) :
  Irreducible (X ^ n - C (p : ℚ)) := by
  -- This follows from Eisenstein's criterion at the prime p.
  sorry
"
Artin_exercise_13_4_10,Algebra,success,True,3,"Prove that if a prime integer $p$ has the form $2^r+1$, then it actually has the form $2^{2^k}+1$.","import Mathlib

/-
Artin, exercise 13.4.10:
If a prime integer p has the form 2^r + 1 (with r ≥ 1), then r is a power of 2.
-/

theorem Artin_exercise_13_4_10 {p r : ℕ} (hp : Nat.Prime p) (hr : 1 ≤ r) (hpform : p = 2 ^ r + 1) :
  ∃ k : ℕ, r = 2 ^ k := by sorry
"
Artin_exercise_11_4_6b,Algebra,success,True,3,Prove that $x^2+1$ is irreducible in $\mathbb{F}_7$,"import Mathlib

open Polynomial

theorem Artin_exercise_11_4_6b : Irreducible (X ^ 2 + 1 : Polynomial (ZMod 7)) := by sorry
"
Artin_exercise_10_7_10,Algebra,success,True,3,"Let $R$ be a ring, with $M$ an ideal of $R$. Suppose that every element of $R$ which is not in $M$ is a unit of $R$. Prove that $M$ is a maximal ideal and that moreover it is the only maximal ideal of $R$.","import Mathlib

variable {R : Type _} [CommRing R]

theorem Artin_exercise_10_7_10 (M : Ideal R) (hM : M ≠ ⊤) (h : ∀ x : R, x ∉ M → IsUnit x) :
  M.IsMaximal ∧ ∀ I : Ideal R, I.IsMaximal → I = M := by sorry
"
Dummit-Foote_exercise_1_1_5,Algebra,success,True,3,Prove that for all $n>1$ that $\mathbb{Z}/n\mathbb{Z}$ is not a group under multiplication of residue classes.,"import Mathlib


/-- Prove that for all $n>1$ that $\mathbb{Z}/n\mathbb{Z}$ is not a group under multiplication of residue classes. -/
theorem not_isGroup_ZMod_multiplication (n : ℕ) (hn : 1 < n) : ¬IsGroup (ZMod n) := by sorry
"
Dummit-Foote_exercise_1_1_16,Algebra,success,True,3,Let $x$ be an element of $G$. Prove that $x^2=1$ if and only if $|x|$ is either $1$ or $2$.,"import Mathlib

/-
Exercise: Let G be a group and x ∈ G. Prove that x^2 = 1 iff |x| = 1 or |x| = 2.
-/

variable {G : Type _} [Group G] (x : G)

theorem Dummit_Foote_exercise_1_1_16 : x ^ 2 = (1 : G) ↔ orderOf x = 1 ∨ orderOf x = 2 := by sorry
"
Dummit-Foote_exercise_1_1_18,Algebra,success,True,3,Let $x$ and $y$ be elements of $G$. Prove that $xy=yx$ if and only if $y^{-1}xy=x$ if and only if $x^{-1}y^{-1}xy=1$.,"import Mathlib
open Function

/-- Let $x$ and $y$ be elements of $G$. Prove that $xy=yx$ if and only if $y^{-1}xy=x$ if and only if $x^{-1}y^{-1}xy=1$. -/
theorem xy_eq_yx_iff_yx_eq_xy_iff_x_inv_y_inv_xy_eq_one {G : Type*} [Group G] (x y : G) :
    x * y = y * x ↔ y⁻¹ * x * y = x ↔ x⁻¹ * y⁻¹ * x * y = 1 := by sorry
"
Dummit-Foote_exercise_1_1_22a,Algebra,success,True,3,"If $x$ and $g$ are elements of the group $G$, prove that $|x|=\left|g^{-1} x g\right|$.","import Mathlib
open Cardinal

/-- If x and g are elements of the group G, prove that |x|=\left|g^{-1} x g\right|. Save it to: Dummit-Foote_exercise_1_1_22a.lean -/
theorem card_conj_extracted {G : Type*} [Group G] (x g : G) : orderOf x = orderOf (g⁻¹ * x * g) := by sorry
"
Dummit-Foote_exercise_1_1_25,Algebra,success,True,3,Prove that if $x^{2}=1$ for all $x \in G$ then $G$ is abelian.,"import Mathlib

variable {G : Type*} [Group G]

/-- If every element of a group squares to 1, then the group is abelian. -/
theorem Dummit_Foote_exercise_1_1_25 (h : ∀ x : G, x * x = 1) : ∀ a b : G, a * b = b * a := by sorry
"
Dummit-Foote_exercise_2_1_5,Algebra,success,True,3,"Prove that $G$ cannot have a subgroup $H$ with $|H|=n-1$, where $n=|G|>2$.","import Mathlib

open Classical

-- Exercise: Show that a finite group G with |G| = n > 2 cannot have a subgroup of order n - 1.

variable {G : Type*} [Group G]

theorem no_subgroup_card_eq_card_sub_one (n : ℕ) (h_card : Fintype.card G = n) (hn : 2 < n) :
  ¬∃ (H : Subgroup G), Fintype.card H = n - 1 := by sorry
"
Dummit-Foote_exercise_1_1_34,Algebra,success,True,3,"If $x$ is an element of infinite order in $G$, prove that the elements $x^{n}, n \in \mathbb{Z}$ are all distinct.","import Mathlib

/- If x has infinite order (i.e. the only integer power giving 1 is 0),
   then the map n ↦ x^n is injective, so x^m = x^n implies m = n. -/
theorem zpow_injective_of_infinite_order {G : Type*} [Group G] {x : G}
  (h : ∀ n : ℤ, x ^ n = 1 → n = 0) :
  ∀ m n : ℤ, x ^ m = x ^ n → m = n := by sorry
"
Dummit-Foote_exercise_1_6_4,Algebra,success,True,3,Prove that the multiplicative groups $\mathbb{R}-\{0\}$ and $\mathbb{C}-\{0\}$ are not isomorphic.,"import Mathlib

/-- The multiplicative groups of nonzero real and complex numbers are not isomorphic. -/
theorem real_units_not_isomorphic_complex_units :
  ¬ Nonempty (Units ℝ ≃* Units ℂ) := by sorry
"
Dummit-Foote_exercise_1_6_17,Algebra,success,True,3,Let $G$ be any group. Prove that the map from $G$ to itself defined by $g \mapsto g^{-1}$ is a homomorphism if and only if $G$ is abelian.,"import Mathlib

/--
Let G be any group. Prove that the map from G to itself defined by g ↦ g^{-1}
is a homomorphism if and only if G is abelian.
-/
theorem inv_map_is_hom_iff_comm {G : Type _} [Group G] :
  (∀ x y : G, (x * y)⁻¹ = x⁻¹ * y⁻¹) ↔ (∀ x y : G, x * y = y * x) := by sorry
"
Dummit-Foote_exercise_2_4_4,Algebra,success,True,3,Prove that if $H$ is a subgroup of $G$ then $H$ is generated by the set $H-\{1\}$.,"import Mathlib

/-- If H is a subgroup of G, then H is generated by H \ {1}. -/
theorem subgroup_generated_by_remove_one {G : Type _} [Group G] (H : Subgroup G) :
  Subgroup.closure ((H : Set G) \ {1 : G}) = H := by sorry
"
Dummit-Foote_exercise_2_4_16b,Algebra,success,True,3,Show that the subgroup of all rotations in a dihedral group is a maximal subgroup.,"import Mathlib


/-- Show that the subgroup of all rotations in a dihedral group is a maximal subgroup. -/
theorem rotations_maximal {n : ℕ} : ∀ H : Subgroup (DihedralGroup n), H ≤ Subgroup.closure {DihedralGroup.r n} → H = Subgroup.closure {DihedralGroup.r n} ∨ H = ⊤ := by sorry
"
Dummit-Foote_exercise_3_2_21a,Algebra,success,True,2,Prove that $\mathbb{Q}$ has no proper subgroups of finite index.,"import Mathlib

/-!
Prove that Q has no proper subgroups of finite index.
This file states the result in Lean4 / mathlib style. The proof is omitted (sorry).
-/

theorem Dummit_Foote_exercise_3_2_21a :
  ∀ (H : AddSubgroup ℚ), H ≠ (⊤ : AddSubgroup ℚ) → ¬ Fintype (AddSubgroup.Quotient H) := by
  sorry
"
Dummit-Foote_exercise_3_1_3a,Algebra,success,True,3,Let $A$ be an abelian group and let $B$ be a subgroup of $A$. Prove that $A / B$ is abelian.,"import Mathlib

/-!
Let A be an abelian group and B a subgroup. Prove that A / B is abelian.
-/-

theorem Dummit_Foote_exercise_3_1_3a {A : Type*} [CommGroup A] (B : Subgroup A) : CommGroup (A ⧸ B) := by sorry
"
Dummit-Foote_exercise_3_2_11,Algebra,success,True,3,Let $H \leq K \leq G$. Prove that $|G: H|=|G: K| \cdot|K: H|$ (do not assume $G$ is finite).,"import Mathlib

/-
Let H ≤ K ≤ G. Prove that |G : H| = |G : K| * |K : H| (do not assume G is finite).
We state this in terms of cardinalities of quotient types: Cardinal.mk (G ⧸ H) etc.
-/

theorem index_mul {G : Type*} [Group G] {H K : Subgroup G} (hHK : H ≤ K) :
  Cardinal.mk (G ⧸ H) = Cardinal.mk (G ⧸ K) * Cardinal.mk (K ⧸ H) := by
  sorry
"
Dummit-Foote_exercise_3_4_5a,Algebra,success,True,3,Prove that subgroups of a solvable group are solvable.,"import Mathlib
open Subgroup

/-- Prove that subgroups of a solvable group are solvable. -/
theorem subgroup_isSolvable {G : Type*} [Group G] [IsSolvable G] (H : Subgroup G) : IsSolvable H := by sorry
"
Dummit-Foote_exercise_3_4_1,Algebra,success,True,3,Prove that if $G$ is an abelian simple group then $G \cong Z_{p}$ for some prime $p$ (do not assume $G$ is a finite group).,"import Mathlib

/-- Exercise: If G is an abelian simple group then G ≅ Z_p for some prime p.
    We do not assume G is finite. -/
theorem abelian_simple_group_is_zp {G : Type _} [Group G] [CommGroup G]
  (h : ∀ H : Subgroup G, H = ⊥ ∨ H = ⊤) :
  ∃ p : ℕ, p.Prime ∧ Nonempty (G ≃* Multiplicative (ZMod p)) := by sorry
"
Dummit-Foote_exercise_3_1_22b,Algebra,success,True,3,Prove that the intersection of an arbitrary nonempty collection of normal subgroups of a group is a normal subgroup (do not assume the collection is countable).,"import Mathlib

open Set

/-- The intersection of an arbitrary nonempty collection of normal subgroups
    of a group is a normal subgroup.  Here we state closure under multiplication,
    identity, inverses, and conjugation for the indexed intersection of the
    underlying sets of the subgroups.  A full proof is omitted (:= by sorry).
-/
theorem Dummit_Foote_exercise_3_1_22b {G : Type*} [Group G] {ι : Sort*} (S : ι → Subgroup G)
  (hne : Nonempty ι) (hnormal : ∀ (i : ι) (g h : G), h ∈ (S i) → g * h * g⁻¹ ∈ (S i)) :
  (∀ a b, a ∈ (⋂ i, (S i : Set G)) → b ∈ (⋂ i, (S i : Set G)) → a * b ∈ (⋂ i, (S i : Set G)))
  ∧ (1 ∈ (⋂ i, (S i : Set G)))
  ∧ (∀ x, x ∈ (⋂ i, (S i : Set G)) → x⁻¹ ∈ (⋂ i, (S i : Set G)))
  ∧ (∀ g x, x ∈ (⋂ i, (S i : Set G)) → g * x * g⁻¹ ∈ (⋂ i, (S i : Set G))) := by sorry
"
Dummit-Foote_exercise_4_2_14,Algebra,success,True,2,Let $G$ be a finite group of composite order $n$ with the property that $G$ has a subgroup of order $k$ for each positive integer $k$ dividing $n$. Prove that $G$ is not simple.,"import Mathlib

/-!
Exercise (Dummit & Foote, 4.2.14).
Let G be a finite group of composite order n with the property that
G has a subgroup of order k for each positive integer k dividing n.
Prove that G is not simple.
-/

theorem Dummit_Foote_exercise_4_2_14 {G : Type _} [Group G] [Fintype G]
  (hcomp : ∃ a b : ℕ, 1 < a ∧ 1 < b ∧ Fintype.card G = a * b)
  (hsub : ∀ k : ℕ, k ∣ Fintype.card G → ∃ H : Subgroup G, Fintype.card H = k) :
  ∃ N : Subgroup G, N.normal ∧ N ≠ ⊥ ∧ N ≠ ⊤ := by
  sorry
"
Dummit-Foote_exercise_3_4_11,Algebra,success,True,3,Prove that if $H$ is a nontrivial normal subgroup of the solvable group $G$ then there is a nontrivial subgroup $A$ of $H$ with $A \unlhd G$ and $A$ abelian.,"import Mathlib

/--
If H is a nontrivial normal subgroup of the solvable group G then there is a nontrivial
subgroup A of H with A ⊲ G and A abelian.
-/
theorem Dummit_Foote_exercise_3_4_11
  {G : Type _} [Group G] (H : Subgroup G) (H_nontrivial : H ≠ ⊥) (H_normal : H.normal) (G_solvable : Solvable G) :
  ∃ A : Subgroup G, A ≤ H ∧ A.normal ∧ A ≠ ⊥ ∧ IsAbelian A := by sorry
"
Dummit-Foote_exercise_4_3_26,Algebra,success,True,3,Let $G$ be a transitive permutation group on the finite set $A$ with $|A|>1$. Show that there is some $\sigma \in G$ such that $\sigma(a) \neq a$ for all $a \in A$.,"import Mathlib

variable {A : Type*} [Fintype A] [DecidableEq A]
variable {G : Type*} [Group G] [Fintype G] [MulAction G A]

/-- Exercise: If a finite group G acts transitively on a finite set A with |A| > 1,
    then there exists an element of G with no fixed points (a derangement). -/
theorem exists_derangement_of_transitive (htrans : ∀ a b : A, ∃ g : G, g • a = b)
  (h_card : Fintype.card A > 1) :
  ∃ g : G, ∀ a : A, g • a ≠ a := by sorry
"
Dummit-Foote_exercise_4_4_6a,Algebra,success,True,3,Prove that characteristic subgroups are normal.,"import Mathlib


/-- Prove that characteristic subgroups are normal. -/
theorem isNormal_of_characteristic (H : Subgroup G) [h : H.IsCharacteristic] : H.IsNormal := by sorry
"
Dummit-Foote_exercise_4_5_1a,Algebra,success,True,3,Prove that if $P \in \operatorname{Syl}_{p}(G)$ and $H$ is a subgroup of $G$ containing $P$ then $P \in \operatorname{Syl}_{p}(H)$.,"import Mathlib

variable {G : Type*} [Group G] {p : ℕ} {P H : Subgroup G}

open Subgroup

/-- If P is a Sylow p-subgroup of G and P ≤ H, then the comap of P along the inclusion H.subtype
    is a Sylow p-subgroup of H. -/
theorem sylow_of_subgroup_of_contain (hP : IsSylow p G P) (hPsub : P ≤ H) :
  IsSylow p H (Subgroup.comap (H.subtype : H →* G) P) := by sorry
"
Dummit-Foote_exercise_4_5_18,Algebra,success,True,3,Prove that a group of order 200 has a normal Sylow 5-subgroup.,"import Mathlib
open MulAction Subgroup
open Pointwise

/-- Prove that a group of order 200 has a normal Sylow 5-subgroup. -/
theorem normal_sylow_5_of_order_200 {G : Type*} [Group G] [Fintype G] (h : Fintype.card G = 200) :
  ∃! H : Subgroup G, Fintype.card H = 5 := by sorry"
Dummit-Foote_exercise_4_4_7,Algebra,success,True,3,If $H$ is the unique subgroup of a given order in a group $G$ prove $H$ is characteristic in $G$.,"import Mathlib

/- If H is the unique subgroup of a given order in a group G prove H is characteristic in G. -/
theorem Dummit_Foote_exercise_4_4_7 {G : Type*} [Group G] [Fintype G] (H : Subgroup G)
  (uniq : ∀ K : Subgroup G, Fintype.card K = Fintype.card H → K = H) : H.IsCharacteristic := by sorry
"
Dummit-Foote_exercise_4_5_16,Algebra,success,True,3,"Let $|G|=p q r$, where $p, q$ and $r$ are primes with $p<q<r$. Prove that $G$ has a normal Sylow subgroup for either $p, q$ or $r$.","import Mathlib
open MulAction Subgroup
open Pointwise
open Equiv Equiv.Perm Finset Function List QuotientGroup

/-- Let $|G|=p q r$, where $p, q$ and $r$ are primes with $p<q<r$. Prove that $G$ has a normal Sylow subgroup for either $p, q$ or $r$. -/
theorem exists_normal_Sylow_of_card_eq_mul_three_primes {G : Type*} [Group G]
  {p q r : ℕ} [Fact p.Prime] [Fact q.Prime] [Fact r.Prime] [Fintype G]
  (card_G : Nat.card G = p * q * r) (hpq : p < q) (hqr : q < r) :
  ∃ P, Normal P ∧ Sylow p ↥P ∨ ∃ Q, Normal Q ∧ Sylow q ↥Q ∨ ∃ R, Normal R ∧ Sylow r ↥R := by sorry
"
Dummit-Foote_exercise_4_5_14,Algebra,success,True,3,Prove that a group of order 312 has a normal Sylow $p$-subgroup for some prime $p$ dividing its order.,"import Mathlib

/-!
Exercise (Dummit & Foote 4.5.14):
Show that a group of order 312 has a normal Sylow p-subgroup for some prime p dividing its order.
312 = 2^3 * 3 * 13.
-/

theorem Dummit_Foote_exercise_4_5_14 {G : Type*} [Group G] [Fintype G]
  (h : Fintype.card G = 312) :
  ∃ (p : ℕ), p.Prime ∧ p ∣ Fintype.card G ∧ ∃ (P : Subgroup G), IsSylow p P ∧ P.Normal := by sorry
"
Dummit-Foote_exercise_4_5_22,Algebra,success,True,3,Prove that if $|G|=132$ then $G$ is not simple.,"import Mathlib

/-!
Dummit and Foote, Exercise 4.5.22:
If |G| = 132 then G is not simple.
-/

theorem Dummit_Foote_exercise_4_5_22 {G : Type*} [Group G] [Fintype G]
  (h : Fintype.card G = 132) : ¬ SimpleGroup G := by sorry
"
Dummit-Foote_exercise_4_5_20,Algebra,success,True,3,Prove that if $|G|=1365$ then $G$ is not simple.,"import Mathlib

/--
If |G| = 1365 = 3 * 5 * 7 * 13 then G is not simple.
This file states the result; the proof is omitted (:= by sorry).
-/

theorem Dummit_Foote_exercise_4_5_20 {G : Type*} [Group G] [Fintype G]
  (h : Fintype.card G = 1365) : ¬ SimpleGroup G := by sorry
"
Dummit-Foote_exercise_5_4_2,Algebra,success,True,2,"Prove that a subgroup $H$ of $G$ is normal if and only if $[G, H] \leq H$.","import Mathlib

variable {G : Type _} [Group G] (H : Subgroup G)

/-- A subgroup H is normal iff the commutator subgroup [G, H] is contained in H. -/
theorem Dummit_Foote_exercise_5_4_2 : H.normal ↔ Subgroup.closure ({ g * (h : G) * g⁻¹ * (h : G)⁻¹ | g : G, h : H } : Set G) ≤ H := by sorry
"
Dummit-Foote_exercise_7_1_11,Algebra,success,True,3,Prove that if $R$ is an integral domain and $x^{2}=1$ for some $x \in R$ then $x=\pm 1$.,"import Mathlib

/-
Exercise 7.1.11 (Dummit & Foote).
If R is an integral domain and x^2 = 1 for some x ∈ R, then x = ±1.
-/

theorem Dummit_Foote_exercise_7_1_11 {R : Type _} [CommRing R] [NoZeroDivisors R] {x : R}
  (h : x * x = 1) : x = 1 ∨ x = -1 := by sorry"
Dummit-Foote_exercise_7_3_37,Algebra,success,True,3,An ideal $N$ is called nilpotent if $N^{n}$ is the zero ideal for some $n \geq 1$. Prove that the ideal $p \mathbb{Z} / p^{m} \mathbb{Z}$ is a nilpotent ideal in the ring $\mathbb{Z} / p^{m} \mathbb{Z}$.,"import Mathlib

/- An ideal N is called nilpotent if N^n is the zero ideal for some n ≥ 1.
   Prove that the ideal p ℤ / p^m ℤ is a nilpotent ideal in the ring ℤ / p^m ℤ. -/

open Ideal

theorem ideal_isNilpotent_extracted (p m : ℕ) : IsNilpotent (Ideal.span {p : ZMod (p ^ m)}) := by
  -- proof omitted
  sorry
"
Dummit-Foote_exercise_7_1_15,Algebra,success,True,3,A ring $R$ is called a Boolean ring if $a^{2}=a$ for all $a \in R$. Prove that every Boolean ring is commutative.,"import Mathlib

/-!
# Dummit & Foote, Exercise 7.1.15

A ring R is called a Boolean ring if a^2 = a for all a ∈ R. Prove that every Boolean ring is commutative.
-/

theorem boolean_ring_comm {R : Type*} [Ring R] (h : ∀ a : R, a * a = a) : ∀ x y : R, x * y = y * x := by sorry
"
Dummit-Foote_exercise_7_2_12,Algebra,success,True,3,"Let $G=\left\{g_{1}, \ldots, g_{n}\right\}$ be a finite group. Prove that the element $N=g_{1}+g_{2}+\ldots+g_{n}$ is in the center of the group ring $R G$.","import Mathlib

variable {R : Type*} [CommRing R]
variable {G : Type*} [Group G] [Fintype G]

open Finset

noncomputable def N : MonoidAlgebra R G := (Finset.univ : Finset G).sum fun g => MonoidAlgebra.of R G g

theorem N_is_central : N ∈ Center (MonoidAlgebra R G) := by sorry
"
Dummit-Foote_exercise_8_3_4,Algebra,success,True,3,"Prove that if an integer is the sum of two rational squares, then it is the sum of two integer squares.","import Mathlib
open GaussianInt

/-- Prove that if an integer is the sum of two rational squares, then it is the sum of two integer squares. -/
theorem isSquare_of_isSquare_cast {n : ℤ} (hn : ∃ a b : ℚ, a ^ 2 + b ^ 2 = n) :
    ∃ a b : ℤ, a ^ 2 + b ^ 2 = n := by sorry
"
Dummit-Foote_exercise_8_1_12,Algebra,success,True,3,"Let $N$ be a positive integer. Let $M$ be an integer relatively prime to $N$ and let $d$ be an integer relatively prime to $\varphi(N)$, where $\varphi$ denotes Euler's $\varphi$-function. Prove that if $M_{1} \equiv M^{d} \pmod N$ then $M \equiv M_{1}^{d^{\prime}} \pmod N$ where $d^{\prime}$ is the inverse of $d \bmod \varphi(N)$: $d d^{\prime} \equiv 1 \pmod {\varphi(N)}$.","import Mathlib

open Int

/--
Let N be a positive integer. Let M be an integer relatively prime to N and let d be an
integer relatively prime to φ(N), where φ denotes Euler's φ-function. Prove that if
M1 ≡ M^d (mod N) then M ≡ M1^{d'} (mod N) where d' is the inverse of d mod φ(N):
d d' ≡ 1 (mod φ(N)).

This file states the exercise in Lean; the proof is omitted (""by sorry"").
-/

theorem Dummit_Foote_exercise_8_1_12 (N : Nat) (M M1 : Int) (d d' : Nat)
  (hN : 1 < N)
  (hM_coprime : Int.gcd M (Int.ofNat N) = 1)
  (hd_invertible : ((d * d') : Int) ≡ 1 [MOD (Int.ofNat (Nat.totient N))])
  (hM1_def : M1 ≡ M ^ d [MOD (Int.ofNat N)]) :
  M ≡ M1 ^ d' [MOD (Int.ofNat N)] := by sorry
"
Dummit-Foote_exercise_9_3_2,Algebra,success,True,3,"Prove that if $f(x)$ and $g(x)$ are polynomials with rational coefficients whose product $f(x) g(x)$ has integer coefficients, then the product of any coefficient of $g(x)$ with any coefficient of $f(x)$ is an integer.","import Mathlib

/-!
Exercise: Prove that if f(x) and g(x) are polynomials with rational coefficients
whose product f(x) g(x) has integer coefficients, then the product of any
coefficient of g(x) with any coefficient of f(x) is an integer.
-/

theorem Dummit_Foote_exercise_9_3_2 (f g : Polynomial ℚ)
  (h : ∀ n : ℕ, ∃ z : Int, (f * g).coeff n = (z : ℚ)) :
  ∀ i j : ℕ, ∃ z : Int, (f.coeff i) * (g.coeff j) = (z : ℚ) := by sorry
"
Dummit-Foote_exercise_9_1_6,Algebra,success,True,3,"Prove that $(x, y)$ is not a principal ideal in $\mathbb{Q}[x, y]$.","import Mathlib

/-!
Exercise (Dummit and Foote 9.1.6): Show that the ideal (x, y) is not principal in Q[x, y].
This file states the result in Lean. The proof is omitted (``by sorry'').
-/

theorem Dummit_Foote_exercise_9_1_6 :
  ¬ ∃ (f : MvPolynomial (Fin 2) ℚ),
    Ideal.span ({MvPolynomial.X (0 : Fin 2), MvPolynomial.X (1 : Fin 2)} : Set (MvPolynomial (Fin 2) ℚ))
    = Ideal.span ({f} : Set (MvPolynomial (Fin 2) ℚ)) := by sorry
"
Dummit-Foote_exercise_9_4_2b,Algebra,success,True,3,Prove that $x^6+30x^5-15x^3 + 6x-120$ is irreducible in $\mathbb{Z}[x]$.,"import Mathlib

open Polynomial

/-!
Exercise: Prove that x^6 + 30 x^5 - 15 x^3 + 6 x - 120 is irreducible in ℤ[x].
-/

theorem Dummit_Foote_exercise_9_4_2b :
  Irreducible (X ^ 6 + 30 * X ^ 5 - 15 * X ^ 3 + 6 * X - 120 : Polynomial ℤ) := by
  sorry
"
Dummit-Foote_exercise_8_3_6a,Algebra,success,True,3,Prove that the quotient ring $\mathbb{Z}[i] /(1+i)$ is a field of order 2.,"import Mathlib

/-
Exercise (Dummit & Foote 8.3.6a).
Prove that the quotient ring ℤ[i] / (1 + i) is a field of order 2.

In Lean we state this by asserting that the quotient of the Gaussian integers by the ideal
generated by 1 + i is a field and has cardinality 2. We leave the proof as `sorry`.
-/

theorem Dummit_Foote_exercise_8_3_6a :
  IsField (GaussianInt ⧸ (Ideal.span ({(1 : GaussianInt) + GaussianInt.i} : Set GaussianInt))) ∧
  (Fintype (GaussianInt ⧸ (Ideal.span ({(1 : GaussianInt) + GaussianInt.i} : Set GaussianInt))) ∧
   Fintype.card (GaussianInt ⧸ (Ideal.span ({(1 : GaussianInt) + GaussianInt.i} : Set GaussianInt))) = 2) := by sorry
"
Dummit-Foote_exercise_9_4_2d,Algebra,success,True,3,"Prove that $\frac{(x+2)^p-2^p}{x}$, where $p$ is an odd prime, is irreducible in $\mathbb{Z}[x]$.","import Mathlib
open BigOperators
open Real Nat Topology


/-- Prove that $\frac{(x+2)^p-2^p}{x}$, where $p$ is an odd prime, is irreducible in $\mathbb{Z}[x]$. Save it to: Dummit-Foote_exercise_9_4_2d.lean -/
theorem Dummit_Foote_exercise_9_4_2d (p : ℕ) (hp : p.Prime) (hp1 : Odd p) : Irreducible ((x + 2) ^ p - 2 ^ p) / x in Polynomial ℤ   :=  by sorry"
Dummit-Foote_exercise_4_5_28,Algebra,success,True,3,Let $G$ be a group of order 105. Prove that if a Sylow 3-subgroup of $G$ is normal then $G$ is abelian.,"import Mathlib

open Subgroup

/-- Let G be a group of order 105. If a Sylow 3-subgroup of G is normal then G is abelian. -/
theorem Dummit_Foote_exercise_4_5_28 {G : Type*} [Group G] [Fintype G]
  (h_card : Fintype.card G = 105)
  (h3_normal : ∃ H : Subgroup G, Fintype.card H = 3 ∧ Normal H) :
  ∀ x y : G, x * y = y * x := by sorry
"
Dummit-Foote_exercise_9_4_11,Algebra,success,True,3,"Prove that $x^2+y^2-1$ is irreducible in $\mathbb{Q}[x,y]$.","import Mathlib

open Polynomial

/-- Dummit-Foote, Ex. 9.4.11:
    The polynomial x^2 + y^2 - 1 is irreducible in Q[x,y].
    We view Q[x,y] as (Polynomial (Polynomial ℚ)), i.e. polynomials in X over the coefficient ring Q[y]. -/
theorem Dummit_Foote_exercise_9_4_11 :
  Irreducible (
    (Polynomial.X : Polynomial (Polynomial ℚ)) ^ 2
    + Polynomial.C ((Polynomial.X : Polynomial ℚ) ^ 2 - 1)
  ) := by
  sorry
"
