import Mathlib

/-!
Statement (translated):
The quaternion group Q = {±1, ±i, ±j, ±k} (with i^2 = j^2 = k^2 = -1 and the usual multiplication rules)
is presented by ⟨a, b | a^2 = b^2 = (ab)^2⟩.

We formalize this by describing the presented group as the quotient of the free group on two
generators by the normal closure of the relations a^2 = b^2 and a^2 = (ab)^2, and asserting that
this quotient is isomorphic to the quaternion subgroup generated by i and j.

Remarks: the proof is omitted (``by sorry'').
-/

noncomputable section

open FreeGroup Subgroup QuotientGroup MulEquiv

-- Generators of the free group on two letters
def a : FreeGroup (Fin 2) := FreeGroup.of (0 : Fin 2)
def b : FreeGroup (Fin 2) := FreeGroup.of (1 : Fin 2)

-- Relations: a^2 = b^2 and a^2 = (a*b)^2, written multiplicatively as a^2 * b^-2 = 1, etc.
def rels : Set (FreeGroup (Fin 2)) := {
  a ^ 2 * (b ^ 2)⁻¹,
  a ^ 2 * (a * b) ^ (-2)
}

-- Normal closure of the relations and the presented group
def N : Subgroup (FreeGroup (Fin 2)) := Subgroup.normalClosure rels
def presented_group := QuotientGroup.quotient (N : Subgroup (FreeGroup (Fin 2)))

/-- The quaternion subgroup Q = {±1, ±i, ±j, ±k} (generated by i and j inside the real quaternions)
is isomorphic to the group presented by ⟨a,b | a^2 = b^2 = (ab)^2⟩. -/
theorem quaternion_group_presentation :
  let Q_sub : Type := Subgroup.gclosure ({Quaternion.i, Quaternion.j} : Set (Quaternion ℝ))
  in presented_group ≃* Q_sub := by sorry
