import Mathlib

open Matrix

-- The group of invertible 2x2 real matrices, viewed as units of the matrix ring
abbrev M2 := Units (Matrix (Fin 2) (Fin 2) ℝ)

-- Orthogonal group O(2) as a subset of invertible 2x2 real matrices (units)
def O2 : Set M2 := { M | (M.val).transpose * (M.val) = 1 }

-- Special orthogonal group SO(2) (rotations) as those orthogonal matrices of determinant 1
def SO2 : Set M2 := { M | (M.val).transpose * (M.val) = 1 ∧ Matrix.det (M.val) = 1 }

-- If A is an improper orthogonal matrix (orthogonal with determinant -1),
-- then O(2) is generated by SO(2) together with A.
theorem o2_generated_by_so2_and_A (A : M2)
  (hA : (A.val).transpose * (A.val) = 1 ∧ Matrix.det (A.val) = -1) :
  Subgroup.closure (SO2 ∪ {A}) = Subgroup.closure O2 := by sorry